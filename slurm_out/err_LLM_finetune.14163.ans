/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  self.hub = sentry_sdk.Hub(client)
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/flwr_datasets/utils.py:109: UserWarning: The currently tested dataset are ['mnist', 'ylecun/mnist', 'cifar10', 'uoft-cs/cifar10', 'fashion_mnist', 'zalando-datasets/fashion_mnist', 'sasha/dog-food', 'zh-plus/tiny-imagenet', 'scikit-learn/adult-census-income', 'cifar100', 'uoft-cs/cifar100', 'svhn', 'ufldl-stanford/svhn', 'sentiment140', 'stanfordnlp/sentiment140', 'speech_commands', 'LIUM/tedlium', 'flwrlabs/femnist', 'flwrlabs/ucf101', 'flwrlabs/ambient-acoustic-context', 'jlh/uci-mushrooms', 'Mike0307/MNIST-M', 'flwrlabs/usps', 'scikit-learn/iris', 'flwrlabs/pacs', 'flwrlabs/cinic10', 'flwrlabs/caltech101', 'flwrlabs/office-home', 'flwrlabs/fed-isic2019']. Given: xinchiqiu/PISTOL.
  warnings.warn(
Downloading readme:   0%|          | 0.00/2.92k [00:00<?, ?B/s]Downloading readme: 100%|██████████| 2.92k/2.92k [00:00<00:00, 6.72MB/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 400 examples [00:00, 10751.87 examples/s]
[92mINFO [0m:      Starting Flower ServerApp, config: num_rounds=50, no round_timeout
[92mINFO [0m:      
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
[36m(ClientAppActor pid=263676)[0m   self.hub = sentry_sdk.Hub(client)
[92mINFO [0m:      Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
wandb: Currently logged in as: preslav-aleksandrov (camlsys). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143253-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:32:55,094	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:32:55,096	ERROR client.py:240 -- Config: {}
2024-11-11 14:32:55,096	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:32:56,869	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
Map:   0%|          | 0/20 [00:00<?, ? examples/s]Map: 100%|██████████| 20/20 [00:00<00:00, 495.02 examples/s]
Map:   0%|          | 0/20 [00:00<?, ? examples/s]Map: 100%|██████████| 20/20 [00:00<00:00, 857.59 examples/s]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 63.27it/s]
[92mINFO [0m:      initial parameters (loss, other metrics): 0.0, {}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m wandb: Currently logged in as: preslav-aleksandrov (camlsys). Use `wandb login --relogin` to force relogin
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143312-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1057.32 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 125.08 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 797.09it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:43,  2.30it/s]                                                 1%|          | 1/100 [00:00<00:43,  2.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  2%|▏         | 2/100 [00:00<00:42,  2.30it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:18,  5.23it/s]                                                 3%|▎         | 3/100 [00:00<00:18,  5.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:18,  5.23it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:13,  7.01it/s]                                                 5%|▌         | 5/100 [00:00<00:13,  7.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:13,  7.01it/s]  7%|▋         | 7/100 [00:01<00:11,  8.06it/s]                                                 7%|▋         | 7/100 [00:01<00:11,  8.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:01<00:11,  8.06it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:01<00:10,  8.73it/s]                                                 9%|▉         | 9/100 [00:01<00:10,  8.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:10,  8.73it/s] 11%|█         | 11/100 [00:01<00:09,  9.29it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.29it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:09,  9.09it/s]                                                 12%|█▏        | 12/100 [00:01<00:09,  9.09it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:09,  9.22it/s]                                                 13%|█▎        | 13/100 [00:01<00:09,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:09,  9.22it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:02<00:08,  9.63it/s]                                                 17%|█▋        | 17/100 [00:02<00:08,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:02<00:08,  9.65it/s]                                                 18%|█▊        | 18/100 [00:02<00:08,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:02<00:08,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:02<00:08,  9.89it/s]                                                 20%|██        | 20/100 [00:02<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07,  9.89it/s] 22%|██▏       | 22/100 [00:02<00:07, 11.04it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 11.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:06, 11.04it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:06, 12.19it/s]                                                 24%|██▍       | 24/100 [00:02<00:06, 12.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:06, 12.19it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:05, 12.99it/s]                                                 26%|██▌       | 26/100 [00:02<00:05, 12.99it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 12.99it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:05, 13.90it/s]                                                 28%|██▊       | 28/100 [00:02<00:05, 13.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:05, 13.90it/s] 30%|███       | 30/100 [00:02<00:04, 14.61it/s]                                                 30%|███       | 30/100 [00:02<00:04, 14.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:04, 14.61it/s] 32%|███▏      | 32/100 [00:03<00:04, 15.13it/s]                                                 32%|███▏      | 32/100 [00:03<00:04, 15.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:04, 15.13it/s] 34%|███▍      | 34/100 [00:03<00:04, 15.01it/s]                                                 34%|███▍      | 34/100 [00:03<00:04, 15.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:04, 15.01it/s] 36%|███▌      | 36/100 [00:03<00:04, 15.56it/s]                                                 36%|███▌      | 36/100 [00:03<00:04, 15.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:04, 15.56it/s] 38%|███▊      | 38/100 [00:03<00:03, 15.90it/s]                                                 38%|███▊      | 38/100 [00:03<00:03, 15.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:03, 15.90it/s] 40%|████      | 40/100 [00:03<00:03, 15.84it/s]                                                 40%|████      | 40/100 [00:03<00:03, 15.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:03, 15.84it/s] 42%|████▏     | 42/100 [00:03<00:03, 16.42it/s]                                                 42%|████▏     | 42/100 [00:03<00:03, 16.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:03, 16.42it/s] 44%|████▍     | 44/100 [00:03<00:03, 16.77it/s]                                                 44%|████▍     | 44/100 [00:03<00:03, 16.77it/s]                                                 45%|████▌     | 45/100 [00:03<00:03, 16.77it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:03, 16.86it/s]                                                 46%|████▌     | 46/100 [00:03<00:03, 16.86it/s]                                                 47%|████▋     | 47/100 [00:04<00:03, 16.86it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:03, 16.75it/s]                                                 48%|████▊     | 48/100 [00:04<00:03, 16.75it/s]                                                 49%|████▉     | 49/100 [00:04<00:03, 16.75it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:02, 16.76it/s]                                                 50%|█████     | 50/100 [00:04<00:02, 16.76it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A                                                
[36m(ClientAppActor pid=263676)[0m                                      [A 50%|█████     | 50/100 [00:04<00:02, 16.76it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 662.92it/s][A
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:02, 16.76it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:04, 10.20it/s]                                                 52%|█████▏    | 52/100 [00:04<00:04, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:04<00:04, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:04, 10.12it/s]                                                 54%|█████▍    | 54/100 [00:04<00:04, 10.12it/s]                                                 55%|█████▌    | 55/100 [00:04<00:04, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:04<00:04, 10.12it/s]                                                 56%|█████▌    | 56/100 [00:04<00:04, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.97it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.92it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:05<00:03,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:05<00:03,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:05<00:03,  9.86it/s]                                                 64%|██████▍   | 64/100 [00:05<00:03,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:05<00:03,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:05<00:03,  9.86it/s]                                                 66%|██████▌   | 66/100 [00:05<00:03,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.86it/s] 68%|██████▊   | 68/100 [00:06<00:03,  9.88it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.86it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:06<00:02,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:06<00:02,  9.59it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02,  9.62it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02,  9.62it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02, 10.07it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.98it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02,  9.84it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:02,  9.85it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.64it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01,  9.49it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01,  9.47it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01,  9.67it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.78it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.70it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.65it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:01,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.83it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00,  9.84it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00,  9.94it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00,  9.94it/s] 95%|█████████▌| 95/100 [00:08<00:00,  9.88it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.90it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.09it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00,  9.88it/s]                                                 100%|██████████| 100/100 [00:09<00:00,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m [A                                                 
[36m(ClientAppActor pid=263676)[0m                                      [A100%|██████████| 100/100 [00:09<00:00,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 627.61it/s][A
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.88it/s]100%|██████████| 100/100 [00:09<00:00, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.029 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.011 MB of 0.029 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▇▅▇▆▂▃▂▃▁▂█
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▂▆▆▁▅▆█▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.73998
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0011
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0254
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 78.848
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 39.424
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 100
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.73998
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0011
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0254
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 78.848
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 39.424
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 56.64621
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 4.4536
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 3.08147
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.6883
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.287
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.322
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143312-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143328-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1126.50 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=263676)[0m Map: 100%|██████████| 2/2 [00:00<00:00, 103.16 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.83it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.70it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:10,  9.80it/s]                                                 2%|▏         | 2/100 [00:00<00:10,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:10,  9.54it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.63it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:10,  9.44it/s]                                                 5%|▌         | 5/100 [00:00<00:10,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.70it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.70it/s]  8%|▊         | 8/100 [00:00<00:09,  9.62it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.93it/s]                                                 10%|█         | 10/100 [00:01<00:09,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.76it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.74it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.64it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.64it/s] 16%|█▌        | 16/100 [00:01<00:08, 10.43it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 10.43it/s] 18%|█▊        | 18/100 [00:01<00:06, 12.26it/s]                                                 18%|█▊        | 18/100 [00:01<00:06, 12.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:06, 12.26it/s] 20%|██        | 20/100 [00:01<00:05, 13.44it/s]                                                 20%|██        | 20/100 [00:01<00:05, 13.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:05, 13.44it/s] 22%|██▏       | 22/100 [00:01<00:05, 14.22it/s]                                                 22%|██▏       | 22/100 [00:01<00:05, 14.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:05, 14.22it/s] 24%|██▍       | 24/100 [00:02<00:05, 15.07it/s]                                                 24%|██▍       | 24/100 [00:02<00:05, 15.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:04, 15.07it/s] 26%|██▌       | 26/100 [00:02<00:04, 15.44it/s]                                                 26%|██▌       | 26/100 [00:02<00:04, 15.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:04, 15.44it/s] 28%|██▊       | 28/100 [00:02<00:04, 15.26it/s]                                                 28%|██▊       | 28/100 [00:02<00:04, 15.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:04, 15.26it/s] 30%|███       | 30/100 [00:02<00:04, 15.13it/s]                                                 30%|███       | 30/100 [00:02<00:04, 15.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:04, 15.13it/s] 32%|███▏      | 32/100 [00:02<00:04, 15.60it/s]                                                 32%|███▏      | 32/100 [00:02<00:04, 15.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:04, 15.60it/s] 34%|███▍      | 34/100 [00:02<00:04, 16.27it/s]                                                 34%|███▍      | 34/100 [00:02<00:04, 16.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:02<00:03, 16.27it/s] 36%|███▌      | 36/100 [00:02<00:03, 16.51it/s]                                                 36%|███▌      | 36/100 [00:02<00:03, 16.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:02<00:03, 16.51it/s] 38%|███▊      | 38/100 [00:02<00:03, 16.91it/s]                                                 38%|███▊      | 38/100 [00:02<00:03, 16.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:03, 16.91it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:04, 14.20it/s]                                                 40%|████      | 40/100 [00:03<00:04, 14.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:04, 14.20it/s] 42%|████▏     | 42/100 [00:03<00:04, 12.67it/s]                                                 42%|████▏     | 42/100 [00:03<00:04, 12.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:04, 12.67it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:04, 11.73it/s]                                                 44%|████▍     | 44/100 [00:03<00:04, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:03<00:04, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:04, 11.17it/s]                                                 46%|████▌     | 46/100 [00:03<00:04, 11.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:03<00:04, 11.17it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:03<00:04, 11.05it/s]                                                 48%|████▊     | 48/100 [00:03<00:04, 11.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:04, 11.05it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.73it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A                                                
[36m(ClientAppActor pid=263676)[0m                                      [A 50%|█████     | 50/100 [00:04<00:04, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 655.26it/s][A
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:05,  8.25it/s]                                                 52%|█████▏    | 52/100 [00:04<00:05,  8.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:04<00:05,  8.25it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:05,  8.73it/s]                                                 54%|█████▍    | 54/100 [00:04<00:05,  8.73it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:04<00:05,  8.77it/s]                                                 55%|█████▌    | 55/100 [00:04<00:05,  8.77it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:04<00:04,  8.95it/s]                                                 56%|█████▌    | 56/100 [00:04<00:04,  8.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  8.95it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.57it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.57it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:03, 11.11it/s]                                                 60%|██████    | 60/100 [00:05<00:03, 11.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03, 11.11it/s] 62%|██████▏   | 62/100 [00:05<00:03, 12.08it/s]                                                 62%|██████▏   | 62/100 [00:05<00:03, 12.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:05<00:03, 12.08it/s] 64%|██████▍   | 64/100 [00:05<00:02, 12.94it/s]                                                 64%|██████▍   | 64/100 [00:05<00:02, 12.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:05<00:02, 12.94it/s] 66%|██████▌   | 66/100 [00:05<00:02, 13.82it/s]                                                 66%|██████▌   | 66/100 [00:05<00:02, 13.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:05<00:02, 13.82it/s] 68%|██████▊   | 68/100 [00:05<00:02, 14.92it/s]                                                 68%|██████▊   | 68/100 [00:05<00:02, 14.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:05<00:02, 14.92it/s] 70%|███████   | 70/100 [00:05<00:01, 15.07it/s]                                                 70%|███████   | 70/100 [00:05<00:01, 15.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:05<00:01, 15.07it/s] 72%|███████▏  | 72/100 [00:05<00:01, 15.47it/s]                                                 72%|███████▏  | 72/100 [00:05<00:01, 15.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:06<00:01, 15.47it/s] 74%|███████▍  | 74/100 [00:06<00:01, 15.46it/s]                                                 74%|███████▍  | 74/100 [00:06<00:01, 15.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:06<00:01, 15.46it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:06<00:01, 13.44it/s]                                                 76%|███████▌  | 76/100 [00:06<00:01, 13.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:06<00:01, 13.44it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:06<00:01, 12.74it/s]                                                 78%|███████▊  | 78/100 [00:06<00:01, 12.74it/s]                                                 79%|███████▉  | 79/100 [00:06<00:01, 12.74it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:06<00:01, 13.66it/s]                                                 80%|████████  | 80/100 [00:06<00:01, 13.66it/s]                                                 81%|████████  | 81/100 [00:06<00:01, 13.66it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:06<00:01, 14.20it/s]                                                 82%|████████▏ | 82/100 [00:06<00:01, 14.20it/s]                                                 83%|████████▎ | 83/100 [00:06<00:01, 14.20it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:06<00:01, 14.38it/s]                                                 84%|████████▍ | 84/100 [00:06<00:01, 14.38it/s]                                                 85%|████████▌ | 85/100 [00:06<00:01, 14.38it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01, 13.77it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 13.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:00, 13.77it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:00, 12.13it/s]                                                 88%|████████▊ | 88/100 [00:07<00:00, 12.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:07<00:00, 12.13it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:07<00:00, 11.38it/s]                                                 90%|█████████ | 90/100 [00:07<00:00, 11.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:07<00:00, 11.38it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:07<00:00, 11.00it/s]                                                 92%|█████████▏| 92/100 [00:07<00:00, 11.00it/s]                                                
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:07<00:00, 11.00it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:07<00:00, 10.72it/s]                                                 94%|█████████▍| 94/100 [00:07<00:00, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:07<00:00, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00, 10.44it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00, 10.24it/s]                                                 98%|█████████▊| 98/100 [00:08<00:00, 10.24it/s]                                                
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:08<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:08<00:00, 10.19it/s]                                                 100%|██████████| 100/100 [00:08<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A                                                 
[36m(ClientAppActor pid=263676)[0m                                      [A100%|██████████| 100/100 [00:08<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 604.37it/s][A
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:08<00:00, 10.19it/s]100%|██████████| 100/100 [00:08<00:00, 11.58it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
wandb: - 0.010 MB of 0.010 MB uploadedwandb: \ 0.010 MB of 0.010 MB uploadedwandb: | 0.010 MB of 0.010 MB uploadedwandb: / 0.010 MB of 0.010 MB uploadedwandb: - 0.010 MB of 0.010 MB uploadedwandb: \ 0.072 MB of 0.072 MB uploaded (0.002 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 3.4%
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 3.94649
wandb:  eval/eval_model_preparation_time 0.004
wandb:                 eval/eval_runtime 1.4295
wandb:      eval/eval_samples_per_second 13.991
wandb:        eval/eval_steps_per_second 3.498
wandb:                              iter 0
wandb:                   train/eval_loss 3.94649
wandb: train/eval_model_preparation_time 0.004
wandb:                train/eval_runtime 1.4295
wandb:     train/eval_samples_per_second 13.991
wandb:       train/eval_steps_per_second 3.498
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 5 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143253-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143347-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:33:57,799	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:33:57,800	ERROR client.py:240 -- Config: {}
2024-11-11 14:33:57,801	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:33:58,889	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
Map:   0%|          | 0/20 [00:00<?, ? examples/s]Map: 100%|██████████| 20/20 [00:00<00:00, 563.01 examples/s]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 68.06it/s]
[92mINFO [0m:      fit progress: (1, 0.0, {}, 52.347262734081596)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploadedwandb: | 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm █▇▆▇▄▃▁▂▃▃▄
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▃▃▇█▅▁▃▅▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.28066
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0025
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0227
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 87.939
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 43.97
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 100
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.28066
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0025
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0227
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 87.939
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 43.97
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 26.39148
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.6357
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 2.62442
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 8.6348
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 46.324
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 11.581
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143328-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143401-uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1482.39 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 130.44 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.03it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.91it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:10,  9.54it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.54it/s]                                                 4%|▍         | 4/100 [00:00<00:10,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.68it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.81it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.83it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:08, 10.19it/s]                                                 10%|█         | 10/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.03it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.03it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.25it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.15it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.15it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.16it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.06it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.88it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07,  9.85it/s]                                                 25%|██▌       | 25/100 [00:02<00:07,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.94it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07,  9.86it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07,  9.86it/s] 30%|███       | 30/100 [00:02<00:06, 10.18it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.35it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.15it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.09it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.07it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.01it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.98it/s]                                                
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.04it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.69it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.71it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.71it/s] 48%|████▊     | 48/100 [00:04<00:05,  9.76it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.24it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A                                                
[36m(ClientAppActor pid=263676)[0m                                      [A 50%|█████     | 50/100 [00:05<00:04, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 647.67it/s][A
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:05,  8.11it/s]                                                 52%|█████▏    | 52/100 [00:05<00:05,  8.11it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.30it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.30it/s]                                                
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.30it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.75it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.75it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.08it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.08it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.13it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.13it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:06<00:04,  9.22it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03, 10.02it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 10.02it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03, 11.70it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03, 11.70it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 11.70it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:02, 12.17it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 12.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:02, 12.17it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:02, 11.33it/s]                                                 67%|██████▋   | 67/100 [00:06<00:02, 11.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:02, 11.33it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:02, 11.27it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 11.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:02, 11.27it/s] 71%|███████   | 71/100 [00:07<00:02, 10.99it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.48it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.17it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.17it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.10it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.07it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:01, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.17it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.96it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.85it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.87it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.87it/s] 87%|████████▋ | 87/100 [00:08<00:01,  9.83it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.82it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.82it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:01,  9.78it/s]                                                 90%|█████████ | 90/100 [00:09<00:01,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.72it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00,  9.75it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00,  9.75it/s] 93%|█████████▎| 93/100 [00:09<00:00,  9.61it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.58it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.36it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00,  9.36it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.76it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00,  9.76it/s] 99%|█████████▉| 99/100 [00:09<00:00, 10.14it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00, 10.01it/s]                                                 100%|██████████| 100/100 [00:10<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A                                                 
[36m(ClientAppActor pid=263676)[0m                                      [A100%|██████████| 100/100 [00:10<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 648.17it/s][A
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.01it/s]100%|██████████| 100/100 [00:10<00:00,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.029 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.011 MB of 0.029 MB uploadedwandb: / 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▆██▆▂█▃▄▁▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂▇▃█▂▅▃▄▆▁▇
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 1.3883
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0201
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 99.529
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 49.765
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 200
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 1.3883
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0201
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 99.529
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 49.765
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 19.43661
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 3.5197
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8312527552512.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 2.51822
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.2362
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.077
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.769
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_0 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143401-uijo9p43_client_0/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143421-uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 930.66 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=263676)[0m Map: 100%|██████████| 2/2 [00:00<00:00, 99.14 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.84it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:09,  9.95it/s]                                                 1%|          | 1/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.84it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:10,  9.59it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.72it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.68it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.62it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.68it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.57it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.46it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:09,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08, 10.10it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08, 10.26it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08, 10.05it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.00it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.89it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08,  9.93it/s]                                                 19%|█▉        | 19/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:02<00:08,  9.75it/s]                                                 20%|██        | 20/100 [00:02<00:08,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:08,  9.61it/s]                                                 21%|██        | 21/100 [00:02<00:08,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:08,  9.49it/s]                                                 22%|██▏       | 22/100 [00:02<00:08,  9.49it/s]                                                 23%|██▎       | 23/100 [00:02<00:08,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.89it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.04it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.98it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.98it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07, 10.13it/s]                                                 29%|██▉       | 29/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06,  9.93it/s]                                                 31%|███       | 31/100 [00:03<00:06,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.02it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.92it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.81it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.81it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.81it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.87it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:04<00:06,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:06,  9.79it/s]                                                 41%|████      | 41/100 [00:04<00:06,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.69it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05,  9.61it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.48it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.76it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.70it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.70it/s] 48%|████▊     | 48/100 [00:04<00:05,  9.75it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.81it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:05<00:05,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1173.56it/s][A 50%|█████     | 50/100 [00:05<00:05,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.47it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:06,  7.47it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.11it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  9.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  9.11it/s] 55%|█████▌    | 55/100 [00:05<00:04, 10.82it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04, 10.82it/s] 57%|█████▋    | 57/100 [00:05<00:03, 12.50it/s]                                                 57%|█████▋    | 57/100 [00:05<00:03, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:03, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:03, 12.16it/s]                                                 59%|█████▉    | 59/100 [00:05<00:03, 12.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:03, 12.16it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03, 11.62it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 11.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03, 11.62it/s] 63%|██████▎   | 63/100 [00:06<00:02, 12.66it/s]                                                 63%|██████▎   | 63/100 [00:06<00:02, 12.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:02, 12.66it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:02, 13.27it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 13.27it/s]                                                 66%|██████▌   | 66/100 [00:06<00:02, 13.27it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:02, 13.89it/s]                                                 67%|██████▋   | 67/100 [00:06<00:02, 13.89it/s]                                                 68%|██████▊   | 68/100 [00:06<00:02, 13.89it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:02, 14.51it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 14.51it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 14.51it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:01, 15.17it/s]                                                 71%|███████   | 71/100 [00:06<00:01, 15.17it/s]                                                 72%|███████▏  | 72/100 [00:06<00:01, 15.17it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:01, 15.60it/s]                                                 73%|███████▎  | 73/100 [00:06<00:01, 15.60it/s]                                                 74%|███████▍  | 74/100 [00:06<00:01, 15.60it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:01, 16.12it/s]                                                 75%|███████▌  | 75/100 [00:06<00:01, 16.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:01, 16.12it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:01, 14.06it/s]                                                 77%|███████▋  | 77/100 [00:07<00:01, 14.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:01, 14.06it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:01, 12.58it/s]                                                 79%|███████▉  | 79/100 [00:07<00:01, 12.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 12.58it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 11.53it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 11.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01, 11.53it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01, 10.86it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01, 10.86it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01, 10.72it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.39it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.16it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00, 10.07it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00, 10.07it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:08<00:00, 10.08it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.00it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.76it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 752.75it/s][A100%|██████████| 100/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.76it/s]100%|██████████| 100/100 [00:09<00:00, 10.37it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 2.43413
wandb:  eval/eval_model_preparation_time 0.0014
wandb:                 eval/eval_runtime 0.0967
wandb:      eval/eval_samples_per_second 206.929
wandb:        eval/eval_steps_per_second 51.732
wandb:                              iter 100
wandb:                   train/eval_loss 2.43413
wandb: train/eval_model_preparation_time 0.0014
wandb:                train/eval_runtime 0.0967
wandb:     train/eval_samples_per_second 206.929
wandb:       train/eval_steps_per_second 51.732
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143347-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143439-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:34:48,840	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:34:48,841	ERROR client.py:240 -- Config: {}
2024-11-11 14:34:48,842	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:34:49,712	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 73.57it/s]
[92mINFO [0m:      fit progress: (2, 0.0, {}, 103.13960259826854)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploadedwandb: | 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▄▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▄▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▄▂▃▇▇▄█▂▅▅
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂█▄▇▂▆▄▅▄▂▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.10273
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0015
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0243
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 82.255
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 41.127
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 200
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.10273
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0015
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0243
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 82.255
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 41.127
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 29.11481
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.5278
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8385751449600.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 2.32778
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.6419
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.486
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.371
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_9 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143421-uijo9p43_client_9/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143453-uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1384.80 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 129.01 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 914.59it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:09,  9.91it/s]                                                 1%|          | 1/100 [00:00<00:09,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  2%|▏         | 2/100 [00:00<00:09,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:09, 10.39it/s]                                                 3%|▎         | 3/100 [00:00<00:09, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:09, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09, 10.16it/s]                                                 5%|▌         | 5/100 [00:00<00:09, 10.16it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09, 10.33it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:08, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09, 10.03it/s]                                                 9%|▉         | 9/100 [00:00<00:09, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:00<00:08, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08,  9.93it/s]                                                 11%|█         | 11/100 [00:01<00:08,  9.93it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.93it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.97it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.86it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.86it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.87it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.87it/s] 19%|█▉        | 19/100 [00:01<00:07, 11.22it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 11.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 11.22it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:06, 11.30it/s]                                                 21%|██        | 21/100 [00:02<00:06, 11.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:06, 11.30it/s] 23%|██▎       | 23/100 [00:02<00:07, 10.99it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:06, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.53it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.17it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.17it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07, 10.00it/s]                                                 29%|██▉       | 29/100 [00:02<00:07, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06,  9.95it/s]                                                 31%|███       | 31/100 [00:03<00:06,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06,  9.95it/s] 33%|███▎      | 33/100 [00:03<00:06,  9.88it/s]                                                 33%|███▎      | 33/100 [00:03<00:06,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06,  9.75it/s]                                                 34%|███▍      | 34/100 [00:03<00:06,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.76it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.77it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.76it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.84it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.84it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05,  9.85it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.02it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.96it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.79it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.83it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05,  9.83it/s] 49%|████▉     | 49/100 [00:04<00:05, 10.17it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1141.62it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.52it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.52it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.91it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:05,  7.91it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.53it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.53it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.03it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  9.03it/s] 58%|█████▊    | 58/100 [00:05<00:03, 10.52it/s]                                                 58%|█████▊    | 58/100 [00:05<00:03, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:03, 10.52it/s] 60%|██████    | 60/100 [00:05<00:03, 12.21it/s]                                                 60%|██████    | 60/100 [00:05<00:03, 12.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:03, 12.21it/s] 62%|██████▏   | 62/100 [00:06<00:02, 13.09it/s]                                                 62%|██████▏   | 62/100 [00:06<00:02, 13.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:02, 13.09it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:02, 12.61it/s]                                                 64%|██████▍   | 64/100 [00:06<00:02, 12.61it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 12.61it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:02, 11.63it/s]                                                 66%|██████▌   | 66/100 [00:06<00:02, 11.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:02, 11.63it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:02, 10.74it/s]                                                 68%|██████▊   | 68/100 [00:06<00:02, 10.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:02, 10.74it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 10.44it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.44it/s]                                                
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 10.48it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.32it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.22it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.49it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 11.47it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 11.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 11.47it/s] 82%|████████▏ | 82/100 [00:07<00:01, 12.50it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:07<00:01, 12.50it/s] 84%|████████▍ | 84/100 [00:08<00:01, 13.54it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 13.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 13.54it/s] 86%|████████▌ | 86/100 [00:08<00:00, 14.10it/s]                                                 86%|████████▌ | 86/100 [00:08<00:00, 14.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:00, 14.10it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:00, 12.70it/s]                                                 88%|████████▊ | 88/100 [00:08<00:00, 12.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:00, 12.70it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 11.96it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 11.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 11.96it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00, 11.02it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 11.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 11.02it/s] 94%|█████████▍| 94/100 [00:08<00:00, 10.96it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 10.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 10.96it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 10.82it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.30it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.30it/s]100%|██████████| 100/100 [00:09<00:00, 10.50it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 777.44it/s][A100%|██████████| 100/100 [00:09<00:00, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.50it/s]100%|██████████| 100/100 [00:09<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploadedwandb: | 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▅▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▄█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▄█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▅▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▄█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▄█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▁█▂▃▃▁▃▃▄▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▄▃▂▆▁▂█▂▇▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.80751
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0177
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 113.031
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 56.516
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 300
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.80751
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0177
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 113.031
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 56.516
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 27.03852
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.6795
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8422363398144.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 2.0587
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.7604
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 40.982
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.246
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_1 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143453-uijo9p43_client_1/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143512-uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 935.39it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:09, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.13it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.13it/s]  4%|▍         | 4/100 [00:00<00:07, 12.23it/s]                                                 4%|▍         | 4/100 [00:00<00:07, 12.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:07, 12.23it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:08, 11.63it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 11.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:07, 11.63it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.78it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 11.02it/s]                                                 10%|█         | 10/100 [00:00<00:08, 11.02it/s]                                                 11%|█         | 11/100 [00:01<00:08, 11.02it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.61it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.31it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.15it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.10it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.21it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.04it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.01it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.01it/s] 26%|██▌       | 26/100 [00:02<00:07, 10.11it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.26it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.07it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.06it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06,  9.80it/s]                                                 34%|███▍      | 34/100 [00:03<00:06,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.88it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.82it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:06,  9.92it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05,  9.92it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.11it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.18it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.03it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.03it/s] 49%|████▉     | 49/100 [00:04<00:04, 10.41it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 753.83it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.99it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.99it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:05,  8.28it/s]                                                 52%|█████▏    | 52/100 [00:05<00:05,  8.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:05,  8.28it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.85it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.85it/s]                                                
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.85it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.21it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.21it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.33it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.33it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.36it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.36it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.38it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.38it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03, 10.88it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 10.88it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 10.88it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:02, 12.42it/s]                                                 63%|██████▎   | 63/100 [00:06<00:02, 12.42it/s]                                                 64%|██████▍   | 64/100 [00:06<00:02, 12.42it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 11.45it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 11.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:02, 11.45it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03, 10.85it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03, 10.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:02, 10.85it/s] 69%|██████▉   | 69/100 [00:06<00:02, 10.53it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:02, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.30it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.52it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.52it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.37it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.29it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.29it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.24it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.09it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.09it/s] 83%|████████▎ | 83/100 [00:08<00:01, 10.46it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.46it/s] 85%|████████▌ | 85/100 [00:08<00:01, 11.49it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 11.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 11.49it/s] 87%|████████▋ | 87/100 [00:08<00:01, 12.63it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 12.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:00, 12.63it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:00, 11.91it/s]                                                 89%|████████▉ | 89/100 [00:08<00:00, 11.91it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 11.91it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 11.70it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 11.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 11.70it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00, 11.12it/s]                                                
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00, 11.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 11.12it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 11.00it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 11.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 11.00it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.52it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.52it/s]                                                
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00, 10.37it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 749.92it/s][A100%|██████████| 100/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.37it/s]100%|██████████| 100/100 [00:09<00:00, 10.08it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.004 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb: - 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 2.08879
wandb:  eval/eval_model_preparation_time 0.0032
wandb:                 eval/eval_runtime 0.0999
wandb:      eval/eval_samples_per_second 200.135
wandb:        eval/eval_steps_per_second 50.034
wandb:                              iter 200
wandb:                   train/eval_loss 2.08879
wandb: train/eval_model_preparation_time 0.0032
wandb:                train/eval_runtime 0.0999
wandb:     train/eval_samples_per_second 200.135
wandb:       train/eval_steps_per_second 50.034
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143439-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143528-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:35:36,860	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:35:36,861	ERROR client.py:240 -- Config: {}
2024-11-11 14:35:36,862	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:35:37,681	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 72.92it/s]
[92mINFO [0m:      fit progress: (3, 0.0, {}, 151.06317740911618)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▅
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▅
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▃█▃█▄▃█▃▂▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂█▄▇▂▆▄▅▄▃▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 1.67766
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0212
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 94.179
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 47.089
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 300
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 1.67766
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0212
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 94.179
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 47.089
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 22.25173
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.2291
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8385751449600.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 2.03967
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.9148
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 40.344
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.086
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_9 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143512-uijo9p43_client_9/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143539-uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.92it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.05it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.05it/s]  4%|▍         | 4/100 [00:00<00:09, 10.02it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.95it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09, 10.12it/s]                                                 8%|▊         | 8/100 [00:00<00:09, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.12it/s] 10%|█         | 10/100 [00:00<00:08, 10.07it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.93it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.91it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.85it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.85it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.86it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.80it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.13it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.12it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.08it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.05it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.86it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07,  9.86it/s] 29%|██▉       | 29/100 [00:02<00:07, 10.03it/s]                                                 29%|██▉       | 29/100 [00:02<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.17it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.17it/s] 33%|███▎      | 33/100 [00:03<00:06, 10.32it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.09it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.09it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:05, 11.12it/s]                                                 37%|███▋      | 37/100 [00:03<00:05, 11.12it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 11.12it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:05, 12.10it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 12.10it/s]                                                 40%|████      | 40/100 [00:03<00:04, 12.10it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:04, 13.17it/s]                                                 41%|████      | 41/100 [00:03<00:04, 13.17it/s]                                                 42%|████▏     | 42/100 [00:03<00:04, 13.17it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:04, 14.03it/s]                                                 43%|████▎     | 43/100 [00:03<00:04, 14.03it/s]                                                 44%|████▍     | 44/100 [00:04<00:03, 14.03it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:03, 14.73it/s]                                                 45%|████▌     | 45/100 [00:04<00:03, 14.73it/s]                                                 46%|████▌     | 46/100 [00:04<00:03, 14.73it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:03, 14.74it/s]                                                 47%|████▋     | 47/100 [00:04<00:03, 14.74it/s]                                                 48%|████▊     | 48/100 [00:04<00:03, 14.74it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:03, 15.24it/s]                                                 49%|████▉     | 49/100 [00:04<00:03, 15.24it/s]                                                 50%|█████     | 50/100 [00:04<00:03, 15.24it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 744.46it/s][A 50%|█████     | 50/100 [00:04<00:03, 15.24it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:05,  9.79it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:05,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:04<00:04,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:04, 10.00it/s]                                                 53%|█████▎    | 53/100 [00:04<00:04, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:04, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04,  9.95it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.98it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.84it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:04,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03,  9.84it/s]                                                 61%|██████    | 61/100 [00:05<00:03,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03,  9.87it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.65it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.67it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.64it/s]                                                
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.90it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02,  9.81it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.81it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 10.00it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.28it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.00it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.13it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.13it/s] 81%|████████  | 81/100 [00:07<00:01, 10.28it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01, 10.36it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.38it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.27it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.10it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.10it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.96it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00,  9.92it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00,  9.87it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.84it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.91it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.91it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.99it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.99it/s]                                                100%|██████████| 100/100 [00:09<00:00,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 771.58it/s][A100%|██████████| 100/100 [00:09<00:00,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.99it/s]100%|██████████| 100/100 [00:09<00:00, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 4
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.016 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.016 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▅▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▄█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▄█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▅▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▄█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▄█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃██▂▃▁▄▇▃▄▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▄▃▂▆▁▂█▂▇▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.86151
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0249
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 80.17
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 40.085
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 400
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.86151
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0249
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 80.17
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 40.085
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 17.76234
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7063
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8422363398144.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.8833
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.8304
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 40.69
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.173
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_1 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143539-uijo9p43_client_1/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143559-uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1083.04 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]
[36m(ClientAppActor pid=263676)[0m Map: 100%|██████████| 2/2 [00:00<00:00, 100.78 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 976.56it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.49it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:10,  9.45it/s]                                                 2%|▏         | 2/100 [00:00<00:10,  9.45it/s]  3%|▎         | 3/100 [00:00<00:10,  9.67it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.73it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.79it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.72it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.62it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:08, 10.26it/s]                                                 10%|█         | 10/100 [00:01<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.28it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.15it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.08it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.05it/s]                                                 20%|██        | 20/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.05it/s] 22%|██▏       | 22/100 [00:02<00:07,  9.96it/s]                                                 22%|██▏       | 22/100 [00:02<00:07,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07,  9.93it/s]                                                 23%|██▎       | 23/100 [00:02<00:07,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.13it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.13it/s] 27%|██▋       | 27/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.93it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:03<00:07,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.01it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.10it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.89it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.76it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.61it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.61it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.94it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:04<00:06,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05,  9.94it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.91it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.91it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.71it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.93it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.81it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05,  9.72it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:05<00:05,  9.81it/s]                                                 50%|█████     | 50/100 [00:05<00:05,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 742.35it/s][A 50%|█████     | 50/100 [00:05<00:05,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:07,  6.97it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:07,  6.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:06,  6.97it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:06,  7.83it/s]                                                 53%|█████▎    | 53/100 [00:05<00:06,  7.83it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.10it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.10it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.97it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  8.97it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.59it/s]                                                 58%|█████▊    | 58/100 [00:06<00:04,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:06<00:04,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.96it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:03,  9.96it/s] 62%|██████▏   | 62/100 [00:06<00:03,  9.89it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.78it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.69it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.88it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.88it/s] 68%|██████▊   | 68/100 [00:07<00:03,  9.72it/s]                                                 68%|██████▊   | 68/100 [00:07<00:03,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:07<00:03,  9.77it/s]                                                 69%|██████▉   | 69/100 [00:07<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.01it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.97it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.97it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.99it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.83it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.67it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.67it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:08<00:02,  9.64it/s]                                                 78%|███████▊  | 78/100 [00:08<00:02,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:08<00:02,  9.64it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02,  9.64it/s]                                                 80%|████████  | 80/100 [00:08<00:02,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.14it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.35it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.39it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.04it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:09<00:01, 10.04it/s] 89%|████████▉ | 89/100 [00:09<00:01, 10.40it/s]                                                 89%|████████▉ | 89/100 [00:09<00:01, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:09<00:00, 10.40it/s] 91%|█████████ | 91/100 [00:09<00:00, 11.66it/s]                                                 91%|█████████ | 91/100 [00:09<00:00, 11.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 11.66it/s] 93%|█████████▎| 93/100 [00:09<00:00, 12.12it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 12.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 12.12it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 11.09it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.75it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.75it/s] 99%|█████████▉| 99/100 [00:09<00:00, 12.02it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 12.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:10<00:00, 12.02it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 762.32it/s][A100%|██████████| 100/100 [00:10<00:00, 12.02it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 12.02it/s]100%|██████████| 100/100 [00:10<00:00,  9.81it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.95246
wandb:  eval/eval_model_preparation_time 0.0008
wandb:                 eval/eval_runtime 0.0916
wandb:      eval/eval_samples_per_second 218.429
wandb:        eval/eval_steps_per_second 54.607
wandb:                              iter 300
wandb:                   train/eval_loss 1.95246
wandb: train/eval_model_preparation_time 0.0008
wandb:                train/eval_runtime 0.0916
wandb:     train/eval_samples_per_second 218.429
wandb:       train/eval_steps_per_second 54.607
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143528-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143619-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:36:27,127	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:36:27,128	ERROR client.py:240 -- Config: {}
2024-11-11 14:36:27,128	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:36:28,028	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 63.57it/s]
[92mINFO [0m:      fit progress: (4, 0.0, {}, 201.47145106690004)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploadedwandb: | 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ██▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ██▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▃▆▄█▃▃▃▇▁▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▁█▂▇▄▁▆▇▅▆
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.73451
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0215
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 92.895
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 46.448
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 400
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.73451
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0215
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 92.895
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 46.448
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 19.19661
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.5129
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8315758018560.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.89924
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.1957
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.232
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.808
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_4 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143559-uijo9p43_client_4/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143630-uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.86it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.52it/s]  2%|▏         | 2/100 [00:00<00:09, 10.73it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.73it/s]  4%|▍         | 4/100 [00:00<00:07, 13.30it/s]                                                 4%|▍         | 4/100 [00:00<00:07, 13.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:07, 13.30it/s]  6%|▌         | 6/100 [00:00<00:06, 13.81it/s]                                                 6%|▌         | 6/100 [00:00<00:06, 13.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:06, 13.81it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:07, 12.22it/s]                                                 8%|▊         | 8/100 [00:00<00:07, 12.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:07, 12.22it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 11.22it/s]                                                 10%|█         | 10/100 [00:00<00:08, 11.22it/s]                                                 11%|█         | 11/100 [00:00<00:07, 11.22it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.72it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.27it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.99it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.93it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:08,  9.92it/s]                                                 20%|██        | 20/100 [00:01<00:08,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07,  9.92it/s] 22%|██▏       | 22/100 [00:02<00:07,  9.99it/s]                                                 22%|██▏       | 22/100 [00:02<00:07,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.96it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.83it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.83it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07,  9.83it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.18it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.00it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06,  9.87it/s]                                                 34%|███▍      | 34/100 [00:03<00:06,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06,  9.87it/s] 36%|███▌      | 36/100 [00:03<00:05, 10.85it/s]                                                 36%|███▌      | 36/100 [00:03<00:05, 10.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:05, 10.85it/s] 38%|███▊      | 38/100 [00:03<00:05, 12.23it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 12.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:04, 12.23it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:04, 13.23it/s]                                                 40%|████      | 40/100 [00:03<00:04, 13.23it/s]                                                 41%|████      | 41/100 [00:03<00:04, 13.23it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:03<00:04, 13.76it/s]                                                 42%|████▏     | 42/100 [00:03<00:04, 13.76it/s]                                                 43%|████▎     | 43/100 [00:03<00:04, 13.76it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:03, 14.51it/s]                                                 44%|████▍     | 44/100 [00:03<00:03, 14.51it/s]                                                 45%|████▌     | 45/100 [00:03<00:03, 14.51it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:03, 14.95it/s]                                                 46%|████▌     | 46/100 [00:04<00:03, 14.95it/s]                                                 47%|████▋     | 47/100 [00:04<00:03, 14.95it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:03, 15.36it/s]                                                 48%|████▊     | 48/100 [00:04<00:03, 15.36it/s]                                                 49%|████▉     | 49/100 [00:04<00:03, 15.36it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:03, 15.42it/s]                                                 50%|█████     | 50/100 [00:04<00:03, 15.42it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 897.18it/s][A 50%|█████     | 50/100 [00:04<00:03, 15.42it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:03, 15.42it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:04,  9.88it/s]                                                 52%|█████▏    | 52/100 [00:04<00:04,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:04<00:04,  9.88it/s] 54%|█████▍    | 54/100 [00:04<00:04,  9.78it/s]                                                 54%|█████▍    | 54/100 [00:04<00:04,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:04<00:04,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.78it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.95it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.96it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:05<00:03, 10.06it/s]                                                 62%|██████▏   | 62/100 [00:05<00:03, 10.06it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:05<00:03, 10.02it/s]                                                 64%|██████▍   | 64/100 [00:05<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:05<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03, 10.28it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.00it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 10.03it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:06<00:02, 10.03it/s] 72%|███████▏  | 72/100 [00:06<00:02, 10.23it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:06<00:02, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:06<00:02,  9.98it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:06<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.95it/s]                                                
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.89it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02,  9.73it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:02,  9.74it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01,  9.77it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:07<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:07<00:01,  9.88it/s]                                                 84%|████████▍ | 84/100 [00:07<00:01,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:07<00:01,  9.88it/s] 86%|████████▌ | 86/100 [00:08<00:01,  9.90it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.72it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.59it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.44it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:01,  9.48it/s]                                                 90%|█████████ | 90/100 [00:08<00:01,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.39it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.39it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00,  9.45it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00,  9.46it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:08<00:00,  9.46it/s] 95%|█████████▌| 95/100 [00:09<00:00,  9.70it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.71it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.72it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.73it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.80it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.80it/s]                                                100%|██████████| 100/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 777.44it/s][A100%|██████████| 100/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.80it/s]100%|██████████| 100/100 [00:09<00:00, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.017 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.017 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▃▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▃▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▂█▂█▂▃▅▇▂▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▇▃▇▃▆▂▃▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.98916
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0206
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 97.083
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 48.541
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 500
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.98916
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0206
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 97.083
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 48.541
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 31.24658
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 3.1724
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8312527552512.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 2.04987
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.7295
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.112
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.278
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_0 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143630-uijo9p43_client_0/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143648-uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1165.59 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 113.26 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1321.87it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.65it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.88it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:08, 10.88it/s]  4%|▍         | 4/100 [00:00<00:09, 10.53it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.21it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.91it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.87it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:00<00:09,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08, 10.06it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08, 10.06it/s] 13%|█▎        | 13/100 [00:01<00:08, 10.04it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.86it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.75it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.80it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.17it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.42it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.17it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.14it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:06, 10.33it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.19it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.24it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.13it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.04it/s]                                                
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06, 10.07it/s]                                                 39%|███▉      | 39/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05,  9.91it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.91it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.24it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.22it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.19it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:04, 10.36it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 770.02it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:05,  8.65it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:05,  8.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:05,  8.65it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.13it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  9.13it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:04,  9.26it/s]                                                 54%|█████▍    | 54/100 [00:05<00:04,  9.26it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04,  9.37it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.37it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.48it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.91it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.91it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.96it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03, 10.14it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03, 10.07it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03, 10.06it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03, 10.06it/s] 68%|██████▊   | 68/100 [00:06<00:03, 10.25it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:07<00:02, 10.15it/s]                                                 70%|███████   | 70/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 10.21it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.21it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.25it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.27it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.21it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 10.16it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.16it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01, 10.05it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 10.59it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.59it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.53it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.53it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.37it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.37it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.21it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:09<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.15it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00, 10.26it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.89it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.76it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.78it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 10.05it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1095.12it/s][A100%|██████████| 100/100 [00:09<00:00, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.05it/s]100%|██████████| 100/100 [00:10<00:00,  9.85it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb: - 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.85542
wandb:  eval/eval_model_preparation_time 0.0027
wandb:                 eval/eval_runtime 0.1058
wandb:      eval/eval_samples_per_second 188.955
wandb:        eval/eval_steps_per_second 47.239
wandb:                              iter 400
wandb:                   train/eval_loss 1.85542
wandb: train/eval_model_preparation_time 0.0027
wandb:                train/eval_runtime 0.1058
wandb:     train/eval_samples_per_second 188.955
wandb:       train/eval_steps_per_second 47.239
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143619-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143707-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:37:15,361	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:37:15,362	ERROR client.py:240 -- Config: {}
2024-11-11 14:37:15,363	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:37:16,213	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 69.70it/s]
[92mINFO [0m:      fit progress: (5, 0.0, {}, 249.6401149602607)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploadedwandb: | 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▅
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▅
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▄▄▂▁▃▃▆█▄▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▂▃▁▁▇▆██▃▄
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.66562
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.001
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0202
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 99.234
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 49.617
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 500
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.66562
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.001
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0202
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 99.234
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 49.617
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 19.72826
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.6463
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8263532150784.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.79654
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.1553
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.388
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.847
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_7 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143648-uijo9p43_client_7/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143718-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1191.07 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 109.84 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1015.08it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:09,  9.95it/s]                                                 1%|          | 1/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  2%|▏         | 2/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:09, 10.45it/s]                                                 3%|▎         | 3/100 [00:00<00:09, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:09, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09, 10.06it/s]                                                 5%|▌         | 5/100 [00:00<00:09, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:08, 10.44it/s]                                                 7%|▋         | 7/100 [00:00<00:08, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:08, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:08, 10.27it/s]                                                 9%|▉         | 9/100 [00:00<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:00<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08,  9.95it/s]                                                 11%|█         | 11/100 [00:01<00:08,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.93it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.94it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.94it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.85it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.78it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.61it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.69it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.69it/s] 19%|█▉        | 19/100 [00:01<00:08,  9.71it/s]                                                 19%|█▉        | 19/100 [00:01<00:08,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:08,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:08,  9.81it/s]                                                 21%|██        | 21/100 [00:02<00:08,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07,  9.78it/s]                                                 22%|██▏       | 22/100 [00:02<00:07,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.11it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.88it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.84it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.84it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:03<00:07,  9.84it/s] 31%|███       | 31/100 [00:03<00:06, 10.56it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.56it/s] 33%|███▎      | 33/100 [00:03<00:05, 11.69it/s]                                                 33%|███▎      | 33/100 [00:03<00:05, 11.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:05, 11.69it/s] 35%|███▌      | 35/100 [00:03<00:05, 12.95it/s]                                                 35%|███▌      | 35/100 [00:03<00:05, 12.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:04, 12.95it/s] 37%|███▋      | 37/100 [00:03<00:04, 13.98it/s]                                                 37%|███▋      | 37/100 [00:03<00:04, 13.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:04, 13.98it/s] 39%|███▉      | 39/100 [00:03<00:04, 13.74it/s]                                                 39%|███▉      | 39/100 [00:03<00:04, 13.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:04, 13.74it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:04, 12.18it/s]                                                 41%|████      | 41/100 [00:03<00:04, 12.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:04, 12.18it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 11.39it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 11.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:04, 11.39it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.92it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:04, 10.92it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.41it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.41it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:04, 10.27it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 767.63it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.99it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:06,  7.99it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.52it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.52it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.52it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.94it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.94it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.81it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  8.81it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.22it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.57it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:04,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03,  9.80it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.80it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03, 10.13it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.93it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.93it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.93it/s] 69%|██████▉   | 69/100 [00:06<00:03,  9.90it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.92it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.70it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.69it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.59it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.69it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.67it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.74it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.98it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02,  9.98it/s] 80%|████████  | 80/100 [00:07<00:01, 10.00it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01,  9.77it/s]                                                 81%|████████  | 81/100 [00:08<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.95it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.84it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01,  9.84it/s] 86%|████████▌ | 86/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.85it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.85it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:01,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:01,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.77it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00, 10.13it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.13it/s] 95%|█████████▌| 95/100 [00:09<00:00, 10.37it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.98it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.94it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 10.24it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 881.90it/s][A100%|██████████| 100/100 [00:09<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.24it/s]100%|██████████| 100/100 [00:10<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.011 MB of 0.027 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.011 MB of 0.027 MB uploadedwandb: - 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▃▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▃▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▁▂▃▁▁▄▁█▁▄
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▂▇█▂▄▆▂▃▁▆
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.42523
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0236
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 84.906
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 42.453
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 600
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.42523
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0236
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 84.906
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 42.453
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 50.53154
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.3081
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.68113
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.1377
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.457
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.864
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143718-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143738-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 317.34it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.17it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.83it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.83it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.88it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.84it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:09,  9.84it/s]  9%|▉         | 9/100 [00:00<00:09, 10.09it/s]                                                 9%|▉         | 9/100 [00:00<00:09, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:08, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.82it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.83it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.90it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08,  9.90it/s] 17%|█▋        | 17/100 [00:01<00:08, 10.07it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.33it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.06it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.48it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.48it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:06, 11.73it/s]                                                 25%|██▌       | 25/100 [00:02<00:06, 11.73it/s]                                                 26%|██▌       | 26/100 [00:02<00:06, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:05, 12.71it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 12.71it/s]                                                 28%|██▊       | 28/100 [00:02<00:05, 12.71it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:05, 13.78it/s]                                                 29%|██▉       | 29/100 [00:02<00:05, 13.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:05, 13.78it/s] 31%|███       | 31/100 [00:02<00:04, 14.46it/s]                                                 31%|███       | 31/100 [00:02<00:04, 14.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:02<00:04, 14.46it/s] 33%|███▎      | 33/100 [00:02<00:04, 15.30it/s]                                                 33%|███▎      | 33/100 [00:02<00:04, 15.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:02<00:04, 15.30it/s] 35%|███▌      | 35/100 [00:02<00:04, 15.89it/s]                                                 35%|███▌      | 35/100 [00:02<00:04, 15.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:04, 15.89it/s] 37%|███▋      | 37/100 [00:03<00:03, 16.18it/s]                                                 37%|███▋      | 37/100 [00:03<00:03, 16.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:03, 16.18it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:03, 15.94it/s]                                                 39%|███▉      | 39/100 [00:03<00:03, 15.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:03, 15.94it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:03, 15.85it/s]                                                 41%|████      | 41/100 [00:03<00:03, 15.85it/s]                                                 42%|████▏     | 42/100 [00:03<00:03, 15.85it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:03, 15.94it/s]                                                 43%|████▎     | 43/100 [00:03<00:03, 15.94it/s]                                                 44%|████▍     | 44/100 [00:03<00:03, 15.94it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:03<00:03, 16.30it/s]                                                 45%|████▌     | 45/100 [00:03<00:03, 16.30it/s]                                                 46%|████▌     | 46/100 [00:03<00:03, 16.30it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:03<00:03, 15.93it/s]                                                 47%|████▋     | 47/100 [00:03<00:03, 15.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:03<00:03, 15.93it/s] 49%|████▉     | 49/100 [00:03<00:03, 13.79it/s]                                                 49%|████▉     | 49/100 [00:03<00:03, 13.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:03, 13.79it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 747.25it/s][A 50%|█████     | 50/100 [00:04<00:03, 13.79it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:05,  9.44it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:05,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:04<00:05,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:04,  9.42it/s]                                                 53%|█████▎    | 53/100 [00:04<00:04,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:04<00:04,  9.42it/s] 55%|█████▌    | 55/100 [00:04<00:04,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:04<00:04,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:04<00:04,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:04<00:04, 10.04it/s]                                                 57%|█████▋    | 57/100 [00:04<00:04, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:04<00:04, 10.04it/s] 59%|█████▉    | 59/100 [00:05<00:04, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:03, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03, 10.00it/s]                                                 61%|██████    | 61/100 [00:05<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03,  9.86it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:05<00:03,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:05<00:03,  9.94it/s]                                                 65%|██████▌   | 65/100 [00:05<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:05<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:05<00:03,  9.89it/s]                                                 67%|██████▋   | 67/100 [00:05<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:05<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03, 10.18it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03, 10.18it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02, 10.38it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 10.12it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:06<00:02, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02, 10.12it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:06<00:02, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:06<00:02, 10.04it/s]                                                 77%|███████▋  | 77/100 [00:06<00:02, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:06<00:02, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.01it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.96it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01,  9.91it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01,  9.90it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01,  9.84it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01,  9.75it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:01,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:01,  9.83it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:01,  9.81it/s]                                                 90%|█████████ | 90/100 [00:08<00:01,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.75it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00,  9.70it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00,  9.58it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00,  9.50it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:08<00:00,  9.53it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00,  9.53it/s] 96%|█████████▌| 96/100 [00:08<00:00,  9.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:08<00:00,  9.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00,  9.43it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.76it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00,  9.85it/s]                                                 100%|██████████| 100/100 [00:09<00:00,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 779.76it/s][A100%|██████████| 100/100 [00:09<00:00,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.85it/s]100%|██████████| 100/100 [00:09<00:00, 10.56it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.004 MB uploadedwandb: | 0.000 MB of 0.004 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.81584
wandb:  eval/eval_model_preparation_time 0.0018
wandb:                 eval/eval_runtime 0.093
wandb:      eval/eval_samples_per_second 215.073
wandb:        eval/eval_steps_per_second 53.768
wandb:                              iter 500
wandb:                   train/eval_loss 1.81584
wandb: train/eval_model_preparation_time 0.0018
wandb:                train/eval_runtime 0.093
wandb:     train/eval_samples_per_second 215.073
wandb:       train/eval_steps_per_second 53.768
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143707-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143756-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:38:04,317	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:38:04,319	ERROR client.py:240 -- Config: {}
2024-11-11 14:38:04,319	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:38:05,201	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 75.00it/s]
[92mINFO [0m:      fit progress: (6, 0.0, {}, 298.6086110868491)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▅▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▅▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▅█▄▇▅▅█▅▆▃▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▁▂██▆▂▃▇▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.43393
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0229
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 87.329
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 43.664
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 600
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.43393
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0229
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 87.329
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 43.664
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 14.11504
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.9459
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.59919
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.4714
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 42.233
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.558
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143738-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143807-uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 962.22it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                       
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.44it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:08, 11.07it/s]                                                 4%|▍         | 4/100 [00:00<00:08, 11.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:08, 11.07it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.39it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:08, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.38it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.28it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.41it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.41it/s] 14%|█▍        | 14/100 [00:01<00:08, 10.37it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.10it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.03it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.03it/s]                                                 19%|█▉        | 19/100 [00:01<00:08, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:08,  9.97it/s]                                                 20%|██        | 20/100 [00:01<00:08,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07,  9.95it/s]                                                 21%|██        | 21/100 [00:02<00:07,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07,  9.92it/s]                                                 22%|██▏       | 22/100 [00:02<00:07,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.96it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.96it/s]                                                 25%|██▌       | 25/100 [00:02<00:07,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.05it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.17it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.66it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.66it/s] 32%|███▏      | 32/100 [00:03<00:06, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.13it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.13it/s] 36%|███▌      | 36/100 [00:03<00:06, 10.26it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.15it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.09it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05, 10.05it/s]                                                 42%|████▏     | 42/100 [00:04<00:05, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.43it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05, 10.61it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.61it/s]                                                 47%|████▋     | 47/100 [00:04<00:04, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:04, 11.80it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 11.80it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 11.80it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:03, 12.75it/s]                                                 50%|█████     | 50/100 [00:04<00:03, 12.75it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 753.15it/s][A 50%|█████     | 50/100 [00:04<00:03, 12.75it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:03, 12.75it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:05,  8.98it/s]                                                 52%|█████▏    | 52/100 [00:05<00:05,  8.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:05,  8.98it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:04,  9.21it/s]                                                 54%|█████▍    | 54/100 [00:05<00:04,  9.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:04,  9.21it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.31it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.31it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.31it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.65it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.85it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03,  9.72it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.72it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03, 10.00it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.91it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.00it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 10.12it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.12it/s]                                                
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.98it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.90it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02,  9.90it/s] 76%|███████▌  | 76/100 [00:07<00:02, 10.46it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.09it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:02,  9.95it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.95it/s]                                                 81%|████████  | 81/100 [00:08<00:01,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.82it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.83it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.99it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 11.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 11.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 11.07it/s] 89%|████████▉ | 89/100 [00:08<00:00, 12.10it/s]                                                 89%|████████▉ | 89/100 [00:08<00:00, 12.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 12.10it/s] 91%|█████████ | 91/100 [00:08<00:00, 12.83it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 12.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 12.83it/s] 93%|█████████▎| 93/100 [00:08<00:00, 13.55it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00, 13.55it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:08<00:00, 13.55it/s] 95%|█████████▌| 95/100 [00:09<00:00, 14.74it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 14.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 14.74it/s] 97%|█████████▋| 97/100 [00:09<00:00, 15.66it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 15.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 15.66it/s] 99%|█████████▉| 99/100 [00:09<00:00, 15.71it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 15.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 15.71it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1189.54it/s][A100%|██████████| 100/100 [00:09<00:00, 15.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 15.71it/s]100%|██████████| 100/100 [00:09<00:00, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.000 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▆█▃▃▁▆▄▃▇▅
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▄▃▃▅▁▂█▁▇▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.82966
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0179
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 111.597
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 55.798
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 700
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.82966
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0179
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 111.597
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 55.798
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 29.02317
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.6518
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8422363398144.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.65263
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.5693
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.8
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.45
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_1 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143807-uijo9p43_client_1/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143824-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 948.51it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:07, 13.41it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:07, 13.53it/s]                                                 2%|▏         | 2/100 [00:00<00:07, 13.53it/s]                                                 3%|▎         | 3/100 [00:00<00:07, 13.53it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:06, 14.67it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 14.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:06, 14.67it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:08, 11.72it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 11.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:07, 11.72it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 11.37it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 11.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 11.37it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.87it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:00<00:08, 10.87it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.32it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.22it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.22it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.19it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.98it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.87it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.87it/s]                                                 21%|██        | 21/100 [00:01<00:07, 10.87it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.98it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.98it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.67it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.40it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:06, 10.50it/s]                                                 28%|██▊       | 28/100 [00:02<00:06, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.42it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.42it/s] 32%|███▏      | 32/100 [00:03<00:06, 10.13it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.07it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.98it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.98it/s]                                                
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.91it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:06,  9.94it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05,  9.87it/s]                                                 41%|████      | 41/100 [00:03<00:05,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.00it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.92it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05,  9.93it/s]                                                 45%|████▌     | 45/100 [00:04<00:05,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.75it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.05it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.05it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.76it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 916.19it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.89it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:05,  7.89it/s] 54%|█████▍    | 54/100 [00:05<00:05,  8.51it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.51it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.74it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:05,  8.74it/s] 57%|█████▋    | 57/100 [00:05<00:04, 10.31it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:03, 10.51it/s]                                                 59%|█████▉    | 59/100 [00:05<00:03, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:03, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03, 10.44it/s]                                                 61%|██████    | 61/100 [00:05<00:03, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03, 10.27it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03, 10.27it/s] 65%|██████▌   | 65/100 [00:06<00:03, 10.17it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03, 10.01it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03, 10.03it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03, 10.03it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02,  9.99it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.89it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.89it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.89it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.93it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.16it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:02,  9.99it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.78it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.68it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01,  9.68it/s] 85%|████████▌ | 85/100 [00:08<00:01, 10.00it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.82it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.12it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.12it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.07it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00,  9.89it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.80it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.87it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.65it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.71it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.73it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 733.91it/s][A100%|██████████| 100/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.73it/s]100%|██████████| 100/100 [00:10<00:00,  9.86it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.74071
wandb:  eval/eval_model_preparation_time 0.0017
wandb:                 eval/eval_runtime 0.0908
wandb:      eval/eval_samples_per_second 220.385
wandb:        eval/eval_steps_per_second 55.096
wandb:                              iter 600
wandb:                   train/eval_loss 1.74071
wandb: train/eval_model_preparation_time 0.0017
wandb:                train/eval_runtime 0.0908
wandb:     train/eval_samples_per_second 220.385
wandb:       train/eval_steps_per_second 55.096
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143756-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143844-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:38:53,460	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:38:53,462	ERROR client.py:240 -- Config: {}
2024-11-11 14:38:53,463	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:38:54,378	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 65.96it/s]
[92mINFO [0m:      fit progress: (7, 0.0, {}, 347.7645470001735)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▁▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▁▂▆▃▄▇█▄▂▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▁▁██▆▁▃▆▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.40736
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0216
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 92.692
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 46.346
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 700
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.40736
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0216
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 92.692
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 46.346
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 13.59605
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.9136
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.47609
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.1364
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.462
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.865
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143824-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143856-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 960.89it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.59it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:10,  9.50it/s]                                                 2%|▏         | 2/100 [00:00<00:10,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:10,  9.35it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.35it/s]                                                 4%|▍         | 4/100 [00:00<00:10,  9.35it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09, 10.49it/s]                                                 5%|▌         | 5/100 [00:00<00:09, 10.49it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:07, 12.40it/s]                                                 7%|▋         | 7/100 [00:00<00:07, 12.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:07, 12.40it/s]  9%|▉         | 9/100 [00:00<00:07, 12.47it/s]                                                 9%|▉         | 9/100 [00:00<00:07, 12.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:00<00:07, 12.47it/s] 11%|█         | 11/100 [00:00<00:06, 13.37it/s]                                                 11%|█         | 11/100 [00:00<00:06, 13.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:00<00:06, 13.37it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:06, 14.19it/s]                                                 13%|█▎        | 13/100 [00:01<00:06, 14.19it/s]                                                 14%|█▍        | 14/100 [00:01<00:06, 14.19it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:05, 14.86it/s]                                                 15%|█▌        | 15/100 [00:01<00:05, 14.86it/s]                                                 16%|█▌        | 16/100 [00:01<00:05, 14.86it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:05, 15.15it/s]                                                 17%|█▋        | 17/100 [00:01<00:05, 15.15it/s]                                                 18%|█▊        | 18/100 [00:01<00:05, 15.15it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:05, 15.61it/s]                                                 19%|█▉        | 19/100 [00:01<00:05, 15.61it/s]                                                 20%|██        | 20/100 [00:01<00:05, 15.61it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:01<00:04, 15.84it/s]                                                 21%|██        | 21/100 [00:01<00:04, 15.84it/s]                                                 22%|██▏       | 22/100 [00:01<00:04, 15.84it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:01<00:04, 16.04it/s]                                                 23%|██▎       | 23/100 [00:01<00:04, 16.04it/s]                                                 24%|██▍       | 24/100 [00:01<00:04, 16.04it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:01<00:04, 16.62it/s]                                                 25%|██▌       | 25/100 [00:01<00:04, 16.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:01<00:04, 16.62it/s] 27%|██▋       | 27/100 [00:01<00:04, 16.41it/s]                                                 27%|██▋       | 27/100 [00:01<00:04, 16.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:01<00:04, 16.41it/s] 29%|██▉       | 29/100 [00:01<00:04, 16.71it/s]                                                 29%|██▉       | 29/100 [00:01<00:04, 16.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:04, 16.71it/s] 31%|███       | 31/100 [00:02<00:04, 16.21it/s]                                                 31%|███       | 31/100 [00:02<00:04, 16.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:02<00:04, 16.21it/s] 33%|███▎      | 33/100 [00:02<00:04, 16.09it/s]                                                 33%|███▎      | 33/100 [00:02<00:04, 16.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:02<00:04, 16.09it/s] 35%|███▌      | 35/100 [00:02<00:03, 16.41it/s]                                                 35%|███▌      | 35/100 [00:02<00:03, 16.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:02<00:03, 16.41it/s] 37%|███▋      | 37/100 [00:02<00:03, 16.71it/s]                                                 37%|███▋      | 37/100 [00:02<00:03, 16.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:02<00:03, 16.71it/s] 39%|███▉      | 39/100 [00:02<00:03, 16.67it/s]                                                 39%|███▉      | 39/100 [00:02<00:03, 16.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:02<00:03, 16.67it/s] 41%|████      | 41/100 [00:02<00:03, 16.78it/s]                                                 41%|████      | 41/100 [00:02<00:03, 16.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:02<00:03, 16.78it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:02<00:03, 16.91it/s]                                                 43%|████▎     | 43/100 [00:02<00:03, 16.91it/s]                                                 44%|████▍     | 44/100 [00:02<00:03, 16.91it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:02<00:03, 16.79it/s]                                                 45%|████▌     | 45/100 [00:02<00:03, 16.79it/s]                                                 46%|████▌     | 46/100 [00:03<00:03, 16.79it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:03<00:03, 15.09it/s]                                                 47%|████▋     | 47/100 [00:03<00:03, 15.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:03<00:03, 15.09it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:03<00:03, 13.13it/s]                                                 49%|████▉     | 49/100 [00:03<00:03, 13.13it/s]                                                 50%|█████     | 50/100 [00:03<00:03, 13.13it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 784.42it/s][A 50%|█████     | 50/100 [00:03<00:03, 13.13it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:03<00:05,  9.00it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:03<00:05,  9.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:03<00:05,  9.00it/s] 53%|█████▎    | 53/100 [00:03<00:05,  9.39it/s]                                                 53%|█████▎    | 53/100 [00:03<00:05,  9.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:03<00:04,  9.39it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:04<00:04,  9.62it/s]                                                 55%|█████▌    | 55/100 [00:04<00:04,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:04<00:04,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:04<00:04,  9.66it/s]                                                 57%|█████▋    | 57/100 [00:04<00:04,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:04<00:04,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:04<00:04,  9.81it/s]                                                 59%|█████▉    | 59/100 [00:04<00:04,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:04<00:04,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:04<00:03,  9.79it/s]                                                 61%|██████    | 61/100 [00:04<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:04<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:04<00:03,  9.80it/s]                                                 63%|██████▎   | 63/100 [00:04<00:03,  9.80it/s]                                                 64%|██████▍   | 64/100 [00:04<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:05<00:03, 10.11it/s]                                                 65%|██████▌   | 65/100 [00:05<00:03, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:05<00:03, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:05<00:03,  9.97it/s]                                                 67%|██████▋   | 67/100 [00:05<00:03,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:05<00:03,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:05<00:03,  9.89it/s]                                                 69%|██████▉   | 69/100 [00:05<00:03,  9.89it/s]                                                 70%|███████   | 70/100 [00:05<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:05<00:02, 10.00it/s]                                                 71%|███████   | 71/100 [00:05<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:05<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:05<00:02,  9.88it/s]                                                 73%|███████▎  | 73/100 [00:05<00:02,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:06<00:02,  9.84it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:06<00:02,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:06<00:02,  9.88it/s]                                                 76%|███████▌  | 76/100 [00:06<00:02,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:06<00:02,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:06<00:02, 10.00it/s]                                                 78%|███████▊  | 78/100 [00:06<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:06<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:06<00:01, 10.15it/s]                                                 80%|████████  | 80/100 [00:06<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:06<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:06<00:01,  9.97it/s]                                                 82%|████████▏ | 82/100 [00:06<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:06<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:06<00:01, 10.21it/s]                                                 84%|████████▍ | 84/100 [00:06<00:01, 10.21it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01, 10.30it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:01, 10.16it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:07<00:01, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:07<00:00, 10.07it/s]                                                 90%|█████████ | 90/100 [00:07<00:00, 10.07it/s]                                                 91%|█████████ | 91/100 [00:07<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:07<00:00, 10.10it/s]                                                 92%|█████████▏| 92/100 [00:07<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:07<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:07<00:00, 10.13it/s]                                                 94%|█████████▍| 94/100 [00:07<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:08<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00, 10.19it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00, 10.24it/s]                                                 98%|█████████▊| 98/100 [00:08<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:08<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:08<00:00, 10.08it/s]                                                 100%|██████████| 100/100 [00:08<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 741.17it/s][A100%|██████████| 100/100 [00:08<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:08<00:00, 10.08it/s]100%|██████████| 100/100 [00:08<00:00, 11.38it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▁██
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▁██
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄█▅▂▁▂▂▄█▆▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▁▄▆▁▆▄█▃▃█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.84371
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0018
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0233
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 85.938
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 42.969
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 800
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.84371
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0018
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0233
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 85.938
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 42.969
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 26.69831
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.8938
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.86115
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 8.7861
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 45.526
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 11.382
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143856-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143913-uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 945.09it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:09,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:10,  9.60it/s]                                                 2%|▏         | 2/100 [00:00<00:10,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:10,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.17it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.10it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.10it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.48it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.76it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.76it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.78it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.63it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:07, 10.63it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:07, 10.57it/s]                                                 16%|█▌        | 16/100 [00:01<00:07, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.25it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.25it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.39it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.27it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.27it/s] 24%|██▍       | 24/100 [00:02<00:07, 10.12it/s]                                                
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.93it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.89it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07,  9.88it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.88it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.88it/s]                                                 30%|███       | 30/100 [00:02<00:07,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.15it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.01it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06,  9.96it/s]                                                 34%|███▍      | 34/100 [00:03<00:06,  9.96it/s] 35%|███▌      | 35/100 [00:03<00:06,  9.95it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.16it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.16it/s] 39%|███▉      | 39/100 [00:03<00:06, 10.13it/s]                                                 39%|███▉      | 39/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05, 10.13it/s]                                                 41%|████      | 41/100 [00:04<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.21it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.10it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.83it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05,  9.83it/s] 49%|████▉     | 49/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1292.54it/s][A 50%|█████     | 50/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.67it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.67it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.67it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.32it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.32it/s] 55%|█████▌    | 55/100 [00:05<00:04,  9.62it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  9.62it/s] 57%|█████▋    | 57/100 [00:05<00:04, 10.28it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04, 10.22it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:03, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03, 10.06it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03, 10.06it/s] 63%|██████▎   | 63/100 [00:06<00:03, 10.14it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.07it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.07it/s] 67%|██████▋   | 67/100 [00:06<00:03,  9.89it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03, 10.17it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:02, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.04it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.14it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.01it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.81it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.81it/s] 78%|███████▊  | 78/100 [00:07<00:02,  9.77it/s]                                                
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02,  9.65it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:02,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01,  9.71it/s]                                                 81%|████████  | 81/100 [00:08<00:01,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.77it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.82it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.75it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.66it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.66it/s] 88%|████████▊ | 88/100 [00:08<00:01,  9.70it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:00, 10.19it/s]                                                 90%|█████████ | 90/100 [00:09<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:09<00:00, 10.19it/s] 92%|█████████▏| 92/100 [00:09<00:00, 10.04it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.04it/s] 94%|█████████▍| 94/100 [00:09<00:00, 11.25it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 11.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 11.25it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 11.89it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 11.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 11.89it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 11.54it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 11.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 11.54it/s]100%|██████████| 100/100 [00:09<00:00, 11.17it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 11.17it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 740.91it/s][A100%|██████████| 100/100 [00:09<00:00, 11.17it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 11.17it/s]100%|██████████| 100/100 [00:10<00:00,  9.85it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.062 MB of 0.062 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.71616
wandb:  eval/eval_model_preparation_time 0.0017
wandb:                 eval/eval_runtime 0.0994
wandb:      eval/eval_samples_per_second 201.231
wandb:        eval/eval_steps_per_second 50.308
wandb:                              iter 700
wandb:                   train/eval_loss 1.71616
wandb: train/eval_model_preparation_time 0.0017
wandb:                train/eval_runtime 0.0994
wandb:     train/eval_samples_per_second 201.231
wandb:       train/eval_steps_per_second 50.308
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143844-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143932-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:39:39,576	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:39:39,577	ERROR client.py:240 -- Config: {}
2024-11-11 14:39:39,579	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:39:40,433	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 69.37it/s]
[92mINFO [0m:      fit progress: (8, 0.0, {}, 393.84614828787744)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▄█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▄█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄█▁▄▅▂▅▃▅▃▄
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▁▃▁▁█▆██▃▄
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.6587
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.002
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0205
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 97.336
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 48.668
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 800
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.6587
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.002
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0205
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 97.336
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 48.668
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 32.28878
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.335
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8263532150784.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.6004
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.1481
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.416
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.854
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_7 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143913-uijo9p43_client_7/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_143942-uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.75it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.18it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.18it/s]  4%|▍         | 4/100 [00:00<00:09,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:09,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.33it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.22it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.45it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.45it/s] 12%|█▏        | 12/100 [00:01<00:08, 10.28it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.38it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.14it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.14it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.05it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.03it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07,  9.94it/s]                                                 22%|██▏       | 22/100 [00:02<00:07,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.01it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.14it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.14it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.24it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.16it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.00it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06,  9.95it/s]                                                 34%|███▍      | 34/100 [00:03<00:06,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.91it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.92it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.92it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.92it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06, 10.09it/s]                                                 39%|███▉      | 39/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:06,  9.80it/s]                                                 41%|████      | 41/100 [00:04<00:06,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05,  9.90it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.91it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05,  9.89it/s]                                                 45%|████▌     | 45/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.61it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.67it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.67it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.83it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:05,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 763.71it/s][A 50%|█████     | 50/100 [00:05<00:05,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.35it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.35it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.76it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:06,  7.76it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.45it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.45it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.72it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.72it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.98it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  8.98it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.51it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:06<00:04,  9.49it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.49it/s] 61%|██████    | 61/100 [00:06<00:04,  9.66it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.96it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.08it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03, 10.01it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:07<00:03, 10.02it/s]                                                 69%|██████▉   | 69/100 [00:07<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:02, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.88it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.88it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.15it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.06it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.06it/s] 77%|███████▋  | 77/100 [00:07<00:02,  9.93it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:08<00:02,  9.93it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.03it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.27it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.38it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.21it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:09<00:01, 10.30it/s]                                                 89%|████████▉ | 89/100 [00:09<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:09<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00, 10.20it/s]                                                 91%|█████████ | 91/100 [00:09<00:00, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 10.20it/s] 93%|█████████▎| 93/100 [00:09<00:00, 10.09it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.09it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.93it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.88it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:10<00:00,  9.86it/s]                                                
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:10<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:10<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 761.35it/s][A100%|██████████| 100/100 [00:10<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.86it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.005 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.005 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second █▁▄
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second █▁▄
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▁▂
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second █▁▄
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second █▁▄
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▁▁▂▂█▂▆▇▆▅
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂▇▂▇▃▇▁▃▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.83233
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0015
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0208
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 96.202
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 48.101
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 900
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.83233
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0015
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0208
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 96.202
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 48.101
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 48.72578
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.8804
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8312527552512.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.76341
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.3437
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.671
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.668
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_0 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_143942-uijo9p43_client_0/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: | Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144002-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1026.00it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:10,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.11it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.45it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.10it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.96it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.96it/s] 10%|█         | 10/100 [00:00<00:08, 10.14it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.86it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.88it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.90it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.89it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.85it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.78it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08,  9.71it/s]                                                 19%|█▉        | 19/100 [00:01<00:08,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:02<00:08,  9.75it/s]                                                 20%|██        | 20/100 [00:02<00:08,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:08,  9.71it/s]                                                 21%|██        | 21/100 [00:02<00:08,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:08,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07,  9.94it/s]                                                 23%|██▎       | 23/100 [00:02<00:07,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07,  9.92it/s]                                                 25%|██▌       | 25/100 [00:02<00:07,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.81it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:06, 10.75it/s]                                                 28%|██▊       | 28/100 [00:02<00:06, 10.75it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.68it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.66it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.66it/s] 34%|███▍      | 34/100 [00:03<00:06, 10.39it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.13it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:05, 10.38it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:05, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.13it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.99it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.99it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.12it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.98it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.92it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05,  9.88it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.88it/s] 49%|████▉     | 49/100 [00:04<00:05,  9.87it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:05,  9.89it/s]                                                 50%|█████     | 50/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 179.12it/s][A
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:05<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:07,  6.52it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:07,  6.52it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.17it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.17it/s] 53%|█████▎    | 53/100 [00:05<00:06,  7.78it/s]                                                 53%|█████▎    | 53/100 [00:05<00:06,  7.78it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.24it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.24it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.65it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.65it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.83it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.83it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.28it/s]                                                 58%|█████▊    | 58/100 [00:06<00:04,  9.28it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.42it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.66it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03,  9.72it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.74it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.72it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.72it/s] 65%|██████▌   | 65/100 [00:06<00:03,  9.77it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.80it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:07<00:03,  9.95it/s]                                                 68%|██████▊   | 68/100 [00:07<00:03,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:07<00:03,  9.79it/s]                                                 69%|██████▉   | 69/100 [00:07<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.00it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.00it/s] 73%|███████▎  | 73/100 [00:07<00:02, 10.90it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.90it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.99it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.99it/s] 77%|███████▋  | 77/100 [00:07<00:02, 10.78it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:08<00:02, 10.39it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:01, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.22it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.12it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.01it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.97it/s]                                                
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:09<00:01, 10.06it/s]                                                 89%|████████▉ | 89/100 [00:09<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:09<00:00, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.83it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00,  9.76it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00, 10.01it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 10.01it/s] 96%|█████████▌| 96/100 [00:09<00:00, 10.22it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.22it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:10<00:00, 10.22it/s]100%|██████████| 100/100 [00:10<00:00, 10.20it/s]                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 789.14it/s][A100%|██████████| 100/100 [00:10<00:00, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.20it/s]100%|██████████| 100/100 [00:10<00:00,  9.66it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.004 MB uploadedwandb: | 0.000 MB of 0.004 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.70654
wandb:  eval/eval_model_preparation_time 0.0013
wandb:                 eval/eval_runtime 0.0967
wandb:      eval/eval_samples_per_second 206.855
wandb:        eval/eval_steps_per_second 51.714
wandb:                              iter 800
wandb:                   train/eval_loss 1.70654
wandb: train/eval_model_preparation_time 0.0013
wandb:                train/eval_runtime 0.0967
wandb:     train/eval_samples_per_second 206.855
wandb:       train/eval_steps_per_second 51.714
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_143932-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144022-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:40:30,418	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:40:30,419	ERROR client.py:240 -- Config: {}
2024-11-11 14:40:30,420	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:40:31,343	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 69.39it/s]
[92mINFO [0m:      fit progress: (9, 0.0, {}, 444.77966850809753)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.018 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.018 MB of 0.018 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▂▁▅█▇▂▅▆▇▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▁▁█▇▆▁▄▆▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.34437
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0219
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 91.199
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 45.6
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 900
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.34437
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0219
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 91.199
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 45.6
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 25.19777
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7408
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.35002
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.3507
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.645
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.661
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144002-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144033-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.48it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:06, 15.53it/s]  2%|▏         | 2/100 [00:00<00:06, 15.59it/s]                                                 2%|▏         | 2/100 [00:00<00:06, 15.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:06, 15.59it/s]  4%|▍         | 4/100 [00:00<00:06, 15.59it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 15.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:06, 15.59it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:07, 13.07it/s]                                                 6%|▌         | 6/100 [00:00<00:07, 13.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:07, 13.07it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:07, 11.85it/s]                                                 8%|▊         | 8/100 [00:00<00:07, 11.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:07, 11.85it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:07, 11.70it/s]                                                 10%|█         | 10/100 [00:00<00:07, 11.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:00<00:07, 11.70it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:07, 11.19it/s]                                                 12%|█▏        | 12/100 [00:01<00:07, 11.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:07, 11.19it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.69it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:07, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:07, 10.61it/s]                                                 16%|█▌        | 16/100 [00:01<00:07, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 10.61it/s] 18%|█▊        | 18/100 [00:01<00:07, 10.43it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.27it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.03it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.03it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.86it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.02it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07,  9.85it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.86it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.86it/s]                                                 30%|███       | 30/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:02<00:06,  9.88it/s]                                                 31%|███       | 31/100 [00:02<00:06,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.06it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.97it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.85it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.81it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.78it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.76it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.76it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 10.09it/s]                                                 41%|████      | 41/100 [00:03<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.03it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.94it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.94it/s] 45%|████▌     | 45/100 [00:04<00:05,  9.94it/s]                                                 45%|████▌     | 45/100 [00:04<00:05,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.87it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.87it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05,  9.73it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 793.02it/s][A 50%|█████     | 50/100 [00:04<00:05,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:07,  6.86it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:07,  6.86it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.27it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.27it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:06,  7.73it/s]                                                 53%|█████▎    | 53/100 [00:05<00:06,  7.73it/s] 54%|█████▍    | 54/100 [00:05<00:05,  8.19it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.19it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.06it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  9.06it/s] 58%|█████▊    | 58/100 [00:05<00:04,  9.52it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.52it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.57it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.67it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.68it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03,  9.68it/s] 63%|██████▎   | 63/100 [00:06<00:03,  9.95it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.73it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.77it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.77it/s] 68%|██████▊   | 68/100 [00:06<00:03, 10.12it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:07<00:03,  9.96it/s]                                                 70%|███████   | 70/100 [00:07<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.96it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.94it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.94it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.87it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.68it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.69it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.69it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.03it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:08<00:02,  9.97it/s]                                                 80%|████████  | 80/100 [00:08<00:02,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:08<00:01,  9.97it/s] 82%|████████▏ | 82/100 [00:08<00:01, 10.02it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.87it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.80it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.82it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.70it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.13it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:09<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00, 10.24it/s]                                                 91%|█████████ | 91/100 [00:09<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00, 10.38it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 10.38it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.57it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.18it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.18it/s] 99%|█████████▉| 99/100 [00:09<00:00, 10.03it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:10<00:00, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 758.88it/s][A100%|██████████| 100/100 [00:10<00:00, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.03it/s]100%|██████████| 100/100 [00:10<00:00,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploadedwandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▆
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▆
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▄█▄▃▅▇▃▇▁▆
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▂▆█▂▄▅▃▁▁▅
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.34318
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0238
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 83.991
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 41.996
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1000
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.34318
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0238
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 83.991
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 41.996
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 38.87296
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.5328
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.36381
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.2527
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.014
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.754
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144033-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144053-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 929.18it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:06, 14.58it/s]  2%|▏         | 2/100 [00:00<00:06, 15.70it/s]                                                 2%|▏         | 2/100 [00:00<00:06, 15.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:06, 15.70it/s]  4%|▍         | 4/100 [00:00<00:06, 15.45it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 15.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:06, 15.45it/s]  6%|▌         | 6/100 [00:00<00:05, 15.90it/s]                                                 6%|▌         | 6/100 [00:00<00:05, 15.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:05, 15.90it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:07, 12.47it/s]                                                 8%|▊         | 8/100 [00:00<00:07, 12.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:07, 12.47it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:07, 11.80it/s]                                                 10%|█         | 10/100 [00:00<00:07, 11.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:00<00:07, 11.80it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:00<00:07, 11.18it/s]                                                 12%|█▏        | 12/100 [00:00<00:07, 11.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:07, 11.18it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.70it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:07, 10.70it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.44it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 10.44it/s] 18%|█▊        | 18/100 [00:01<00:08, 10.24it/s]                                                
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.19it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:07, 10.10it/s]                                                 22%|██▏       | 22/100 [00:01<00:07, 10.10it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.11it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.04it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.02it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.47it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:06, 11.24it/s]                                                 32%|███▏      | 32/100 [00:02<00:06, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:05, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:05, 11.05it/s]                                                 34%|███▍      | 34/100 [00:03<00:05, 11.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:05, 11.05it/s] 36%|███▌      | 36/100 [00:03<00:05, 11.46it/s]                                                 36%|███▌      | 36/100 [00:03<00:05, 11.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:05, 11.46it/s] 38%|███▊      | 38/100 [00:03<00:05, 12.28it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 12.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:04, 12.28it/s] 40%|████      | 40/100 [00:03<00:04, 13.18it/s]                                                 40%|████      | 40/100 [00:03<00:04, 13.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:04, 13.18it/s] 42%|████▏     | 42/100 [00:03<00:04, 13.89it/s]                                                 42%|████▏     | 42/100 [00:03<00:04, 13.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:04, 13.89it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:04, 13.34it/s]                                                 44%|████▍     | 44/100 [00:03<00:04, 13.34it/s]                                                 45%|████▌     | 45/100 [00:03<00:04, 13.34it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:04, 12.60it/s]                                                 46%|████▌     | 46/100 [00:03<00:04, 12.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:04, 12.60it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:04, 11.57it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 11.57it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 11.57it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 11.03it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 11.03it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 796.03it/s][A 50%|█████     | 50/100 [00:04<00:04, 11.03it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 11.03it/s] 52%|█████▏    | 52/100 [00:04<00:05,  8.23it/s]                                                 52%|█████▏    | 52/100 [00:04<00:05,  8.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:04<00:05,  8.23it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:05,  8.88it/s]                                                 54%|█████▍    | 54/100 [00:04<00:05,  8.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.88it/s] 56%|█████▌    | 56/100 [00:05<00:04,  9.17it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.17it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.26it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.26it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.51it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:04,  9.73it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03,  9.84it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03,  9.84it/s]                                                 64%|██████▍   | 64/100 [00:05<00:03,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.64it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.64it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:02, 12.04it/s]                                                 67%|██████▋   | 67/100 [00:06<00:02, 12.04it/s]                                                
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:02, 12.04it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:02, 11.73it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:02, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02, 11.14it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 11.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02, 11.14it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 10.67it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:06<00:02, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02, 10.25it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.33it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.33it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.36it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 10.20it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01, 10.15it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01, 10.16it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.08it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.20it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.11it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.11it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00, 10.23it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:08<00:00, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:08<00:00, 10.07it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:08<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.01it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.98it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 804.89it/s][A100%|██████████| 100/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.98it/s]100%|██████████| 100/100 [00:09<00:00, 10.39it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.63199
wandb:  eval/eval_model_preparation_time 0.0025
wandb:                 eval/eval_runtime 0.0999
wandb:      eval/eval_samples_per_second 200.1
wandb:        eval/eval_steps_per_second 50.025
wandb:                              iter 900
wandb:                   train/eval_loss 1.63199
wandb: train/eval_model_preparation_time 0.0025
wandb:                train/eval_runtime 0.0999
wandb:     train/eval_samples_per_second 200.1
wandb:       train/eval_steps_per_second 50.025
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144022-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144111-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:41:18,453	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:41:18,454	ERROR client.py:240 -- Config: {}
2024-11-11 14:41:18,455	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:41:19,447	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 76.30it/s]
[92mINFO [0m:      fit progress: (10, 0.0, {}, 492.81957112113014)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.016 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.016 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▂█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▂█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▂█▁▁▂▁▅▁▄▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▁▄▇▁▆▄█▄▂█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.15984
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0231
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 86.552
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 43.276
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1000
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.15984
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0231
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 86.552
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 43.276
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 31.78556
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.6045
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.64678
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.6208
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.577
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.394
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144053-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144121-uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.45it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:09,  9.98it/s]                                                 1%|          | 1/100 [00:00<00:09,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.89it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09,  9.89it/s]  4%|▍         | 4/100 [00:00<00:09, 10.61it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:08, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.16it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.16it/s]  8%|▊         | 8/100 [00:00<00:09,  9.99it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:09,  9.93it/s]                                                 10%|█         | 10/100 [00:00<00:09,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.73it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:09,  9.78it/s]                                                 12%|█▏        | 12/100 [00:01<00:09,  9.78it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.84it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.04it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.92it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.92it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08, 10.00it/s]                                                 19%|█▉        | 19/100 [00:01<00:08, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:02<00:08,  9.91it/s]                                                 20%|██        | 20/100 [00:02<00:08,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:08,  9.86it/s]                                                 21%|██        | 21/100 [00:02<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.50it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.40it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.31it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:06, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:06, 10.38it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.61it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.13it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.13it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.16it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.28it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.28it/s] 39%|███▉      | 39/100 [00:03<00:05, 10.26it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05, 10.18it/s]                                                 41%|████      | 41/100 [00:04<00:05, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05, 10.18it/s] 43%|████▎     | 43/100 [00:04<00:05,  9.94it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.92it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05,  9.92it/s]                                                 45%|████▌     | 45/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.89it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.12it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.02it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 763.02it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.82it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.82it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.08it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.08it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.30it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.30it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.58it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.58it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  8.89it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.38it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:06<00:04,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.54it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.41it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.41it/s] 62%|██████▏   | 62/100 [00:06<00:04,  9.47it/s]                                                 62%|██████▏   | 62/100 [00:06<00:04,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.42it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.45it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.41it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.41it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.55it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.55it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.67it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.65it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:07<00:03,  9.73it/s]                                                 69%|██████▉   | 69/100 [00:07<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.83it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.71it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.74it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.64it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.59it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.69it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:08<00:02,  9.64it/s]                                                 78%|███████▊  | 78/100 [00:08<00:02,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:08<00:02,  9.56it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:02,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01,  9.64it/s]                                                 81%|████████  | 81/100 [00:08<00:01,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.17it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.97it/s]                                                
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.06it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:09<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:09<00:01,  9.92it/s]                                                 89%|████████▉ | 89/100 [00:09<00:01,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:09<00:01,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.81it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.81it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.97it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.94it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00,  9.94it/s] 96%|█████████▌| 96/100 [00:09<00:00, 10.10it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:10<00:00, 10.08it/s]                                                 98%|█████████▊| 98/100 [00:10<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:10<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00,  9.98it/s]                                                 100%|██████████| 100/100 [00:10<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 771.15it/s][A100%|██████████| 100/100 [00:10<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.98it/s]100%|██████████| 100/100 [00:10<00:00,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.015 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.015 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▄▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▄▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁█▁▁▁▁▁▂▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▄▃▃▄▁▁█▁▆▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.72911
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0022
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0225
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 88.831
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 44.416
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1100
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.72911
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0022
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0225
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 88.831
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 44.416
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 28.61894
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.5361
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8422363398144.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.47304
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.4096
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.426
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.607
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_1 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144121-uijo9p43_client_1/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144140-uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 901.26 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 88.12 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 953.03it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:08, 12.11it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.51it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.03it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:08, 10.59it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 10.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:08, 10.59it/s]  8%|▊         | 8/100 [00:00<00:08, 10.48it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.56it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.56it/s] 12%|█▏        | 12/100 [00:01<00:08, 10.55it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.55it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.55it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.57it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.28it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.24it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.18it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.18it/s]                                                
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.11it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.98it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.92it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.10it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.00it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.17it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.37it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.44it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.44it/s] 38%|███▊      | 38/100 [00:03<00:05, 10.37it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:05, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.21it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:05, 10.21it/s] 42%|████▏     | 42/100 [00:04<00:05, 10.86it/s]                                                 42%|████▏     | 42/100 [00:04<00:05, 10.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05, 10.86it/s] 44%|████▍     | 44/100 [00:04<00:04, 11.99it/s]                                                 44%|████▍     | 44/100 [00:04<00:04, 11.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:04, 11.99it/s] 46%|████▌     | 46/100 [00:04<00:04, 12.85it/s]                                                 46%|████▌     | 46/100 [00:04<00:04, 12.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:04, 12.85it/s] 48%|████▊     | 48/100 [00:04<00:03, 13.88it/s]                                                 48%|████▊     | 48/100 [00:04<00:03, 13.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:03, 13.88it/s] 50%|█████     | 50/100 [00:04<00:03, 14.68it/s]                                                 50%|█████     | 50/100 [00:04<00:03, 14.68it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 734.43it/s][A 50%|█████     | 50/100 [00:04<00:03, 14.68it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:03, 14.68it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:05,  9.32it/s]                                                 52%|█████▏    | 52/100 [00:04<00:05,  9.32it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  9.32it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:04,  9.68it/s]                                                 54%|█████▍    | 54/100 [00:05<00:04,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:04,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.83it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.92it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.88it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:05<00:03,  9.68it/s]                                                 62%|██████▏   | 62/100 [00:05<00:03,  9.68it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.57it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.52it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.52it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.45it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.51it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03,  9.96it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02, 10.28it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 10.28it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.23it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.03it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.86it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.77it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:02,  9.90it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.87it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01,  9.65it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.58it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.58it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.64it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.55it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.55it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.55it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.76it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:01,  9.79it/s]                                                 90%|█████████ | 90/100 [00:08<00:01,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.66it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00,  9.66it/s] 93%|█████████▎| 93/100 [00:09<00:00, 10.02it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.54it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.49it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00, 10.25it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 782.67it/s][A100%|██████████| 100/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.25it/s]100%|██████████| 100/100 [00:10<00:00,  9.98it/s]
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.63708
wandb:  eval/eval_model_preparation_time 0.0012
wandb:                 eval/eval_runtime 0.0897
wandb:      eval/eval_samples_per_second 223.081
wandb:        eval/eval_steps_per_second 55.77
wandb:                              iter 1000
wandb:                   train/eval_loss 1.63708
wandb: train/eval_model_preparation_time 0.0012
wandb:                train/eval_runtime 0.0897
wandb:     train/eval_samples_per_second 223.081
wandb:       train/eval_steps_per_second 55.77
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144111-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144159-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:42:06,468	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:42:06,469	ERROR client.py:240 -- Config: {}
2024-11-11 14:42:06,470	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:42:07,524	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 76.38it/s]
[92mINFO [0m:      fit progress: (11, 0.0, {}, 540.8948490871117)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.011 MB uploadedwandb: | 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▅
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▅
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▃
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃█▄▂▂▁▂▁▂▂▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▇▁▆█▃▁▅▅█▆▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.91823
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0014
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0224
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 89.245
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 44.623
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1100
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.91823
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0014
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0224
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 89.245
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 44.623
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 19.34956
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.8478
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8549966807040.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.64711
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.0143
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.943
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.986
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_5 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144140-uijo9p43_client_5/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144209-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.58it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.50it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.50it/s]                                                 3%|▎         | 3/100 [00:00<00:09, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.45it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.09it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.09it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09, 10.10it/s]                                                 8%|▊         | 8/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:09,  9.97it/s]                                                 10%|█         | 10/100 [00:00<00:09,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08,  9.94it/s]                                                 11%|█         | 11/100 [00:01<00:08,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.95it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.94it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.89it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.84it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.84it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.08it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.17it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.28it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.28it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.34it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.16it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.16it/s] 28%|██▊       | 28/100 [00:02<00:07, 10.07it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.09it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.10it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.08it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.15it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.21it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:05, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.26it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05, 10.17it/s]                                                 42%|████▏     | 42/100 [00:04<00:05, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.21it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.21it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05, 10.11it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.04it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.04it/s] 50%|█████     | 50/100 [00:04<00:04, 10.38it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1036.14it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.91it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:05,  7.91it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.50it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.50it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.64it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.64it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.81it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  8.81it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.56it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:06<00:04,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.77it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.77it/s]                                                 61%|██████    | 61/100 [00:06<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03, 10.63it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 10.63it/s]                                                
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03, 10.63it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03, 11.86it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 11.86it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 11.86it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:02, 12.51it/s]                                                 66%|██████▌   | 66/100 [00:06<00:02, 12.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:02, 12.51it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:02, 12.50it/s]                                                 68%|██████▊   | 68/100 [00:06<00:02, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:02, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 12.23it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 12.23it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 12.23it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 11.57it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 11.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 11.57it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 11.18it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 11.18it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 11.18it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.93it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.93it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.61it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:01, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 10.41it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.41it/s] 82%|████████▏ | 82/100 [00:08<00:01, 10.33it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 10.24it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.46it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.46it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.25it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.18it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.20it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00, 10.30it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.30it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 10.14it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.35it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.35it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 10.30it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 777.15it/s][A100%|██████████| 100/100 [00:09<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.30it/s]100%|██████████| 100/100 [00:10<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▁▁▂▁▁▂▁█▂▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▂▆█▂▅▅▂▁▁▄
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.34695
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0265
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 75.576
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 37.788
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1200
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.34695
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0265
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 75.576
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 37.788
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 88.70609
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.2491
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.25184
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.0228
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.909
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.977
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144209-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144229-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 922.43it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.26it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.26it/s]                                                 3%|▎         | 3/100 [00:00<00:09, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.82it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.93it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.97it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.90it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:09,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.80it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.80it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.90it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.84it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.89it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.89it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.95it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08,  9.91it/s]                                                 19%|█▉        | 19/100 [00:01<00:08,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:08,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07,  9.87it/s]                                                 23%|██▎       | 23/100 [00:02<00:07,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.81it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07,  9.81it/s]                                                 25%|██▌       | 25/100 [00:02<00:07,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.67it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.67it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:06, 10.94it/s]                                                 28%|██▊       | 28/100 [00:02<00:06, 10.94it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.94it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:05, 12.30it/s]                                                 30%|███       | 30/100 [00:02<00:05, 12.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:05, 12.30it/s] 32%|███▏      | 32/100 [00:03<00:05, 11.37it/s]                                                 32%|███▏      | 32/100 [00:03<00:05, 11.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:05, 11.37it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.92it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:05, 10.92it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.49it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.27it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:05, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.05it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.05it/s] 42%|████▏     | 42/100 [00:04<00:05, 10.14it/s]                                                 42%|████▏     | 42/100 [00:04<00:05, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.18it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.18it/s] 46%|████▌     | 46/100 [00:04<00:05, 10.11it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.08it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.08it/s] 50%|█████     | 50/100 [00:04<00:04, 10.46it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 739.74it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.88it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.88it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  7.88it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.43it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.43it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.66it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.66it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.08it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.08it/s] 58%|█████▊    | 58/100 [00:05<00:04,  9.18it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.18it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:06<00:04,  9.20it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04,  9.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.20it/s] 61%|██████    | 61/100 [00:06<00:03, 10.85it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 10.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03, 10.85it/s] 63%|██████▎   | 63/100 [00:06<00:03, 12.32it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03, 12.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:02, 12.32it/s] 65%|██████▌   | 65/100 [00:06<00:02, 13.66it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 13.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:02, 13.66it/s] 67%|██████▋   | 67/100 [00:06<00:02, 13.85it/s]                                                 67%|██████▋   | 67/100 [00:06<00:02, 13.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:02, 13.85it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:02, 12.30it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 12.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:02, 12.30it/s] 71%|███████   | 71/100 [00:06<00:02, 11.41it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 11.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 11.41it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.75it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.71it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.69it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 10.31it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.04it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.76it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.76it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 12.13it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 12.13it/s]                                                 88%|████████▊ | 88/100 [00:08<00:00, 12.13it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:00, 12.02it/s]                                                 89%|████████▉ | 89/100 [00:08<00:00, 12.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 12.02it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 11.49it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 11.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 11.49it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00, 10.82it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00, 10.82it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.50it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.41it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.41it/s] 99%|█████████▉| 99/100 [00:09<00:00, 10.22it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 766.64it/s][A100%|██████████| 100/100 [00:09<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.22it/s]100%|██████████| 100/100 [00:09<00:00, 10.07it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.063 MB of 0.063 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb: - 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.62864
wandb:  eval/eval_model_preparation_time 0.0008
wandb:                 eval/eval_runtime 0.0855
wandb:      eval/eval_samples_per_second 233.851
wandb:        eval/eval_steps_per_second 58.463
wandb:                              iter 1100
wandb:                   train/eval_loss 1.62864
wandb: train/eval_model_preparation_time 0.0008
wandb:                train/eval_runtime 0.0855
wandb:     train/eval_samples_per_second 233.851
wandb:       train/eval_steps_per_second 58.463
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144159-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144248-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:42:59,176	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:42:59,176	ERROR client.py:240 -- Config: {}
2024-11-11 14:42:59,177	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:43:00,023	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 56.77it/s]
[92mINFO [0m:      fit progress: (12, 0.0, {}, 593.4678281550296)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▁██
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▁██
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃█▄▂▁▅▂█▂▅▄
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▁▂▅▁▆▃█▃▂▆
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.12131
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0251
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 79.681
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 39.841
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1200
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.12131
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0251
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 79.681
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 39.841
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 51.07065
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.1536
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.51537
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.9249
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 40.303
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.076
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144229-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144302-uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1258.79it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:07, 13.56it/s]  2%|▏         | 2/100 [00:00<00:06, 14.33it/s]                                                 2%|▏         | 2/100 [00:00<00:06, 14.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:06, 14.33it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:06, 14.72it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 14.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:06, 14.72it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:06, 15.27it/s]                                                 6%|▌         | 6/100 [00:00<00:06, 15.27it/s]                                                 7%|▋         | 7/100 [00:00<00:06, 15.27it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:05, 15.80it/s]                                                 8%|▊         | 8/100 [00:00<00:05, 15.80it/s]                                                 9%|▉         | 9/100 [00:00<00:05, 15.80it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:05, 16.26it/s]                                                 10%|█         | 10/100 [00:00<00:05, 16.26it/s]                                                 11%|█         | 11/100 [00:00<00:05, 16.26it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:00<00:05, 15.08it/s]                                                 12%|█▏        | 12/100 [00:00<00:05, 15.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:00<00:05, 15.08it/s] 14%|█▍        | 14/100 [00:00<00:06, 13.20it/s]                                                 14%|█▍        | 14/100 [00:00<00:06, 13.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:06, 13.20it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:06, 12.29it/s]                                                 16%|█▌        | 16/100 [00:01<00:06, 12.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:06, 12.29it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 11.24it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 11.24it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.82it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:07, 10.43it/s]                                                 22%|██▏       | 22/100 [00:01<00:07, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:01<00:07, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:01<00:07, 10.15it/s]                                                 24%|██▍       | 24/100 [00:01<00:07, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.15it/s] 26%|██▌       | 26/100 [00:02<00:07, 10.07it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07,  9.85it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.81it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:07,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:02<00:06,  9.90it/s]                                                 31%|███       | 31/100 [00:02<00:06,  9.90it/s]                                                 32%|███▏      | 32/100 [00:02<00:06,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:02<00:06, 10.83it/s]                                                 33%|███▎      | 33/100 [00:02<00:06, 10.83it/s]                                                 34%|███▍      | 34/100 [00:02<00:06, 10.83it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:02<00:05, 12.17it/s]                                                 35%|███▌      | 35/100 [00:02<00:05, 12.17it/s]                                                 36%|███▌      | 36/100 [00:03<00:05, 12.17it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:04, 13.27it/s]                                                 37%|███▋      | 37/100 [00:03<00:04, 13.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:04, 13.27it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:05, 12.11it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 12.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:04, 12.11it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 11.42it/s]                                                 41%|████      | 41/100 [00:03<00:05, 11.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:05, 11.42it/s] 43%|████▎     | 43/100 [00:03<00:05, 10.96it/s]                                                
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:05, 10.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:03<00:05, 10.96it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:03<00:05, 10.26it/s]                                                 45%|████▌     | 45/100 [00:03<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:03<00:05, 10.26it/s] 47%|████▋     | 47/100 [00:04<00:04, 11.23it/s]                                                 47%|████▋     | 47/100 [00:04<00:04, 11.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:04, 11.23it/s] 49%|████▉     | 49/100 [00:04<00:04, 12.40it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 12.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 12.40it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1205.61it/s][A 50%|█████     | 50/100 [00:04<00:04, 12.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:05,  9.63it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:05,  9.63it/s]                                                 52%|█████▏    | 52/100 [00:04<00:04,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:04,  9.59it/s]                                                 53%|█████▎    | 53/100 [00:04<00:04,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:04<00:04,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:04<00:04,  9.76it/s]                                                 55%|█████▌    | 55/100 [00:04<00:04,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:04<00:04,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.83it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.93it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:04,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03, 10.15it/s]                                                 61%|██████    | 61/100 [00:05<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03,  9.97it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:05<00:03,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:05<00:03,  9.93it/s]                                                 65%|██████▌   | 65/100 [00:05<00:03,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:05<00:03,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.99it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03,  9.95it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:03,  9.95it/s] 71%|███████   | 71/100 [00:06<00:02,  9.92it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02,  9.95it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:06<00:02,  9.94it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02,  9.91it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.86it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.86it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.99it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02,  9.83it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:02,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.99it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.99it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01, 10.17it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01,  9.84it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.73it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.79it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.83it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:01,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.92it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00,  9.86it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00,  9.82it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00,  9.73it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:08<00:00,  9.62it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.69it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.67it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.53it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00,  9.53it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00,  9.77it/s]                                                 100%|██████████| 100/100 [00:09<00:00,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 819.04it/s][A100%|██████████| 100/100 [00:09<00:00,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.77it/s]100%|██████████| 100/100 [00:09<00:00, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▂▂▁▂█▃▃▁▂▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▄▃▃▃▁▁█▁▇▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.85401
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.024
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 83.451
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 41.726
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1300
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.85401
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.024
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 83.451
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 41.726
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 28.50754
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.5089
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8422363398144.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.37947
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.6879
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.289
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.322
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_1 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_1
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144302-uijo9p43_client_1/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144319-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.05it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.90it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.85it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:10,  9.36it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:10,  9.36it/s]  5%|▌         | 5/100 [00:00<00:09, 10.18it/s]                                                 5%|▌         | 5/100 [00:00<00:09, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09, 10.24it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.83it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.86it/s]                                                 10%|█         | 10/100 [00:01<00:09,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.83it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:09,  9.60it/s]                                                 12%|█▏        | 12/100 [00:01<00:09,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:09,  9.56it/s]                                                 13%|█▎        | 13/100 [00:01<00:09,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08,  9.56it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.96it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08, 10.26it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:07, 10.26it/s] 19%|█▉        | 19/100 [00:01<00:07, 10.39it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.30it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.29it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.29it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.64it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:06, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.40it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:06, 10.40it/s] 29%|██▉       | 29/100 [00:02<00:06, 10.25it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.13it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.14it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.99it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.01it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.95it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:06,  9.95it/s] 41%|████      | 41/100 [00:04<00:05,  9.99it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.09it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.08it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:04, 10.78it/s]                                                 47%|████▋     | 47/100 [00:04<00:04, 10.78it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:04, 11.79it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 11.79it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 11.79it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 776.58it/s][A 50%|█████     | 50/100 [00:04<00:04, 11.79it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:05,  9.05it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:05,  9.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:05,  9.05it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:04,  9.42it/s]                                                 53%|█████▎    | 53/100 [00:05<00:04,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:04,  9.42it/s] 55%|█████▌    | 55/100 [00:05<00:04,  9.96it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.81it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.78it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.78it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03, 10.00it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.89it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03,  9.89it/s] 65%|██████▌   | 65/100 [00:06<00:03,  9.85it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.82it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03,  9.87it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.82it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:07<00:02,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 10.01it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.97it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.96it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.03it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.05it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.05it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.08it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.13it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.13it/s] 85%|████████▌ | 85/100 [00:08<00:01, 10.08it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.99it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01,  9.99it/s] 89%|████████▉ | 89/100 [00:08<00:01, 10.12it/s]                                                
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00, 10.25it/s]                                                 91%|█████████ | 91/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 10.25it/s] 93%|█████████▎| 93/100 [00:09<00:00, 10.09it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.14it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.14it/s] 97%|█████████▋| 97/100 [00:09<00:00, 10.11it/s]                                                
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00, 10.15it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 755.59it/s][A100%|██████████| 100/100 [00:09<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.15it/s]100%|██████████| 100/100 [00:10<00:00,  9.85it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.6329
wandb:  eval/eval_model_preparation_time 0.0015
wandb:                 eval/eval_runtime 0.1116
wandb:      eval/eval_samples_per_second 179.215
wandb:        eval/eval_steps_per_second 44.804
wandb:                              iter 1200
wandb:                   train/eval_loss 1.6329
wandb: train/eval_model_preparation_time 0.0015
wandb:                train/eval_runtime 0.1116
wandb:     train/eval_samples_per_second 179.215
wandb:       train/eval_steps_per_second 44.804
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144248-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144339-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:43:48,150	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:43:48,151	ERROR client.py:240 -- Config: {}
2024-11-11 14:43:48,153	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:43:49,048	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 68.64it/s]
[92mINFO [0m:      fit progress: (13, 0.0, {}, 642.4563648952171)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.017 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.017 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▂▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▇█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▇█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▂▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▇█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▇█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▂▂▁█▂▂▂▁▄▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▁▂▆▂▆▃█▄▂▇
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.22934
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0208
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 95.984
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 47.992
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1300
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.22934
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0208
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 95.984
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 47.992
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 53.04807
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.0226
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.41046
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.1504
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.407
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.852
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144319-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144351-uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.58it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:09, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.85it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.84it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.76it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.76it/s]  6%|▌         | 6/100 [00:00<00:09,  9.67it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.67it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:09,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.80it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:09,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08, 10.08it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08, 10.36it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08, 10.17it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08, 10.24it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08, 10.24it/s] 19%|█▉        | 19/100 [00:01<00:07, 11.34it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 11.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 11.34it/s] 21%|██        | 21/100 [00:01<00:06, 12.51it/s]                                                 21%|██        | 21/100 [00:01<00:06, 12.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:06, 12.51it/s] 23%|██▎       | 23/100 [00:02<00:05, 13.57it/s]                                                 23%|██▎       | 23/100 [00:02<00:05, 13.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:05, 13.57it/s] 25%|██▌       | 25/100 [00:02<00:05, 13.97it/s]                                                 25%|██▌       | 25/100 [00:02<00:05, 13.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:05, 13.97it/s] 27%|██▋       | 27/100 [00:02<00:05, 14.44it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 14.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:04, 14.44it/s] 29%|██▉       | 29/100 [00:02<00:04, 14.74it/s]                                                 29%|██▉       | 29/100 [00:02<00:04, 14.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:04, 14.74it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:02<00:04, 15.34it/s]                                                 31%|███       | 31/100 [00:02<00:04, 15.34it/s]                                                 32%|███▏      | 32/100 [00:02<00:04, 15.34it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:02<00:04, 15.48it/s]                                                 33%|███▎      | 33/100 [00:02<00:04, 15.48it/s]                                                 34%|███▍      | 34/100 [00:02<00:04, 15.48it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:02<00:04, 15.89it/s]                                                 35%|███▌      | 35/100 [00:02<00:04, 15.89it/s]                                                 36%|███▌      | 36/100 [00:02<00:04, 15.89it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:02<00:03, 16.05it/s]                                                 37%|███▋      | 37/100 [00:02<00:03, 16.05it/s]                                                 38%|███▊      | 38/100 [00:02<00:03, 16.05it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:03, 16.36it/s]                                                 39%|███▉      | 39/100 [00:03<00:03, 16.36it/s]                                                 40%|████      | 40/100 [00:03<00:03, 16.36it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:03, 16.01it/s]                                                 41%|████      | 41/100 [00:03<00:03, 16.01it/s]                                                 42%|████▏     | 42/100 [00:03<00:03, 16.01it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:03, 16.00it/s]                                                 43%|████▎     | 43/100 [00:03<00:03, 16.00it/s]                                                 44%|████▍     | 44/100 [00:03<00:03, 16.00it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:03<00:03, 15.95it/s]                                                 45%|████▌     | 45/100 [00:03<00:03, 15.95it/s]                                                 46%|████▌     | 46/100 [00:03<00:03, 15.95it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:03<00:03, 16.55it/s]                                                 47%|████▋     | 47/100 [00:03<00:03, 16.55it/s]                                                 48%|████▊     | 48/100 [00:03<00:03, 16.55it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:03<00:03, 16.78it/s]                                                 49%|████▉     | 49/100 [00:03<00:03, 16.78it/s]                                                 50%|█████     | 50/100 [00:03<00:02, 16.78it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1045.18it/s][A 50%|█████     | 50/100 [00:03<00:02, 16.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:04, 10.86it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:04<00:04, 10.86it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:04, 10.49it/s]                                                 53%|█████▎    | 53/100 [00:04<00:04, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:04<00:04, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:04<00:04, 10.27it/s]                                                 55%|█████▌    | 55/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:04<00:04, 10.34it/s]                                                 57%|█████▋    | 57/100 [00:04<00:04, 10.34it/s]                                                 58%|█████▊    | 58/100 [00:04<00:04, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:04<00:04, 10.22it/s]                                                 59%|█████▉    | 59/100 [00:04<00:04, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:04<00:03, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03, 10.15it/s]                                                 61%|██████    | 61/100 [00:05<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03, 10.14it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:05<00:03, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:05<00:03, 10.07it/s]                                                 65%|██████▌   | 65/100 [00:05<00:03, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:05<00:03, 10.07it/s] 67%|██████▋   | 67/100 [00:05<00:03, 10.22it/s]                                                 67%|██████▋   | 67/100 [00:05<00:03, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:05<00:03, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:05<00:03, 10.03it/s]                                                 69%|██████▉   | 69/100 [00:05<00:03, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:05<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02,  9.97it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02,  9.97it/s] 73%|███████▎  | 73/100 [00:06<00:02, 10.21it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:06<00:02, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02, 10.26it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:06<00:02, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:06<00:02, 10.18it/s]                                                 77%|███████▋  | 77/100 [00:06<00:02, 10.18it/s]                                                 78%|███████▊  | 78/100 [00:06<00:02, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:06<00:02, 10.08it/s]                                                 79%|███████▉  | 79/100 [00:06<00:02, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:06<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:06<00:01, 10.10it/s]                                                 81%|████████  | 81/100 [00:06<00:01, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01,  9.90it/s]                                                
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01,  9.94it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01,  9.93it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:07<00:01,  9.93it/s]                                                 87%|████████▋ | 87/100 [00:07<00:01,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:01,  9.70it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:07<00:01,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:07<00:00, 10.24it/s]                                                 90%|█████████ | 90/100 [00:07<00:00, 10.24it/s]                                                 91%|█████████ | 91/100 [00:07<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00, 10.45it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00, 10.30it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 10.30it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00, 10.47it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00, 10.34it/s]                                                 98%|█████████▊| 98/100 [00:08<00:00, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:08<00:00, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:08<00:00, 10.17it/s]                                                 100%|██████████| 100/100 [00:08<00:00, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 678.47it/s][A100%|██████████| 100/100 [00:08<00:00, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.17it/s]100%|██████████| 100/100 [00:09<00:00, 11.04it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▄
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▄
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▅▇▄▃▄▄▅▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂▇▂▆▃▇▂▃█▁█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.81499
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.002
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0199
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 100.7
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 50.35
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1400
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.81499
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.002
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0199
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 100.7
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 50.35
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 53.85637
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.516
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8312527552512.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.6279
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.0564
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 44.168
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 11.042
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_0 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144351-uijo9p43_client_0/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144409-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 975.87it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.76it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.10it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09, 10.20it/s]                                                 8%|▊         | 8/100 [00:00<00:09, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.18it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.18it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.13it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.97it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.97it/s] 16%|█▌        | 16/100 [00:01<00:08, 10.22it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.22it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.26it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.26it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.38it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.32it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.22it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.08it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.36it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.36it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.21it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.09it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.00it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.92it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.89it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:06,  9.88it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.88it/s] 41%|████      | 41/100 [00:04<00:05,  9.89it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05,  9.92it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05,  9.92it/s]                                                 45%|████▌     | 45/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.92it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.78it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05,  9.68it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.54it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:05,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 755.05it/s][A 50%|█████     | 50/100 [00:05<00:05,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.12it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.12it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.54it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.54it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  7.98it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  7.98it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.39it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.39it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.17it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.17it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.31it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.31it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.38it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:06<00:04,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.69it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:04,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03,  9.73it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.77it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.75it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.60it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.99it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:07<00:03,  9.91it/s]                                                 69%|██████▉   | 69/100 [00:07<00:03,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:03,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.79it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.87it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.76it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.70it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.57it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.63it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:08<00:02,  9.63it/s] 79%|███████▉  | 79/100 [00:08<00:02,  9.94it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:02,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.11it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.11it/s] 83%|████████▎ | 83/100 [00:08<00:01,  9.99it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.97it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.84it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.85it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:09<00:01,  9.77it/s]                                                 88%|████████▊ | 88/100 [00:09<00:01,  9.77it/s]                                                 89%|████████▉ | 89/100 [00:09<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:01,  9.97it/s]                                                 90%|█████████ | 90/100 [00:09<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.90it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00,  9.79it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00,  9.79it/s] 93%|█████████▎| 93/100 [00:09<00:00,  9.81it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.75it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.62it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.65it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:10<00:00,  9.65it/s] 99%|█████████▉| 99/100 [00:10<00:00,  9.96it/s]                                                 99%|█████████▉| 99/100 [00:10<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00,  9.79it/s]                                                 100%|██████████| 100/100 [00:10<00:00,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 797.24it/s][A100%|██████████| 100/100 [00:10<00:00,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.79it/s]100%|██████████| 100/100 [00:10<00:00,  9.59it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.004 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb: - 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.6355
wandb:  eval/eval_model_preparation_time 0.0017
wandb:                 eval/eval_runtime 0.0944
wandb:      eval/eval_samples_per_second 211.843
wandb:        eval/eval_steps_per_second 52.961
wandb:                              iter 1300
wandb:                   train/eval_loss 1.6355
wandb: train/eval_model_preparation_time 0.0017
wandb:                train/eval_runtime 0.0944
wandb:     train/eval_samples_per_second 211.843
wandb:       train/eval_steps_per_second 52.961
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144339-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144426-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:44:34,257	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:44:34,258	ERROR client.py:240 -- Config: {}
2024-11-11 14:44:34,259	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:44:35,125	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 68.26it/s]
[92mINFO [0m:      fit progress: (14, 0.0, {}, 688.5267413961701)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.017 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.017 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▃█▃▃█▄▃▂▁▄
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▃▅█▂▅▅▃▁▁▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.51457
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.022
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 90.995
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 45.497
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1400
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.51457
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.022
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 90.995
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 45.497
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 43.3289
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7851
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.14955
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.4235
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.375
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.594
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144409-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144437-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.88it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09,  9.88it/s]  4%|▍         | 4/100 [00:00<00:09, 10.02it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.98it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.94it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:09,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:08, 10.27it/s]                                                 9%|▉         | 9/100 [00:00<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:00<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08, 10.19it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.83it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.89it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.87it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.87it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08, 10.03it/s]                                                 19%|█▉        | 19/100 [00:01<00:08, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07,  9.96it/s]                                                 21%|██        | 21/100 [00:02<00:07,  9.96it/s]                                                 22%|██▏       | 22/100 [00:02<00:07,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.13it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.34it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.34it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.42it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:06, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:06, 10.38it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.38it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.25it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.30it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.15it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.15it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.13it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.13it/s] 39%|███▉      | 39/100 [00:03<00:05, 11.36it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 11.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 11.36it/s] 41%|████      | 41/100 [00:03<00:04, 12.65it/s]                                                 41%|████      | 41/100 [00:03<00:04, 12.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:04, 12.65it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:04, 13.97it/s]                                                 43%|████▎     | 43/100 [00:04<00:04, 13.97it/s]                                                 44%|████▍     | 44/100 [00:04<00:04, 13.97it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:03, 14.59it/s]                                                 45%|████▌     | 45/100 [00:04<00:03, 14.59it/s]                                                 46%|████▌     | 46/100 [00:04<00:03, 14.59it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:03, 15.00it/s]                                                 47%|████▋     | 47/100 [00:04<00:03, 15.00it/s]                                                 48%|████▊     | 48/100 [00:04<00:03, 15.00it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:03, 15.47it/s]                                                 49%|████▉     | 49/100 [00:04<00:03, 15.47it/s]                                                 50%|█████     | 50/100 [00:04<00:03, 15.47it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 795.88it/s][A 50%|█████     | 50/100 [00:04<00:03, 15.47it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:04, 10.43it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.43it/s]                                                 52%|█████▏    | 52/100 [00:04<00:04, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:04, 10.30it/s]                                                 53%|█████▎    | 53/100 [00:04<00:04, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:04, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04, 10.20it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04, 10.37it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:03, 10.34it/s]                                                 59%|█████▉    | 59/100 [00:05<00:03, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:03, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03, 10.18it/s]                                                 61%|██████    | 61/100 [00:05<00:03, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03, 10.01it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03, 10.01it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.03it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.96it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03,  9.90it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.90it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02,  9.90it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 10.17it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.01it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.88it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.77it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.77it/s] 79%|███████▉  | 79/100 [00:07<00:02,  9.80it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:02,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.95it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01,  9.99it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01,  9.99it/s] 84%|████████▍ | 84/100 [00:08<00:01,  9.93it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.87it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.78it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.69it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.57it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.21it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00, 10.08it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 10.08it/s] 94%|█████████▍| 94/100 [00:09<00:00, 10.07it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 10.01it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.01it/s] 98%|█████████▊| 98/100 [00:09<00:00, 10.59it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.59it/s]100%|██████████| 100/100 [00:09<00:00, 11.45it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 11.45it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 780.34it/s][A100%|██████████| 100/100 [00:09<00:00, 11.45it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 11.45it/s]100%|██████████| 100/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.005 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.018 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.018 MB of 0.018 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▃█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▆▄▅▃▃▃█▆▁▇
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▂▇█▂▅▆▂▁▁▄
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.51594
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0238
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 83.926
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 41.963
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1500
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.51594
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0238
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 83.926
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 41.963
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 75.36528
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.9562
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.06883
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.7493
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.028
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.257
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144437-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144456-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 928.56it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09,  9.94it/s]  2%|▏         | 2/100 [00:00<00:09, 10.07it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.05it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.09it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.09it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.51it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.51it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.37it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.27it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.20it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.05it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.00it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08, 10.00it/s] 20%|██        | 20/100 [00:01<00:07, 10.07it/s]                                                
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.10it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.01it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.01it/s] 26%|██▌       | 26/100 [00:02<00:07, 10.01it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07,  9.90it/s]                                                 28%|██▊       | 28/100 [00:02<00:07,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:07,  9.83it/s]                                                 30%|███       | 30/100 [00:02<00:07,  9.83it/s] 31%|███       | 31/100 [00:03<00:07,  9.73it/s]                                                 31%|███       | 31/100 [00:03<00:07,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.10it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.38it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.08it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06, 10.02it/s]                                                 39%|███▉      | 39/100 [00:03<00:06, 10.02it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05,  9.92it/s]                                                 41%|████      | 41/100 [00:04<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.74it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.06it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05, 10.29it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.11it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:05,  9.89it/s]                                                 50%|█████     | 50/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 951.74it/s][A 50%|█████     | 50/100 [00:05<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.35it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.35it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.73it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.73it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.11it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.11it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.71it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.71it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.91it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.91it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.09it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.09it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.22it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:06<00:04,  9.22it/s] 60%|██████    | 60/100 [00:06<00:04,  9.76it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.70it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03,  9.70it/s] 63%|██████▎   | 63/100 [00:06<00:03, 11.09it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03, 11.09it/s] 65%|██████▌   | 65/100 [00:06<00:02, 12.24it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 12.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:02, 12.24it/s] 67%|██████▋   | 67/100 [00:06<00:02, 13.31it/s]                                                 67%|██████▋   | 67/100 [00:06<00:02, 13.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:02, 13.31it/s] 69%|██████▉   | 69/100 [00:06<00:02, 14.25it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 14.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:02, 14.25it/s] 71%|███████   | 71/100 [00:06<00:02, 13.98it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 13.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 13.98it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 12.53it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 12.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 12.53it/s] 75%|███████▌  | 75/100 [00:07<00:02, 12.19it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 12.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:01, 12.19it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 11.46it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 11.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:01, 11.46it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:01, 10.84it/s]                                                 79%|███████▉  | 79/100 [00:07<00:01, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 10.66it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.66it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.44it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.24it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.14it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.14it/s] 89%|████████▉ | 89/100 [00:08<00:01, 10.01it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.04it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.93it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.93it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 10.13it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.13it/s] 98%|█████████▊| 98/100 [00:09<00:00, 10.39it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 10.28it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 799.98it/s][A100%|██████████| 100/100 [00:09<00:00, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.28it/s]100%|██████████| 100/100 [00:10<00:00,  9.96it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.004 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.000 MB of 0.063 MB uploadedwandb: - 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.58488
wandb:  eval/eval_model_preparation_time 0.0023
wandb:                 eval/eval_runtime 0.1065
wandb:      eval/eval_samples_per_second 187.727
wandb:        eval/eval_steps_per_second 46.932
wandb:                              iter 1400
wandb:                   train/eval_loss 1.58488
wandb: train/eval_model_preparation_time 0.0023
wandb:                train/eval_runtime 0.1065
wandb:     train/eval_samples_per_second 187.727
wandb:       train/eval_steps_per_second 46.932
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144426-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144516-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:45:25,898	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:45:25,903	ERROR client.py:240 -- Config: {}
2024-11-11 14:45:25,904	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:45:26,738	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 70.63it/s]
[92mINFO [0m:      fit progress: (15, 0.0, {}, 740.1626104442403)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▆▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▆▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▁▅▃▄▁▃█▃▂▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▂▁█▄▅▁▅▇▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.09837
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0195
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 102.618
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 51.309
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1500
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.09837
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0195
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 102.618
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 51.309
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 37.47289
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7532
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.24785
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.0355
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.858
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.965
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144456-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144529-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 965.76it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:07, 13.08it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:07, 13.77it/s]                                                 2%|▏         | 2/100 [00:00<00:07, 13.77it/s]                                                 3%|▎         | 3/100 [00:00<00:07, 13.77it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:06, 14.67it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 14.67it/s]                                                 5%|▌         | 5/100 [00:00<00:06, 14.67it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:05, 15.70it/s]                                                 6%|▌         | 6/100 [00:00<00:05, 15.70it/s]                                                 7%|▋         | 7/100 [00:00<00:05, 15.70it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:05, 15.99it/s]                                                 8%|▊         | 8/100 [00:00<00:05, 15.99it/s]                                                 9%|▉         | 9/100 [00:00<00:05, 15.99it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:05, 16.79it/s]                                                 10%|█         | 10/100 [00:00<00:05, 16.79it/s]                                                 11%|█         | 11/100 [00:00<00:05, 16.79it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:00<00:05, 16.78it/s]                                                 12%|█▏        | 12/100 [00:00<00:05, 16.78it/s]                                                 13%|█▎        | 13/100 [00:00<00:05, 16.78it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:00<00:05, 17.18it/s]                                                 14%|█▍        | 14/100 [00:00<00:05, 17.18it/s]                                                 15%|█▌        | 15/100 [00:00<00:04, 17.18it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:00<00:04, 16.94it/s]                                                 16%|█▌        | 16/100 [00:00<00:04, 16.94it/s]                                                 17%|█▋        | 17/100 [00:01<00:04, 16.94it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:04, 16.91it/s]                                                 18%|█▊        | 18/100 [00:01<00:04, 16.91it/s]                                                 19%|█▉        | 19/100 [00:01<00:04, 16.91it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:04, 16.52it/s]                                                 20%|██        | 20/100 [00:01<00:04, 16.52it/s]                                                 21%|██        | 21/100 [00:01<00:04, 16.52it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:04, 16.08it/s]                                                 22%|██▏       | 22/100 [00:01<00:04, 16.08it/s]                                                 23%|██▎       | 23/100 [00:01<00:04, 16.08it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:01<00:04, 16.37it/s]                                                 24%|██▍       | 24/100 [00:01<00:04, 16.37it/s]                                                 25%|██▌       | 25/100 [00:01<00:04, 16.37it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:01<00:04, 16.01it/s]                                                 26%|██▌       | 26/100 [00:01<00:04, 16.01it/s]                                                 27%|██▋       | 27/100 [00:01<00:04, 16.01it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:01<00:05, 13.92it/s]                                                 28%|██▊       | 28/100 [00:01<00:05, 13.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:01<00:05, 13.92it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:01<00:05, 12.50it/s]                                                 30%|███       | 30/100 [00:01<00:05, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:05, 12.50it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:05, 11.84it/s]                                                 32%|███▏      | 32/100 [00:02<00:05, 11.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:05, 11.84it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:02<00:05, 11.24it/s]                                                 34%|███▍      | 34/100 [00:02<00:05, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:02<00:05, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:02<00:05, 11.85it/s]                                                 36%|███▌      | 36/100 [00:02<00:05, 11.85it/s]                                                 37%|███▋      | 37/100 [00:02<00:05, 11.85it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:02<00:04, 12.88it/s]                                                 38%|███▊      | 38/100 [00:02<00:04, 12.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:02<00:04, 12.88it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:02<00:04, 13.66it/s]                                                 40%|████      | 40/100 [00:02<00:04, 13.66it/s]                                                 41%|████      | 41/100 [00:02<00:04, 13.66it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:02<00:03, 14.50it/s]                                                 42%|████▏     | 42/100 [00:02<00:03, 14.50it/s]                                                 43%|████▎     | 43/100 [00:02<00:03, 14.50it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:03, 15.30it/s]                                                 44%|████▍     | 44/100 [00:03<00:03, 15.30it/s]                                                 45%|████▌     | 45/100 [00:03<00:03, 15.30it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:03, 15.63it/s]                                                 46%|████▌     | 46/100 [00:03<00:03, 15.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:03<00:03, 15.63it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:03<00:03, 13.36it/s]                                                 48%|████▊     | 48/100 [00:03<00:03, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:03<00:03, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:03<00:04, 12.06it/s]                                                 50%|█████     | 50/100 [00:03<00:04, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 790.19it/s][A 50%|█████     | 50/100 [00:03<00:04, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:03<00:04, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:03<00:05,  8.16it/s]                                                 52%|█████▏    | 52/100 [00:03<00:05,  8.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:04<00:05,  8.16it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:05,  8.63it/s]                                                 54%|█████▍    | 54/100 [00:04<00:05,  8.63it/s]                                                 55%|█████▌    | 55/100 [00:04<00:05,  8.63it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:04<00:04,  9.24it/s]                                                 56%|█████▌    | 56/100 [00:04<00:04,  9.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:04<00:04,  9.24it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:04<00:04,  9.44it/s]                                                 58%|█████▊    | 58/100 [00:04<00:04,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:04<00:04,  9.44it/s] 60%|██████    | 60/100 [00:04<00:04,  9.72it/s]                                                 60%|██████    | 60/100 [00:04<00:04,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:04<00:04,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:04<00:03,  9.66it/s]                                                 62%|██████▏   | 62/100 [00:04<00:03,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:05<00:03,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:05<00:03,  9.74it/s]                                                 64%|██████▍   | 64/100 [00:05<00:03,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:05<00:03,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:05<00:03,  9.73it/s]                                                 66%|██████▌   | 66/100 [00:05<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:05<00:03,  9.69it/s]                                                 67%|██████▋   | 67/100 [00:05<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:05<00:03,  9.64it/s]                                                 68%|██████▊   | 68/100 [00:05<00:03,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:05<00:03,  9.63it/s]                                                 69%|██████▉   | 69/100 [00:05<00:03,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:05<00:03,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:05<00:02,  9.76it/s]                                                 71%|███████   | 71/100 [00:05<00:02,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:05<00:02,  9.69it/s]                                                 72%|███████▏  | 72/100 [00:05<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02,  9.59it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:06<00:02,  9.53it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02,  9.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:06<00:02,  9.53it/s] 76%|███████▌  | 76/100 [00:06<00:02,  9.77it/s]                                                 76%|███████▌  | 76/100 [00:06<00:02,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:06<00:02,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:06<00:02,  9.80it/s]                                                 78%|███████▊  | 78/100 [00:06<00:02,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:06<00:02,  9.75it/s]                                                 79%|███████▉  | 79/100 [00:06<00:02,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:06<00:02,  9.75it/s] 81%|████████  | 81/100 [00:06<00:01, 10.00it/s]                                                 81%|████████  | 81/100 [00:06<00:01, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:06<00:01,  9.88it/s]                                                 82%|████████▏ | 82/100 [00:06<00:01,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:07<00:01,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:07<00:01, 10.04it/s]                                                 84%|████████▍ | 84/100 [00:07<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:07<00:01, 10.04it/s] 86%|████████▌ | 86/100 [00:07<00:01, 10.02it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:01, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:01, 10.26it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:07<00:01, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:07<00:00, 10.31it/s]                                                 90%|█████████ | 90/100 [00:07<00:00, 10.31it/s]                                                 91%|█████████ | 91/100 [00:07<00:00, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:07<00:00, 10.11it/s]                                                 92%|█████████▏| 92/100 [00:07<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00,  9.98it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:08<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00,  9.96it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:08<00:00,  9.85it/s]                                                 97%|█████████▋| 97/100 [00:08<00:00,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00,  9.72it/s]                                                 98%|█████████▊| 98/100 [00:08<00:00,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:08<00:00,  9.58it/s]                                                 99%|█████████▉| 99/100 [00:08<00:00,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:08<00:00,  9.64it/s]                                                 100%|██████████| 100/100 [00:08<00:00,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 775.14it/s][A100%|██████████| 100/100 [00:08<00:00,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.64it/s]100%|██████████| 100/100 [00:09<00:00, 11.08it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▃▃▃▅▄▃▄▂█▇
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▂▆█▂▅▅▂▁▁▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.64408
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0241
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 82.897
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 41.449
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1600
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.64408
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0241
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 82.897
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 41.449
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 83.15038
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7471
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 0.98971
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.0194
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 44.349
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 11.087
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144529-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144547-uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 932.48it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.03it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.08it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.90it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.89it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.82it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.96it/s]                                                 10%|█         | 10/100 [00:01<00:09,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.87it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:09,  9.69it/s]                                                 12%|█▏        | 12/100 [00:01<00:09,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:09,  9.66it/s]                                                 13%|█▎        | 13/100 [00:01<00:09,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.70it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.78it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.78it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.50it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.50it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:06, 11.99it/s]                                                 20%|██        | 20/100 [00:01<00:06, 11.99it/s]                                                 21%|██        | 21/100 [00:01<00:06, 11.99it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:05, 13.15it/s]                                                 22%|██▏       | 22/100 [00:02<00:05, 13.15it/s]                                                 23%|██▎       | 23/100 [00:02<00:05, 13.15it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:05, 14.23it/s]                                                 24%|██▍       | 24/100 [00:02<00:05, 14.23it/s]                                                 25%|██▌       | 25/100 [00:02<00:05, 14.23it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:04, 14.82it/s]                                                 26%|██▌       | 26/100 [00:02<00:04, 14.82it/s]                                                 27%|██▋       | 27/100 [00:02<00:04, 14.82it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:04, 15.41it/s]                                                 28%|██▊       | 28/100 [00:02<00:04, 15.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:04, 15.41it/s] 30%|███       | 30/100 [00:02<00:04, 15.68it/s]                                                 30%|███       | 30/100 [00:02<00:04, 15.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:04, 15.68it/s] 32%|███▏      | 32/100 [00:02<00:04, 15.90it/s]                                                 32%|███▏      | 32/100 [00:02<00:04, 15.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:04, 15.90it/s] 34%|███▍      | 34/100 [00:02<00:04, 16.04it/s]                                                 34%|███▍      | 34/100 [00:02<00:04, 16.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:02<00:04, 16.04it/s] 36%|███▌      | 36/100 [00:02<00:03, 16.28it/s]                                                 36%|███▌      | 36/100 [00:02<00:03, 16.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:02<00:03, 16.28it/s] 38%|███▊      | 38/100 [00:03<00:03, 16.43it/s]                                                 38%|███▊      | 38/100 [00:03<00:03, 16.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:03, 16.43it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:04, 14.10it/s]                                                 40%|████      | 40/100 [00:03<00:04, 14.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:04, 14.10it/s] 42%|████▏     | 42/100 [00:03<00:04, 12.42it/s]                                                
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:03<00:04, 12.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:04, 12.42it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:04, 11.68it/s]                                                 44%|████▍     | 44/100 [00:03<00:04, 11.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:03<00:04, 11.68it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:04, 10.93it/s]                                                 46%|████▌     | 46/100 [00:03<00:04, 10.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:03<00:04, 10.93it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:04, 10.62it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 10.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:04, 10.62it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.38it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 749.12it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:05,  8.55it/s]                                                 52%|█████▏    | 52/100 [00:04<00:05,  8.55it/s]                                                 53%|█████▎    | 53/100 [00:04<00:05,  8.55it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:04, 10.05it/s]                                                 54%|█████▍    | 54/100 [00:04<00:04, 10.05it/s]                                                 55%|█████▌    | 55/100 [00:04<00:04, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:04<00:03, 11.33it/s]                                                 56%|█████▌    | 56/100 [00:04<00:03, 11.33it/s]                                                 57%|█████▋    | 57/100 [00:04<00:03, 11.33it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:04<00:03, 12.52it/s]                                                 58%|█████▊    | 58/100 [00:04<00:03, 12.52it/s]                                                 59%|█████▉    | 59/100 [00:04<00:03, 12.52it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:02, 13.45it/s]                                                 60%|██████    | 60/100 [00:05<00:02, 13.45it/s]                                                 61%|██████    | 61/100 [00:05<00:02, 13.45it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:05<00:02, 14.32it/s]                                                 62%|██████▏   | 62/100 [00:05<00:02, 14.32it/s]                                                 63%|██████▎   | 63/100 [00:05<00:02, 14.32it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:05<00:02, 14.23it/s]                                                 64%|██████▍   | 64/100 [00:05<00:02, 14.23it/s]                                                 65%|██████▌   | 65/100 [00:05<00:02, 14.23it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:05<00:02, 14.84it/s]                                                 66%|██████▌   | 66/100 [00:05<00:02, 14.84it/s]                                                 67%|██████▋   | 67/100 [00:05<00:02, 14.84it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:05<00:02, 15.45it/s]                                                 68%|██████▊   | 68/100 [00:05<00:02, 15.45it/s]                                                 69%|██████▉   | 69/100 [00:05<00:02, 15.45it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:05<00:01, 16.17it/s]                                                 70%|███████   | 70/100 [00:05<00:01, 16.17it/s]                                                 71%|███████   | 71/100 [00:05<00:01, 16.17it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:05<00:01, 16.28it/s]                                                 72%|███████▏  | 72/100 [00:05<00:01, 16.28it/s]                                                 73%|███████▎  | 73/100 [00:05<00:01, 16.28it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:05<00:01, 16.64it/s]                                                 74%|███████▍  | 74/100 [00:05<00:01, 16.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:05<00:01, 16.64it/s] 76%|███████▌  | 76/100 [00:05<00:01, 16.67it/s]                                                 76%|███████▌  | 76/100 [00:05<00:01, 16.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:06<00:01, 16.67it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:06<00:01, 13.70it/s]                                                 78%|███████▊  | 78/100 [00:06<00:01, 13.70it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:06<00:01, 13.70it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:06<00:01, 12.36it/s]                                                 80%|████████  | 80/100 [00:06<00:01, 12.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:06<00:01, 12.36it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:06<00:01, 11.32it/s]                                                 82%|████████▏ | 82/100 [00:06<00:01, 11.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:06<00:01, 11.32it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:06<00:01, 11.06it/s]                                                 84%|████████▍ | 84/100 [00:06<00:01, 11.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:06<00:01, 11.06it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01, 10.57it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:01, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:01, 10.65it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01, 10.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:07<00:01, 10.65it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:07<00:00, 10.41it/s]                                                 90%|█████████ | 90/100 [00:07<00:00, 10.41it/s]                                                
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:07<00:00, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:07<00:00, 10.32it/s]                                                 92%|█████████▏| 92/100 [00:07<00:00, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:07<00:00, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:07<00:00, 10.29it/s]                                                 94%|█████████▍| 94/100 [00:07<00:00, 10.29it/s]                                                 95%|█████████▌| 95/100 [00:07<00:00, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:07<00:00, 10.27it/s]                                                 96%|█████████▌| 96/100 [00:07<00:00, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00, 10.15it/s]                                                 98%|█████████▊| 98/100 [00:08<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:08<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:08<00:00, 10.05it/s]                                                 100%|██████████| 100/100 [00:08<00:00, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 759.70it/s][A100%|██████████| 100/100 [00:08<00:00, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:08<00:00, 10.05it/s]100%|██████████| 100/100 [00:08<00:00, 11.60it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.062 MB of 0.062 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.60893
wandb:  eval/eval_model_preparation_time 0.0028
wandb:                 eval/eval_runtime 0.0986
wandb:      eval/eval_samples_per_second 202.761
wandb:        eval/eval_steps_per_second 50.69
wandb:                              iter 1500
wandb:                   train/eval_loss 1.60893
wandb: train/eval_model_preparation_time 0.0028
wandb:                train/eval_runtime 0.0986
wandb:     train/eval_samples_per_second 202.761
wandb:       train/eval_steps_per_second 50.69
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144516-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144603-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:46:10,729	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:46:10,730	ERROR client.py:240 -- Config: {}
2024-11-11 14:46:10,732	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:46:11,582	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 66.63it/s]
[92mINFO [0m:      fit progress: (16, 0.0, {}, 785.0057027991861)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 4
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.015 MB uploadedwandb: | 0.000 MB of 0.015 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▄▁█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▄▁█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▁▆▂█▁▃▂▃▆▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▇▁▆█▃▁▄▄▇▅▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.83146
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0018
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0282
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 70.826
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 35.413
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1600
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.83146
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0018
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0282
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 70.826
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 35.413
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 32.32324
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.6723
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8549966807040.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.51364
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 8.6184
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 46.412
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 11.603
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_5 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144547-uijo9p43_client_5/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144614-uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 936.44it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.93it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.24it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.18it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09, 10.04it/s]                                                 8%|▊         | 8/100 [00:00<00:09, 10.04it/s]                                                 9%|▉         | 9/100 [00:00<00:09, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.22it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.29it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.24it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.20it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.20it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.16it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.07it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.07it/s] 22%|██▏       | 22/100 [00:02<00:07, 10.15it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.30it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.06it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.02it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.02it/s]                                                 29%|██▉       | 29/100 [00:02<00:07, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.06it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.06it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.06it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.03it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.02it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.10it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.01it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05, 10.07it/s]                                                 42%|████▏     | 42/100 [00:04<00:05, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.26it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05, 10.03it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.03it/s] 48%|████▊     | 48/100 [00:04<00:05,  9.82it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.72it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:05,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 719.19it/s][A 50%|█████     | 50/100 [00:05<00:05,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.61it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:06,  7.61it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.29it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.29it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.55it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.55it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.73it/s]                                                
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:05,  8.73it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.07it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.07it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.21it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.21it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:06<00:04,  9.28it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04,  9.28it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.45it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.41it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.41it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:04,  9.44it/s]                                                 62%|██████▏   | 62/100 [00:06<00:04,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.49it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.40it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.40it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.43it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.43it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.38it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.39it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.39it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:07<00:03,  9.43it/s]                                                 68%|██████▊   | 68/100 [00:07<00:03,  9.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:07<00:03,  9.43it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:07<00:03,  9.85it/s]                                                 70%|███████   | 70/100 [00:07<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.84it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.84it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.99it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.03it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.28it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.28it/s] 79%|███████▉  | 79/100 [00:08<00:02, 10.27it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:01, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.40it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.03it/s] 85%|████████▌ | 85/100 [00:08<00:01, 11.26it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 11.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 11.26it/s] 87%|████████▋ | 87/100 [00:08<00:01, 12.45it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 12.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:00, 12.45it/s] 89%|████████▉ | 89/100 [00:08<00:00, 13.47it/s]                                                 89%|████████▉ | 89/100 [00:08<00:00, 13.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 13.47it/s] 91%|█████████ | 91/100 [00:08<00:00, 14.09it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 14.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 14.09it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00, 14.66it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 14.66it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 14.66it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 15.52it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 15.52it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 15.52it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 15.63it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 15.63it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 15.63it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00, 15.76it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 15.76it/s]                                                100%|██████████| 100/100 [00:09<00:00, 15.76it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 783.54it/s][A100%|██████████| 100/100 [00:09<00:00, 15.76it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 15.76it/s]100%|██████████| 100/100 [00:09<00:00, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.015 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.015 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▆▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▆▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▇▁▄▇▄▁▄█▅▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▁█▁▂▃▁▅█▄▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.59391
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0185
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 108.087
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 54.043
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1700
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.59391
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0185
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 108.087
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 54.043
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 31.30127
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7045
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8315758018560.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.35441
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.741
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.064
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.266
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_4 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144614-uijo9p43_client_4/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144633-uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 871.45it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:06, 15.55it/s]  2%|▏         | 2/100 [00:00<00:05, 16.77it/s]                                                 2%|▏         | 2/100 [00:00<00:05, 16.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:05, 16.77it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:07, 12.99it/s]                                                 4%|▍         | 4/100 [00:00<00:07, 12.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:07, 12.99it/s]  6%|▌         | 6/100 [00:00<00:08, 11.21it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 11.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:08, 11.21it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.80it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.80it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.47it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.47it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.33it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.37it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.37it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.44it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.28it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.28it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.18it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.28it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.32it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.46it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:06, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:06, 10.68it/s]                                                 28%|██▊       | 28/100 [00:02<00:06, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.68it/s] 30%|███       | 30/100 [00:02<00:06, 10.52it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06, 10.15it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.13it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.05it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.05it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.14it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.02it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:05, 10.02it/s] 42%|████▏     | 42/100 [00:04<00:05,  9.97it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.94it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.97it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.97it/s] 47%|████▋     | 47/100 [00:04<00:05,  9.97it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05,  9.94it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.90it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:05,  9.84it/s]                                                 50%|█████     | 50/100 [00:04<00:05,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1014.59it/s][A 50%|█████     | 50/100 [00:04<00:05,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:07,  6.67it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:07,  6.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:07,  6.67it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:06,  7.78it/s]                                                 53%|█████▎    | 53/100 [00:05<00:06,  7.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  7.78it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.56it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.56it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:05,  8.75it/s]                                                 56%|█████▌    | 56/100 [00:05<00:05,  8.75it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.18it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.18it/s] 59%|█████▉    | 59/100 [00:05<00:04,  9.29it/s]                                                
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.29it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.46it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:04,  9.46it/s]                                                 62%|██████▏   | 62/100 [00:06<00:04,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.46it/s] 64%|██████▍   | 64/100 [00:06<00:03,  9.72it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.71it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.91it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03, 10.32it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:02, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.10it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.10it/s] 73%|███████▎  | 73/100 [00:07<00:02, 10.06it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.02it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.74it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.69it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:08<00:02,  9.78it/s]                                                 80%|████████  | 80/100 [00:08<00:02,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:08<00:01,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.99it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 10.30it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.13it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.03it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:01, 10.00it/s]                                                 90%|█████████ | 90/100 [00:09<00:01, 10.00it/s]                                                 91%|█████████ | 91/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.09it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.89it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.68it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.99it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00, 10.13it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.13it/s]                                                100%|██████████| 100/100 [00:10<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 762.18it/s][A100%|██████████| 100/100 [00:10<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.13it/s]100%|██████████| 100/100 [00:10<00:00,  9.78it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.58169
wandb:  eval/eval_model_preparation_time 0.0016
wandb:                 eval/eval_runtime 0.0983
wandb:      eval/eval_samples_per_second 203.548
wandb:        eval/eval_steps_per_second 50.887
wandb:                              iter 1600
wandb:                   train/eval_loss 1.58169
wandb: train/eval_model_preparation_time 0.0016
wandb:                train/eval_runtime 0.0983
wandb:     train/eval_samples_per_second 203.548
wandb:       train/eval_steps_per_second 50.887
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144603-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144652-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:47:01,719	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:47:01,719	ERROR client.py:240 -- Config: {}
2024-11-11 14:47:01,720	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:47:02,565	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 69.84it/s]
[92mINFO [0m:      fit progress: (17, 0.0, {}, 835.9675859739073)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▅▆▃█▁▄▃▄▂▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂▁▃▂▁█▆██▂▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.71761
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.003
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0223
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 89.846
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 44.923
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1700
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.71761
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.003
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0223
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 89.846
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 44.923
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 52.55012
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.9898
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8263532150784.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.4003
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.2231
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.127
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.782
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_7 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144633-uijo9p43_client_7/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144704-uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 946.15it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:09, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:08, 12.08it/s]                                                 2%|▏         | 2/100 [00:00<00:08, 12.08it/s]                                                 3%|▎         | 3/100 [00:00<00:08, 12.08it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:06, 13.88it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 13.88it/s]                                                 5%|▌         | 5/100 [00:00<00:06, 13.88it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:06, 14.84it/s]                                                 6%|▌         | 6/100 [00:00<00:06, 14.84it/s]                                                 7%|▋         | 7/100 [00:00<00:06, 14.84it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:05, 15.62it/s]                                                 8%|▊         | 8/100 [00:00<00:05, 15.62it/s]                                                 9%|▉         | 9/100 [00:00<00:05, 15.62it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:05, 16.10it/s]                                                 10%|█         | 10/100 [00:00<00:05, 16.10it/s]                                                 11%|█         | 11/100 [00:00<00:05, 16.10it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:00<00:05, 15.64it/s]                                                 12%|█▏        | 12/100 [00:00<00:05, 15.64it/s]                                                 13%|█▎        | 13/100 [00:00<00:05, 15.64it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:00<00:05, 15.85it/s]                                                 14%|█▍        | 14/100 [00:00<00:05, 15.85it/s]                                                 15%|█▌        | 15/100 [00:00<00:05, 15.85it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:05, 15.84it/s]                                                 16%|█▌        | 16/100 [00:01<00:05, 15.84it/s]                                                 17%|█▋        | 17/100 [00:01<00:05, 15.84it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:05, 15.98it/s]                                                 18%|█▊        | 18/100 [00:01<00:05, 15.98it/s]                                                 19%|█▉        | 19/100 [00:01<00:05, 15.98it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:05, 14.22it/s]                                                 20%|██        | 20/100 [00:01<00:05, 14.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:05, 14.22it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:06, 12.45it/s]                                                 22%|██▏       | 22/100 [00:01<00:06, 12.45it/s]                                                 23%|██▎       | 23/100 [00:01<00:06, 12.45it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:01<00:06, 11.65it/s]                                                 24%|██▍       | 24/100 [00:01<00:06, 11.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:01<00:06, 11.65it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:01<00:06, 11.01it/s]                                                 26%|██▌       | 26/100 [00:01<00:06, 11.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:06, 11.01it/s] 28%|██▊       | 28/100 [00:02<00:06, 10.82it/s]                                                 28%|██▊       | 28/100 [00:02<00:06, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 11.00it/s]                                                 30%|███       | 30/100 [00:02<00:06, 11.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 11.00it/s] 32%|███▏      | 32/100 [00:02<00:06, 10.78it/s]                                                 32%|███▏      | 32/100 [00:02<00:06, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:06, 10.78it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:02<00:06, 10.40it/s]                                                 34%|███▍      | 34/100 [00:02<00:06, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:02<00:06, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:02<00:06, 10.27it/s]                                                 36%|███▌      | 36/100 [00:02<00:06, 10.27it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.15it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:06,  9.96it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:05,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:03<00:05, 10.11it/s]                                                 42%|████▏     | 42/100 [00:03<00:05, 10.11it/s]                                                 43%|████▎     | 43/100 [00:03<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:05, 10.25it/s]                                                 44%|████▍     | 44/100 [00:03<00:05, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:03<00:05, 10.25it/s] 46%|████▌     | 46/100 [00:03<00:04, 11.49it/s]                                                 46%|████▌     | 46/100 [00:03<00:04, 11.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:03<00:04, 11.49it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:04, 11.35it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 11.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:04, 11.35it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.84it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 756.41it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.84it/s] 52%|█████▏    | 52/100 [00:04<00:06,  7.77it/s]                                                
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:06,  7.77it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:05,  8.00it/s]                                                 53%|█████▎    | 53/100 [00:04<00:05,  8.00it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:05,  8.33it/s]                                                 54%|█████▍    | 54/100 [00:04<00:05,  8.33it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:04<00:05,  8.56it/s]                                                 55%|█████▌    | 55/100 [00:04<00:05,  8.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:05,  8.56it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.07it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.07it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.12it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.12it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.31it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:04,  9.31it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:04,  9.58it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03,  9.58it/s] 63%|██████▎   | 63/100 [00:05<00:03,  9.69it/s]                                                
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:05<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:05<00:03,  9.82it/s]                                                 65%|██████▌   | 65/100 [00:05<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.79it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.79it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.02it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.97it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02,  9.93it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 10.29it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:06<00:02, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02, 10.29it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02, 10.29it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.36it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.13it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 10.31it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:07<00:01, 10.26it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.26it/s]                                                 84%|████████▍ | 84/100 [00:07<00:01, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01, 10.41it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.17it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.24it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.10it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00,  9.91it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:08<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:08<00:00,  9.98it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.96it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.13it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00,  9.93it/s]                                                 100%|██████████| 100/100 [00:09<00:00,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 873.45it/s][A100%|██████████| 100/100 [00:09<00:00,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.93it/s]100%|██████████| 100/100 [00:09<00:00, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂▂▅▆▇▆▆▄▅▁█
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▄▃▆█▂▅▅▂▁▁▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.58705
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0211
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 94.722
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 47.361
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1800
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.58705
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0007
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0211
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 94.722
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 47.361
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 59.35559
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.6019
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8418056110080.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 0.92676
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.6341
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.519
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.38
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_2 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_2
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144704-uijo9p43_client_2/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144724-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.22it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.55it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.32it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.32it/s]                                                 3%|▎         | 3/100 [00:00<00:09, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.30it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.72it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.71it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.57it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.57it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.82it/s]                                                 10%|█         | 10/100 [00:01<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.61it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:09,  9.56it/s]                                                 12%|█▏        | 12/100 [00:01<00:09,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:09,  9.60it/s]                                                 13%|█▎        | 13/100 [00:01<00:09,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.82it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.81it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.79it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.79it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08,  9.79it/s]                                                 19%|█▉        | 19/100 [00:01<00:08,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:08,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.22it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07,  9.89it/s]                                                 23%|██▎       | 23/100 [00:02<00:07,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.00it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07,  9.95it/s]                                                 26%|██▌       | 26/100 [00:02<00:07,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.85it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.90it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:03<00:07,  9.92it/s]                                                 30%|███       | 30/100 [00:03<00:07,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06,  9.87it/s]                                                 32%|███▏      | 32/100 [00:03<00:06,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06,  9.82it/s]                                                 33%|███▎      | 33/100 [00:03<00:06,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06,  9.82it/s] 35%|███▌      | 35/100 [00:03<00:06, 10.29it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.27it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.27it/s] 39%|███▉      | 39/100 [00:03<00:05, 10.24it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:04<00:05, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05, 10.09it/s]                                                 41%|████      | 41/100 [00:04<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.35it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.68it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.68it/s] 47%|████▋     | 47/100 [00:04<00:05, 10.54it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:04, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:04, 10.55it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 10.55it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.55it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 804.28it/s][A 50%|█████     | 50/100 [00:05<00:04, 10.55it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.88it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:06,  7.88it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.49it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.49it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.89it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  8.89it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.42it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.42it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:06<00:04,  9.74it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03,  9.95it/s]                                                 61%|██████    | 61/100 [00:06<00:03,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03,  9.95it/s] 63%|██████▎   | 63/100 [00:06<00:03,  9.96it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.04it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03, 10.02it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03, 10.02it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:07<00:03,  9.94it/s]                                                 69%|██████▉   | 69/100 [00:07<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.07it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.94it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.92it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.83it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.80it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.83it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.80it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.80it/s]                                                 79%|███████▉  | 79/100 [00:08<00:02,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:08<00:02,  9.90it/s]                                                 80%|████████  | 80/100 [00:08<00:02,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01,  9.69it/s]                                                 81%|████████  | 81/100 [00:08<00:01,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.76it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01,  9.76it/s] 84%|████████▍ | 84/100 [00:08<00:01, 10.57it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.45it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.34it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:09<00:01, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:00, 10.26it/s]                                                 90%|█████████ | 90/100 [00:09<00:00, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:09<00:00, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.10it/s]                                                
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00, 10.07it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.86it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00,  9.86it/s] 98%|█████████▊| 98/100 [00:09<00:00, 10.00it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:10<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00, 10.14it/s]                                                 100%|██████████| 100/100 [00:10<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 777.44it/s][A100%|██████████| 100/100 [00:10<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.14it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.5921
wandb:  eval/eval_model_preparation_time 0.0011
wandb:                 eval/eval_runtime 0.0938
wandb:      eval/eval_samples_per_second 213.128
wandb:        eval/eval_steps_per_second 53.282
wandb:                              iter 1700
wandb:                   train/eval_loss 1.5921
wandb: train/eval_model_preparation_time 0.0011
wandb:                train/eval_runtime 0.0938
wandb:     train/eval_samples_per_second 213.128
wandb:       train/eval_steps_per_second 53.282
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144652-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144744-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:47:52,799	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:47:52,800	ERROR client.py:240 -- Config: {}
2024-11-11 14:47:52,801	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:47:53,685	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 68.77it/s]
[92mINFO [0m:      fit progress: (18, 0.0, {}, 887.1100020790473)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.000 MB of 0.018 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▅█▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▆▁█▄▃▂▅█▄▂▇
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▁▁█▃▅▁▅█▂▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 1.89586
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0034
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.02
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 99.962
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 49.981
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1800
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 1.89586
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0034
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.02
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 99.962
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 49.981
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 66.61849
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7682
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.12085
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.329
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.726
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.681
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144724-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144755-uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Syncing run uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/38 [00:00<?, ? examples/s]Map: 100%|██████████| 38/38 [00:00<00:00, 1230.72 examples/s]
[36m(ClientAppActor pid=263676)[0m Map:   0%|          | 0/2 [00:00<?, ? examples/s]Map: 100%|██████████| 2/2 [00:00<00:00, 63.96 examples/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 989.46it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.13it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.13it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:10,  9.29it/s]                                                 2%|▏         | 2/100 [00:00<00:10,  9.29it/s]  3%|▎         | 3/100 [00:00<00:10,  9.49it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:10,  9.50it/s]                                                 4%|▍         | 4/100 [00:00<00:10,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.55it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.55it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09,  9.55it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.80it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:09,  9.80it/s]  9%|▉         | 9/100 [00:00<00:09,  9.90it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.90it/s]                                                 10%|█         | 10/100 [00:01<00:09,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.80it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.83it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.81it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.67it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.67it/s]                                                
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.93it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.85it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08, 10.00it/s]                                                 19%|█▉        | 19/100 [00:01<00:08, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:07, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07,  9.95it/s]                                                 21%|██        | 21/100 [00:02<00:07,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.08it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.19it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.19it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:06, 10.15it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.28it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.17it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.13it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.89it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.90it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:06,  9.87it/s]                                                 39%|███▉      | 39/100 [00:03<00:06,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:04<00:06,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:04<00:05, 10.00it/s]                                                 41%|████      | 41/100 [00:04<00:05, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.98it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05,  9.95it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05,  9.82it/s]                                                 44%|████▍     | 44/100 [00:04<00:05,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05,  9.88it/s]                                                 46%|████▌     | 46/100 [00:04<00:05,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05,  9.89it/s]                                                 47%|████▋     | 47/100 [00:04<00:05,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05,  9.87it/s]                                                 48%|████▊     | 48/100 [00:04<00:05,  9.87it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:05<00:04, 10.05it/s]                                                 50%|█████     | 50/100 [00:05<00:04, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1028.02it/s][A 50%|█████     | 50/100 [00:05<00:04, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:07,  6.94it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:07,  6.94it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  6.94it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  7.92it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  7.92it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.25it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.25it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.81it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.81it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]                                                 58%|█████▊    | 58/100 [00:06<00:04,  9.01it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:06<00:04, 10.19it/s]                                                 59%|█████▉    | 59/100 [00:06<00:04, 10.19it/s]                                                 60%|██████    | 60/100 [00:06<00:03, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:03, 11.49it/s]                                                 61%|██████    | 61/100 [00:06<00:03, 11.49it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 11.49it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03, 12.12it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03, 12.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:02, 12.12it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 11.26it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 11.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 11.26it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03, 10.66it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03, 10.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03, 10.66it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:02, 10.47it/s]                                                 69%|██████▉   | 69/100 [00:06<00:02, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:07<00:02, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02, 10.73it/s]                                                 71%|███████   | 71/100 [00:07<00:02, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02, 10.73it/s] 73%|███████▎  | 73/100 [00:07<00:02, 10.79it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.79it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.82it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 10.36it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.36it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02, 10.20it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:01, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.04it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.97it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.76it/s]                                                
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.94it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01,  9.94it/s] 89%|████████▉ | 89/100 [00:08<00:01, 10.04it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:09<00:00, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.73it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.94it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.94it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.10it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.02it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.02it/s] 99%|█████████▉| 99/100 [00:09<00:00,  9.90it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:10<00:00,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 775.29it/s][A100%|██████████| 100/100 [00:10<00:00,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.90it/s]100%|██████████| 100/100 [00:10<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.011 MB of 0.011 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.011 MB of 0.029 MB uploadedwandb: | 0.011 MB of 0.029 MB uploadedwandb: / 0.029 MB of 0.029 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▇
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▂
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▂
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▇
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▂
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▂
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm █▃▅▃▃▃▁▅▄▂▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▂▁▃▄▂▁▅█▁▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.02628
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0226
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 88.416
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 44.208
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1900
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.02628
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0226
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 88.416
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 44.208
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 31.49069
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.4819
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8164464525312.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 0.98881
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.2787
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.915
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.729
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_3 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144755-uijo9p43_client_3/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144815-uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 960.45it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.64it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  2%|▏         | 2/100 [00:00<00:10,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:09, 10.35it/s]                                                 3%|▎         | 3/100 [00:00<00:09, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:09, 10.35it/s]  5%|▌         | 5/100 [00:00<00:09, 10.11it/s]                                                 5%|▌         | 5/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  6%|▌         | 6/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.90it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.76it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.85it/s]                                                 10%|█         | 10/100 [00:01<00:09,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.77it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.79it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.85it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.74it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08,  9.67it/s]                                                 16%|█▌        | 16/100 [00:01<00:08,  9.67it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.68it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.22it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.32it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.32it/s] 23%|██▎       | 23/100 [00:02<00:06, 11.68it/s]                                                 23%|██▎       | 23/100 [00:02<00:06, 11.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:06, 11.68it/s] 25%|██▌       | 25/100 [00:02<00:05, 13.07it/s]                                                 25%|██▌       | 25/100 [00:02<00:05, 13.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:05, 13.07it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:05, 14.17it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 14.17it/s]                                                 28%|██▊       | 28/100 [00:02<00:05, 14.17it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:04, 14.66it/s]                                                 29%|██▉       | 29/100 [00:02<00:04, 14.66it/s]                                                 30%|███       | 30/100 [00:02<00:04, 14.66it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:02<00:04, 14.90it/s]                                                 31%|███       | 31/100 [00:02<00:04, 14.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:02<00:04, 14.90it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:02<00:05, 12.68it/s]                                                 33%|███▎      | 33/100 [00:02<00:05, 12.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:05, 12.68it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:05, 11.85it/s]                                                 35%|███▌      | 35/100 [00:03<00:05, 11.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:05, 11.85it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:05, 11.38it/s]                                                 37%|███▋      | 37/100 [00:03<00:05, 11.38it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 11.38it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:05, 10.93it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 10.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.93it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 10.58it/s]                                                 41%|████      | 41/100 [00:03<00:05, 10.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:05, 10.58it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:05, 10.40it/s]                                                 43%|████▎     | 43/100 [00:03<00:05, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.35it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.13it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05, 10.17it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 793.47it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:06,  7.88it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:06,  7.88it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:05,  8.15it/s]                                                 52%|█████▏    | 52/100 [00:05<00:05,  8.15it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.37it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.37it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.57it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.57it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.83it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.83it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.08it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.08it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.21it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.21it/s] 58%|█████▊    | 58/100 [00:05<00:04,  9.23it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.23it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.40it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.40it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.51it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:04,  9.51it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03,  9.55it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.55it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.58it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.73it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.95it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03,  9.94it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.95it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.95it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.91it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.26it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 10.26it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.39it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.38it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.38it/s] 80%|████████  | 80/100 [00:07<00:01, 10.73it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01, 10.60it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01, 10.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.60it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 10.35it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.15it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.89it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.85it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.85it/s]                                                 90%|█████████ | 90/100 [00:08<00:01,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00,  9.80it/s]                                                 91%|█████████ | 91/100 [00:08<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.80it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.80it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.78it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.82it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.78it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.78it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.65it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.65it/s]100%|██████████| 100/100 [00:09<00:00,  9.73it/s]                                                 100%|██████████| 100/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 779.76it/s][A100%|██████████| 100/100 [00:09<00:00,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.73it/s]100%|██████████| 100/100 [00:10<00:00,  9.96it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.002 MB of 0.063 MB uploadedwandb: / 0.002 MB of 0.063 MB uploadedwandb: - 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.66552
wandb:  eval/eval_model_preparation_time 0.0035
wandb:                 eval/eval_runtime 0.1054
wandb:      eval/eval_samples_per_second 189.747
wandb:        eval/eval_steps_per_second 47.437
wandb:                              iter 1800
wandb:                   train/eval_loss 1.66552
wandb: train/eval_model_preparation_time 0.0035
wandb:                train/eval_runtime 0.1054
wandb:     train/eval_samples_per_second 189.747
wandb:       train/eval_steps_per_second 47.437
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144744-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144834-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:48:44,604	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:48:44,605	ERROR client.py:240 -- Config: {}
2024-11-11 14:48:44,607	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:48:45,503	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 70.02it/s]
[92mINFO [0m:      fit progress: (19, 0.0, {}, 938.9166224570945)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.017 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.017 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▂▃▁▃▂▃▂▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▂▄▂▁█▇██▂▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.65758
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.023
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 87.122
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 43.561
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 1900
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.65758
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.023
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 87.122
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 43.561
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 23.6895
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.9919
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8263532150784.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.30993
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.0402
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.84
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.96
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_7 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_7
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144815-uijo9p43_client_7/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144847-uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 914.59it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.11it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.85it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.73it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.73it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09, 10.24it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:08, 10.52it/s]                                                 9%|▉         | 9/100 [00:00<00:08, 10.52it/s]                                                10%|█         | 10/100 [00:00<00:08, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08, 10.39it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08, 10.39it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08, 10.21it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.21it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08, 10.19it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08, 10.07it/s]                                                 19%|█▉        | 19/100 [00:01<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.13it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.24it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.27it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.03it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.96it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.96it/s]                                                 30%|███       | 30/100 [00:02<00:07,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.13it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.03it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06, 10.05it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.05it/s] 39%|███▉      | 39/100 [00:03<00:05, 10.82it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 10.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.82it/s] 41%|████      | 41/100 [00:03<00:04, 12.04it/s]                                                 41%|████      | 41/100 [00:03<00:04, 12.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:04, 12.04it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:04, 13.14it/s]                                                 43%|████▎     | 43/100 [00:04<00:04, 13.14it/s]                                                 44%|████▍     | 44/100 [00:04<00:04, 13.14it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:03, 14.11it/s]                                                 45%|████▌     | 45/100 [00:04<00:03, 14.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:03, 14.11it/s] 47%|████▋     | 47/100 [00:04<00:04, 13.01it/s]                                                 47%|████▋     | 47/100 [00:04<00:04, 13.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:03, 13.01it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:04, 11.82it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 11.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 11.82it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 734.94it/s][A 50%|█████     | 50/100 [00:04<00:04, 11.82it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:05,  8.44it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:05,  8.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:05,  8.44it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.90it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.90it/s] 55%|█████▌    | 55/100 [00:05<00:04,  9.19it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  9.19it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.24it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.24it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.37it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:04,  9.37it/s] 61%|██████    | 61/100 [00:05<00:04,  9.53it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.53it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:04,  9.49it/s]                                                 62%|██████▏   | 62/100 [00:06<00:04,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.94it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03,  9.94it/s] 66%|██████▌   | 66/100 [00:06<00:03, 10.08it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.18it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.18it/s] 70%|███████   | 70/100 [00:06<00:02, 10.49it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:06<00:02, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 10.05it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.00it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.00it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.20it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.20it/s] 80%|████████  | 80/100 [00:07<00:01, 10.14it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01, 10.10it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 10.03it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.03it/s] 86%|████████▌ | 86/100 [00:08<00:01, 10.00it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.98it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.22it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.22it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.37it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00, 10.10it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.92it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.59it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00,  9.61it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.67it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1022.00it/s][A100%|██████████| 100/100 [00:09<00:00,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.67it/s]100%|██████████| 100/100 [00:10<00:00,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second █▁▃
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▅▅▇▃█▅▆▆▂▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▃▁▃▄▂▁▅█▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.13163
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0237
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 84.341
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 42.17
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2000
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.13163
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0237
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 84.341
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 42.17
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 22.73966
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.2682
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8164464525312.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 0.84363
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.0492
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.804
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.951
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_3 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144847-uijo9p43_client_3/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144906-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 943.39it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:07, 13.38it/s]  2%|▏         | 2/100 [00:00<00:06, 15.06it/s]                                                 2%|▏         | 2/100 [00:00<00:06, 15.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:06, 15.06it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:08, 11.43it/s]                                                 4%|▍         | 4/100 [00:00<00:08, 11.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:08, 11.43it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:08, 10.54it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 10.54it/s]                                                 7%|▋         | 7/100 [00:00<00:08, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.26it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.18it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.06it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.06it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.10it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.26it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.26it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.39it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.12it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.12it/s] 22%|██▏       | 22/100 [00:02<00:07, 10.25it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:02<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.04it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.04it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.12it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.09it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:03<00:06,  9.88it/s]                                                 32%|███▏      | 32/100 [00:03<00:06,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.07it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.07it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.04it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.92it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.04it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.04it/s]                                                 41%|████      | 41/100 [00:04<00:05, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.82it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05,  9.67it/s]                                                 43%|████▎     | 43/100 [00:04<00:05,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05,  9.90it/s]                                                 45%|████▌     | 45/100 [00:04<00:05,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05,  9.90it/s] 47%|████▋     | 47/100 [00:04<00:05, 10.08it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:04, 10.33it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1054.91it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  8.14it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  8.14it/s]                                                 52%|█████▏    | 52/100 [00:05<00:05,  8.14it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:04,  9.49it/s]                                                 53%|█████▎    | 53/100 [00:05<00:04,  9.49it/s]                                                 54%|█████▍    | 54/100 [00:05<00:04,  9.49it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04, 11.05it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04, 11.05it/s]                                                 56%|█████▌    | 56/100 [00:05<00:03, 11.05it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:03, 12.23it/s]                                                 57%|█████▋    | 57/100 [00:05<00:03, 12.23it/s]                                                 58%|█████▊    | 58/100 [00:05<00:03, 12.23it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:03, 13.51it/s]                                                 59%|█████▉    | 59/100 [00:05<00:03, 13.51it/s]                                                 60%|██████    | 60/100 [00:05<00:02, 13.51it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:02, 14.60it/s]                                                 61%|██████    | 61/100 [00:05<00:02, 14.60it/s]                                                 62%|██████▏   | 62/100 [00:05<00:02, 14.60it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:05<00:02, 15.53it/s]                                                 63%|██████▎   | 63/100 [00:05<00:02, 15.53it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:05<00:02, 15.53it/s] 65%|██████▌   | 65/100 [00:06<00:02, 15.58it/s]                                                 65%|██████▌   | 65/100 [00:06<00:02, 15.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:02, 15.58it/s] 67%|██████▋   | 67/100 [00:06<00:02, 15.87it/s]                                                 67%|██████▋   | 67/100 [00:06<00:02, 15.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:02, 15.87it/s] 69%|██████▉   | 69/100 [00:06<00:01, 15.78it/s]                                                 69%|██████▉   | 69/100 [00:06<00:01, 15.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:01, 15.78it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02, 13.99it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 13.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02, 13.99it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 12.62it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 12.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:06<00:02, 12.62it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:06<00:02, 11.44it/s]                                                 75%|███████▌  | 75/100 [00:06<00:02, 11.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:06<00:02, 11.44it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02, 11.11it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 11.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:01, 11.11it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:01, 10.56it/s]                                                 79%|███████▉  | 79/100 [00:07<00:01, 10.56it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.56it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 10.32it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01, 10.32it/s] 83%|████████▎ | 83/100 [00:07<00:01, 10.14it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:07<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:07<00:01, 10.06it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:07<00:01, 10.06it/s] 87%|████████▋ | 87/100 [00:08<00:01, 10.26it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.99it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.00it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00,  9.98it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00,  9.98it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:08<00:00, 10.16it/s]                                                 95%|█████████▌| 95/100 [00:08<00:00, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:08<00:00, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.04it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.04it/s] 99%|█████████▉| 99/100 [00:09<00:00,  9.91it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 743.80it/s][A100%|██████████| 100/100 [00:09<00:00,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00,  9.91it/s]100%|██████████| 100/100 [00:09<00:00, 10.44it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.062 MB of 0.062 MB uploadedwandb: | 0.062 MB of 0.062 MB uploadedwandb: / 0.062 MB of 0.062 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.64363
wandb:  eval/eval_model_preparation_time 0.0012
wandb:                 eval/eval_runtime 0.0972
wandb:      eval/eval_samples_per_second 205.721
wandb:        eval/eval_steps_per_second 51.43
wandb:                              iter 1900
wandb:                   train/eval_loss 1.64363
wandb: train/eval_model_preparation_time 0.0012
wandb:                train/eval_runtime 0.0972
wandb:     train/eval_samples_per_second 205.721
wandb:       train/eval_steps_per_second 51.43
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144834-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144925-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:49:32,661	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:49:32,662	ERROR client.py:240 -- Config: {}
2024-11-11 14:49:32,663	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:49:33,535	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 67.33it/s]
[92mINFO [0m:      fit progress: (20, 0.0, {}, 986.9486687690951)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.017 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.000 MB of 0.018 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▇
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▅█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▇
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▆▁█▂▂▂▂▄▂▂▅
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▂▃▆▂▆▂█▄▁▆
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.09917
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0228
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 87.688
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 43.844
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2000
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.09917
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0016
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0228
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 87.688
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 43.844
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 60.58481
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.7351
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.35106
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.5789
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.758
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.44
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144906-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144935-uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.00it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:08, 11.31it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.33it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:08, 10.75it/s]                                                 4%|▍         | 4/100 [00:00<00:08, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:08, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:08, 10.48it/s]                                                 6%|▌         | 6/100 [00:00<00:08, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:08, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.41it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.37it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.37it/s]                                                 11%|█         | 11/100 [00:01<00:08, 10.37it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:07, 11.76it/s]                                                 12%|█▏        | 12/100 [00:01<00:07, 11.76it/s]                                                 13%|█▎        | 13/100 [00:01<00:07, 11.76it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:06, 12.63it/s]                                                 14%|█▍        | 14/100 [00:01<00:06, 12.63it/s]                                                 15%|█▌        | 15/100 [00:01<00:06, 12.63it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:06, 13.98it/s]                                                 16%|█▌        | 16/100 [00:01<00:06, 13.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:05, 13.98it/s] 18%|█▊        | 18/100 [00:01<00:05, 14.26it/s]                                                 18%|█▊        | 18/100 [00:01<00:05, 14.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:05, 14.26it/s] 20%|██        | 20/100 [00:01<00:05, 14.65it/s]                                                 20%|██        | 20/100 [00:01<00:05, 14.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:05, 14.65it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:05, 14.79it/s]                                                 22%|██▏       | 22/100 [00:01<00:05, 14.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:01<00:05, 14.79it/s] 24%|██▍       | 24/100 [00:01<00:04, 15.66it/s]                                                 24%|██▍       | 24/100 [00:01<00:04, 15.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:01<00:04, 15.66it/s] 26%|██▌       | 26/100 [00:01<00:04, 15.90it/s]                                                 26%|██▌       | 26/100 [00:01<00:04, 15.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:04, 15.90it/s] 28%|██▊       | 28/100 [00:02<00:04, 16.11it/s]                                                 28%|██▊       | 28/100 [00:02<00:04, 16.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:04, 16.11it/s] 30%|███       | 30/100 [00:02<00:04, 14.91it/s]                                                 30%|███       | 30/100 [00:02<00:04, 14.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:04, 14.91it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:05, 13.36it/s]                                                 32%|███▏      | 32/100 [00:02<00:05, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:05, 13.36it/s] 34%|███▍      | 34/100 [00:02<00:05, 12.19it/s]                                                 34%|███▍      | 34/100 [00:02<00:05, 12.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:02<00:05, 12.19it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:02<00:05, 11.54it/s]                                                 36%|███▌      | 36/100 [00:02<00:05, 11.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:02<00:05, 11.54it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:05, 11.19it/s]                                                 38%|███▊      | 38/100 [00:03<00:05, 11.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:05, 11.19it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.79it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:05, 10.79it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:03<00:05, 10.64it/s]                                                 42%|████▏     | 42/100 [00:03<00:05, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:05, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:05, 10.41it/s]                                                 44%|████▍     | 44/100 [00:03<00:05, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:03<00:05, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:05, 10.24it/s]                                                 46%|████▌     | 46/100 [00:03<00:05, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:03<00:05, 10.24it/s] 48%|████▊     | 48/100 [00:04<00:05, 10.20it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.30it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 779.03it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:05,  8.59it/s]                                                 52%|█████▏    | 52/100 [00:04<00:05,  8.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:04<00:05,  8.59it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:04,  9.80it/s]                                                 54%|█████▍    | 54/100 [00:04<00:04,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:04<00:04,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:04<00:04, 10.99it/s]                                                 56%|█████▌    | 56/100 [00:04<00:04, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:04<00:03, 10.99it/s] 58%|█████▊    | 58/100 [00:04<00:03, 12.00it/s]                                                 58%|█████▊    | 58/100 [00:04<00:03, 12.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:04<00:03, 12.00it/s] 60%|██████    | 60/100 [00:05<00:03, 13.08it/s]                                                 60%|██████    | 60/100 [00:05<00:03, 13.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:02, 13.08it/s] 62%|██████▏   | 62/100 [00:05<00:02, 14.21it/s]                                                 62%|██████▏   | 62/100 [00:05<00:02, 14.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:05<00:02, 14.21it/s] 64%|██████▍   | 64/100 [00:05<00:02, 14.68it/s]                                                 64%|██████▍   | 64/100 [00:05<00:02, 14.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:05<00:02, 14.68it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:05<00:02, 13.12it/s]                                                 66%|██████▌   | 66/100 [00:05<00:02, 13.12it/s]                                                 67%|██████▋   | 67/100 [00:05<00:02, 13.12it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:05<00:02, 11.96it/s]                                                 68%|██████▊   | 68/100 [00:05<00:02, 11.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:05<00:02, 11.96it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:05<00:02, 11.39it/s]                                                 70%|███████   | 70/100 [00:05<00:02, 11.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:05<00:02, 11.39it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:06<00:02, 10.86it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02, 10.86it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.86it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:06<00:02, 10.67it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:06<00:02, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:06<00:02, 10.46it/s]                                                 76%|███████▌  | 76/100 [00:06<00:02, 10.46it/s]                                                 77%|███████▋  | 77/100 [00:06<00:02, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:06<00:02, 10.47it/s]                                                 78%|███████▊  | 78/100 [00:06<00:02, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:06<00:02, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:06<00:01, 10.16it/s]                                                 80%|████████  | 80/100 [00:06<00:01, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:06<00:01, 10.16it/s] 82%|████████▏ | 82/100 [00:07<00:01, 10.06it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:07<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:07<00:01, 10.12it/s]                                                 84%|████████▍ | 84/100 [00:07<00:01, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:07<00:01, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01, 10.05it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:01, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:07<00:01,  9.89it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:07<00:01,  9.89it/s] 90%|█████████ | 90/100 [00:07<00:00, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:07<00:00, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:07<00:00, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00, 10.23it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00, 10.15it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:08<00:00, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00, 10.13it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:08<00:00, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:08<00:00, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:08<00:00, 10.70it/s]                                                 100%|██████████| 100/100 [00:08<00:00, 10.70it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 795.28it/s][A100%|██████████| 100/100 [00:08<00:00, 10.70it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.70it/s]100%|██████████| 100/100 [00:09<00:00, 11.08it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.016 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.016 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▇
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▁█▃▁▄▂▁▂▁▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂▆▂▅▃█▁▂▇▁█
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.87911
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0215
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 93.198
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 46.599
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2100
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.87911
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0215
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 93.198
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 46.599
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 41.7995
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 2.5585
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8312527552512.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.48579
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.0221
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 44.335
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 11.084
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_0 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_0
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144935-uijo9p43_client_0/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_144955-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 959.58it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.12it/s]  2%|▏         | 2/100 [00:00<00:09, 10.29it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.57it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:08, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.11it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.11it/s]                                                 7%|▋         | 7/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.92it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.71it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:09,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08,  9.98it/s]                                                 11%|█         | 11/100 [00:01<00:08,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08, 10.08it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08, 10.03it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08, 10.17it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.25it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.36it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.15it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.15it/s] 25%|██▌       | 25/100 [00:02<00:07, 10.33it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:06, 10.48it/s]                                                 27%|██▋       | 27/100 [00:02<00:06, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:06, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:06, 10.45it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.15it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.15it/s] 33%|███▎      | 33/100 [00:03<00:06, 10.08it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.14it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:06, 10.14it/s] 37%|███▋      | 37/100 [00:03<00:06, 10.28it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06, 10.28it/s] 39%|███▉      | 39/100 [00:03<00:05, 11.41it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 11.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 11.41it/s] 41%|████      | 41/100 [00:03<00:04, 12.61it/s]                                                 41%|████      | 41/100 [00:03<00:04, 12.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:04, 12.61it/s] 43%|████▎     | 43/100 [00:04<00:04, 13.46it/s]                                                 43%|████▎     | 43/100 [00:04<00:04, 13.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:04, 13.46it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:04, 13.59it/s]                                                 45%|████▌     | 45/100 [00:04<00:04, 13.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:03, 13.59it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:04, 12.69it/s]                                                 47%|████▋     | 47/100 [00:04<00:04, 12.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:04, 12.69it/s] 49%|████▉     | 49/100 [00:04<00:04, 11.74it/s]                                                 49%|████▉     | 49/100 [00:04<00:04, 11.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 11.74it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 781.64it/s][A 50%|█████     | 50/100 [00:04<00:04, 11.74it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:05,  8.58it/s]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:05,  8.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:05,  8.58it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.96it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.96it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04,  9.22it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  9.22it/s] 57%|█████▋    | 57/100 [00:05<00:04,  9.45it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.54it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.57it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.57it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:04,  9.44it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.44it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:04,  9.45it/s]                                                 62%|██████▏   | 62/100 [00:06<00:04,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.47it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.47it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.50it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.54it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.58it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.58it/s] 69%|██████▉   | 69/100 [00:06<00:03,  9.82it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.60it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:03,  9.60it/s]                                                 71%|███████   | 71/100 [00:06<00:03,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02,  9.60it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.77it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.77it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.76it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.72it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.64it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02,  9.64it/s] 80%|████████  | 80/100 [00:07<00:02,  9.78it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.77it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.82it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.78it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01,  9.75it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01,  9.67it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.59it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.85it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:01,  9.77it/s]                                                 90%|█████████ | 90/100 [00:08<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:09<00:00,  9.70it/s]                                                 91%|█████████ | 91/100 [00:09<00:00,  9.70it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00,  9.75it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.69it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.69it/s] 94%|█████████▍| 94/100 [00:09<00:00,  9.76it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.76it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.75it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00,  9.75it/s] 98%|█████████▊| 98/100 [00:09<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.71it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 750.99it/s][A100%|██████████| 100/100 [00:09<00:00,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.71it/s]100%|██████████| 100/100 [00:10<00:00,  9.85it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.61421
wandb:  eval/eval_model_preparation_time 0.0008
wandb:                 eval/eval_runtime 0.0979
wandb:      eval/eval_samples_per_second 204.239
wandb:        eval/eval_steps_per_second 51.06
wandb:                              iter 2000
wandb:                   train/eval_loss 1.61421
wandb: train/eval_model_preparation_time 0.0008
wandb:                train/eval_runtime 0.0979
wandb:     train/eval_samples_per_second 204.239
wandb:       train/eval_steps_per_second 51.06
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_144925-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145014-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:50:20,735	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:50:20,736	ERROR client.py:240 -- Config: {}
2024-11-11 14:50:20,738	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:50:21,610	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 55.95it/s]
[92mINFO [0m:      fit progress: (21, 0.0, {}, 1035.0570910298266)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploadedwandb: | 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁██
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▂
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▆
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▂▆▃▂█▃▇▃▁▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▃▂▂▆▂▆▃█▄▁▆
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.25404
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0023
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0217
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 92.196
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 46.098
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2100
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.25404
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0023
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0217
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 92.196
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 46.098
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 34.71398
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.6964
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.23581
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.153
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.397
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.849
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_144955-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145023-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:09, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.98it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:09,  9.76it/s]                                                 3%|▎         | 3/100 [00:00<00:09,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.79it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.79it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.99it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.88it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.88it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.89it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:09,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.84it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08,  9.86it/s]                                                 12%|█▏        | 12/100 [00:01<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08,  9.97it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.00it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.93it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08,  9.83it/s]                                                 18%|█▊        | 18/100 [00:01<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:08,  9.83it/s]                                                 19%|█▉        | 19/100 [00:01<00:08,  9.83it/s]                                                
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:02<00:08,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:08,  9.69it/s]                                                 21%|██        | 21/100 [00:02<00:08,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:08,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07,  9.82it/s]                                                 23%|██▎       | 23/100 [00:02<00:07,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07,  9.80it/s]                                                 24%|██▍       | 24/100 [00:02<00:07,  9.80it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07,  9.98it/s]                                                 27%|██▋       | 27/100 [00:02<00:07,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07,  9.93it/s]                                                 29%|██▉       | 29/100 [00:02<00:07,  9.93it/s] 30%|███       | 30/100 [00:03<00:07,  9.94it/s]                                                 30%|███       | 30/100 [00:03<00:07,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:07,  9.74it/s]                                                 31%|███       | 31/100 [00:03<00:07,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.67it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.67it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.67it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:05, 12.27it/s]                                                 35%|███▌      | 35/100 [00:03<00:05, 12.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:05, 12.27it/s] 37%|███▋      | 37/100 [00:03<00:04, 13.36it/s]                                                 37%|███▋      | 37/100 [00:03<00:04, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:04, 13.36it/s] 39%|███▉      | 39/100 [00:03<00:04, 14.14it/s]                                                 39%|███▉      | 39/100 [00:03<00:04, 14.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:04, 14.14it/s] 41%|████      | 41/100 [00:03<00:04, 14.67it/s]                                                 41%|████      | 41/100 [00:03<00:04, 14.67it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:03, 14.67it/s] 43%|████▎     | 43/100 [00:03<00:03, 15.14it/s]                                                 43%|████▎     | 43/100 [00:03<00:03, 15.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:03<00:03, 15.14it/s] 45%|████▌     | 45/100 [00:04<00:03, 15.16it/s]                                                 45%|████▌     | 45/100 [00:04<00:03, 15.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:03, 15.16it/s] 47%|████▋     | 47/100 [00:04<00:03, 15.14it/s]                                                 47%|████▋     | 47/100 [00:04<00:03, 15.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:03, 15.14it/s] 49%|████▉     | 49/100 [00:04<00:03, 15.27it/s]                                                 49%|████▉     | 49/100 [00:04<00:03, 15.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:03, 15.27it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1104.35it/s][A 50%|█████     | 50/100 [00:04<00:03, 15.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:04, 10.49it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:04<00:04, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:04<00:04, 10.25it/s]                                                 53%|█████▎    | 53/100 [00:04<00:04, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:04<00:04, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04, 10.12it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04, 10.24it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  58%|█████▊    | 58/100 [00:05<00:04, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:03, 10.46it/s]                                                 59%|█████▉    | 59/100 [00:05<00:03, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:03, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:03, 10.20it/s]                                                 61%|██████    | 61/100 [00:05<00:03, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03, 10.20it/s] 63%|██████▎   | 63/100 [00:05<00:03, 10.35it/s]                                                 63%|██████▎   | 63/100 [00:05<00:03, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:05<00:03, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.21it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03, 10.08it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  69%|██████▉   | 69/100 [00:06<00:03, 10.12it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  70%|███████   | 70/100 [00:06<00:02, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02, 10.09it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:06<00:02, 10.04it/s]                                                 73%|███████▎  | 73/100 [00:06<00:02, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:06<00:02, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.01it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.94it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.87it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.87it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 10.30it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01, 10.00it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01, 10.00it/s]                                                 83%|████████▎ | 83/100 [00:07<00:01, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:07<00:01, 10.75it/s]                                                 84%|████████▍ | 84/100 [00:07<00:01, 10.75it/s]                                                 85%|████████▌ | 85/100 [00:07<00:01, 10.75it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01, 12.06it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 12.06it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:00, 12.34it/s]                                                 88%|████████▊ | 88/100 [00:08<00:00, 12.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:00, 12.34it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 11.73it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 11.73it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00, 10.81it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 10.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 10.81it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00, 10.43it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:08<00:00, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00, 10.54it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.25it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 767.63it/s][A100%|██████████| 100/100 [00:09<00:00, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.19it/s]100%|██████████| 100/100 [00:09<00:00, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▆▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▂▃▁▂▃▂▂▁█▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂▁▂▆▂▇▃█▄▁▆
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.66772
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0256
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 78.086
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 39.043
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2200
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.66772
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0009
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0256
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 78.086
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 39.043
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 47.07511
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 1.5256
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8260301684736.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.13506
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.5964
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.682
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.421
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_6 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145023-uijo9p43_client_6/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145041-uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 887.87it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:09,  9.91it/s]                                                 1%|          | 1/100 [00:00<00:09,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09,  9.87it/s]                                                 2%|▏         | 2/100 [00:00<00:09,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:09,  9.79it/s]                                                 3%|▎         | 3/100 [00:00<00:09,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.73it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09,  9.73it/s]  6%|▌         | 6/100 [00:00<00:09,  9.92it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.73it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  8%|▊         | 8/100 [00:00<00:09,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.87it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                 10%|█         | 10/100 [00:01<00:09,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.85it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:09,  9.72it/s]                                                 12%|█▏        | 12/100 [00:01<00:09,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08,  9.74it/s]                                                 13%|█▎        | 13/100 [00:01<00:08,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08,  9.74it/s] 15%|█▌        | 15/100 [00:01<00:08, 10.07it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08,  9.95it/s]                                                 17%|█▋        | 17/100 [00:01<00:08,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08,  9.95it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 11.06it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 11.06it/s]                                                 20%|██        | 20/100 [00:01<00:07, 11.06it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:01<00:06, 12.06it/s]                                                 21%|██        | 21/100 [00:02<00:06, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:06, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:06, 12.69it/s]                                                 23%|██▎       | 23/100 [00:02<00:06, 12.69it/s]                                                 24%|██▍       | 24/100 [00:02<00:05, 12.69it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:05, 13.36it/s]                                                 25%|██▌       | 25/100 [00:02<00:05, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:05, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:05, 12.68it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 12.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:05, 12.68it/s] 29%|██▉       | 29/100 [00:02<00:05, 13.27it/s]                                                 29%|██▉       | 29/100 [00:02<00:05, 13.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:05, 13.27it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:02<00:05, 13.01it/s]                                                 31%|███       | 31/100 [00:02<00:05, 13.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:02<00:05, 13.01it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:02<00:05, 12.18it/s]                                                 33%|███▎      | 33/100 [00:02<00:05, 12.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:05, 12.18it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:05, 11.65it/s]                                                 35%|███▌      | 35/100 [00:03<00:05, 11.65it/s]                                                 36%|███▌      | 36/100 [00:03<00:05, 11.65it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:05, 11.43it/s]                                                 37%|███▋      | 37/100 [00:03<00:05, 11.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:05, 11.43it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:05, 11.06it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 11.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 11.06it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 11.04it/s]                                                 41%|████      | 41/100 [00:03<00:05, 11.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:05, 11.04it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:05, 10.80it/s]                                                 43%|████▎     | 43/100 [00:03<00:05, 10.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:03<00:05, 10.80it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.44it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.44it/s] 47%|████▋     | 47/100 [00:04<00:05, 10.29it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05, 10.11it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 743.80it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:06,  7.64it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:06,  7.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:04<00:06,  7.64it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.21it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.21it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.48it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.48it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.14it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  57%|█████▋    | 57/100 [00:05<00:04,  9.14it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.59it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.59it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.99it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:05<00:03,  9.94it/s]                                                 62%|██████▏   | 62/100 [00:05<00:03,  9.94it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.81it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.69it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.69it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.80it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.82it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.82it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.94it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:02,  9.87it/s]                                                 71%|███████   | 71/100 [00:06<00:02,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:06<00:02,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.10it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.97it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.92it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.84it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.73it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.73it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:02,  9.88it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.81it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:07<00:01,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.86it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.17it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.34it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  88%|████████▊ | 88/100 [00:08<00:01, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.33it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.22it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 10.22it/s] 93%|█████████▎| 93/100 [00:09<00:00, 10.10it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00,  9.98it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00,  9.92it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00,  9.78it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00,  9.78it/s] 98%|█████████▊| 98/100 [00:09<00:00,  9.83it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.80it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00,  9.78it/s]                                                 100%|██████████| 100/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 778.89it/s][A100%|██████████| 100/100 [00:09<00:00,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.78it/s]100%|██████████| 100/100 [00:10<00:00, 10.00it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.54118
wandb:  eval/eval_model_preparation_time 0.0014
wandb:                 eval/eval_runtime 0.112
wandb:      eval/eval_samples_per_second 178.497
wandb:        eval/eval_steps_per_second 44.624
wandb:                              iter 2100
wandb:                   train/eval_loss 1.54118
wandb: train/eval_model_preparation_time 0.0014
wandb:                train/eval_runtime 0.112
wandb:     train/eval_samples_per_second 178.497
wandb:       train/eval_steps_per_second 44.624
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_145014-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145101-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:51:09,014	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:51:09,015	ERROR client.py:240 -- Config: {}
2024-11-11 14:51:09,016	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:51:09,879	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 67.86it/s]
[92mINFO [0m:      fit progress: (22, 0.0, {}, 1083.277263558004)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▅▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▅▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▅▅▅▄▄▁█▅▃▄▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂███▂▄▇▄▅▃▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.70833
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0012
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0221
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 90.473
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 45.237
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2200
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.70833
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0012
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0221
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 90.473
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 45.237
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 27.76852
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.1151
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8385751449600.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.43093
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.0021
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 39.991
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.998
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_9 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145041-uijo9p43_client_9/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145111-uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1380.16it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.73it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m                                                  2%|▏         | 2/100 [00:00<00:10,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:09,  9.92it/s]                                                 3%|▎         | 3/100 [00:00<00:09,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09,  9.82it/s]                                                 4%|▍         | 4/100 [00:00<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.79it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.50it/s]                                                 6%|▌         | 6/100 [00:00<00:09,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.83it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.83it/s] 10%|█         | 10/100 [00:00<00:08, 10.69it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.36it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.36it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.15it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:08, 10.08it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:08, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:08, 10.04it/s]                                                 18%|█▊        | 18/100 [00:01<00:08, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:08, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.38it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:02<00:07, 10.38it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:02<00:07, 10.13it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.13it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.30it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.12it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:06, 10.33it/s]                                                 28%|██▊       | 28/100 [00:02<00:06, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.24it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:03<00:06, 10.24it/s] 32%|███▏      | 32/100 [00:03<00:06, 10.17it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:03<00:06, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.02it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.00it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.96it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.10it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:04<00:05, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:05,  9.98it/s]                                                 42%|████▏     | 42/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:04<00:05, 10.16it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05, 10.08it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.08it/s] 48%|████▊     | 48/100 [00:04<00:05, 10.03it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.04it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1238.72it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.04it/s] 52%|█████▏    | 52/100 [00:05<00:06,  7.60it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:06,  7.60it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.15it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.15it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:05,  8.67it/s]                                                 56%|█████▌    | 56/100 [00:05<00:05,  8.67it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  8.81it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  8.81it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  8.99it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  8.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:06<00:04,  8.99it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.50it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.50it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:04,  9.50it/s] 62%|██████▏   | 62/100 [00:06<00:03,  9.79it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.85it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03,  9.85it/s] 66%|██████▌   | 66/100 [00:06<00:03, 10.12it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.15it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:07<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:07<00:03,  9.98it/s]                                                 70%|███████   | 70/100 [00:07<00:03,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:07<00:02,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 10.09it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.17it/s]                                                
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.22it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.22it/s] 78%|███████▊  | 78/100 [00:07<00:02, 10.27it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:08<00:02, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:08<00:01, 10.22it/s]                                                 80%|████████  | 80/100 [00:08<00:01, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:08<00:01, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01, 10.03it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 10.03it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.15it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.06it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:09<00:01, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:00, 10.07it/s]                                                 90%|█████████ | 90/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:09<00:00, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:09<00:00, 10.01it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 10.11it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 10.06it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00, 10.14it/s]                                                 100%|██████████| 100/100 [00:10<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1220.34it/s][A100%|██████████| 100/100 [00:10<00:00, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00, 10.14it/s]100%|██████████| 100/100 [00:10<00:00,  9.68it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploadedwandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▆▆▁▃▁▁▂▂█▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▃▁▂▅▂▁▄█▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 1.94147
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0022
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0207
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 96.537
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 48.269
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2300
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 1.94147
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0022
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0207
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 96.537
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 48.269
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 25.53892
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.2972
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8164464525312.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 0.84605
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.3245
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.743
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.686
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_3 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145111-uijo9p43_client_3/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: | Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145132-uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 920.21it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.80it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  2%|▏         | 2/100 [00:00<00:09,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m   3%|▎         | 3/100 [00:00<00:10,  9.46it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  4%|▍         | 4/100 [00:00<00:10,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m   5%|▌         | 5/100 [00:00<00:09,  9.71it/s]                                                 5%|▌         | 5/100 [00:00<00:09,  9.71it/s]                                               
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m   7%|▋         | 7/100 [00:00<00:09,  9.83it/s]                                                 7%|▋         | 7/100 [00:00<00:09,  9.83it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09,  9.71it/s]                                                 8%|▊         | 8/100 [00:00<00:09,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m   9%|▉         | 9/100 [00:00<00:09,  9.75it/s]                                                 9%|▉         | 9/100 [00:00<00:09,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m                                                
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:01<00:09,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:09,  9.82it/s]                                                 11%|█         | 11/100 [00:01<00:09,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08, 10.14it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08, 10.13it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.13it/s]                                                 16%|█▌        | 16/100 [00:01<00:08, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08, 10.29it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:07, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.19it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.01it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.01it/s]                                                 22%|██▏       | 22/100 [00:02<00:07, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.09it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.41it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.41it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.26it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:06, 10.26it/s]                                                 29%|██▉       | 29/100 [00:02<00:06, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                 
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.18it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  32%|███▏      | 32/100 [00:03<00:06, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.16it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.98it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.97it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.92it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06,  9.81it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.73it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.73it/s]                                                 41%|████      | 41/100 [00:04<00:05, 10.73it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:04<00:04, 11.78it/s]                                                 42%|████▏     | 42/100 [00:04<00:04, 11.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:04<00:04, 11.78it/s] 44%|████▍     | 44/100 [00:04<00:04, 11.32it/s]                                                 44%|████▍     | 44/100 [00:04<00:04, 11.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:04, 11.32it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:04, 11.09it/s]                                                 46%|████▌     | 46/100 [00:04<00:04, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:04, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:04, 10.76it/s]                                                 48%|████▊     | 48/100 [00:04<00:04, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:04, 10.76it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.61it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1031.30it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:04, 10.61it/s] 52%|█████▏    | 52/100 [00:05<00:06,  7.75it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.75it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  7.95it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  7.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  7.95it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.65it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.65it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  8.85it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  8.85it/s] 57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.01it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.22it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.22it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:06<00:04,  9.54it/s]                                                 60%|██████    | 60/100 [00:06<00:04,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:06<00:04,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03, 10.03it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.76it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.78it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.78it/s] 67%|██████▋   | 67/100 [00:06<00:03,  9.85it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.85it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:07<00:03,  9.99it/s]                                                 70%|███████   | 70/100 [00:07<00:03,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.93it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.93it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02, 10.01it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  74%|███████▍  | 74/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02, 10.16it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  76%|███████▌  | 76/100 [00:07<00:02, 10.16it/s] 77%|███████▋  | 77/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02, 10.09it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:01, 10.58it/s]                                                 79%|███████▉  | 79/100 [00:07<00:01, 10.58it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:08<00:01, 10.58it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:08<00:01, 10.35it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  82%|████████▏ | 82/100 [00:08<00:01, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01, 10.14it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  85%|████████▌ | 85/100 [00:08<00:01, 10.08it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 10.08it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01,  9.97it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.67it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.67it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01,  9.74it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.74it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:09<00:01,  9.77it/s]                                                 90%|█████████ | 90/100 [00:09<00:01,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:09<00:00,  9.77it/s] 92%|█████████▏| 92/100 [00:09<00:00, 10.01it/s]                                                 92%|█████████▏| 92/100 [00:09<00:00, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00,  9.98it/s]                                                 93%|█████████▎| 93/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.12it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.06it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.06it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00,  9.99it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:10<00:00,  9.96it/s]                                                 100%|██████████| 100/100 [00:10<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1180.83it/s][A100%|██████████| 100/100 [00:10<00:00,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:10<00:00,  9.96it/s]100%|██████████| 100/100 [00:10<00:00,  9.74it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.063 MB of 0.063 MB uploadedwandb: | 0.063 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.54266
wandb:  eval/eval_model_preparation_time 0.0017
wandb:                 eval/eval_runtime 0.1021
wandb:      eval/eval_samples_per_second 195.906
wandb:        eval/eval_steps_per_second 48.976
wandb:                              iter 2200
wandb:                   train/eval_loss 1.54266
wandb: train/eval_model_preparation_time 0.0017
wandb:                train/eval_runtime 0.1021
wandb:     train/eval_samples_per_second 195.906
wandb:       train/eval_steps_per_second 48.976
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_145101-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145151-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:52:00,105	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:52:00,107	ERROR client.py:240 -- Config: {}
2024-11-11 14:52:00,108	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:52:00,965	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 72.11it/s]
[92mINFO [0m:      fit progress: (23, 0.0, {}, 1134.3446930330247)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.018 MB uploadedwandb: / 0.000 MB of 0.018 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▂▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ██▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▁█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▅▄▇▁██▃▃█▂
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▂█▆█▂▃▆▃▅▂▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.63166
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0011
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0224
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 89.234
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 44.617
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2300
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.63166
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0011
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0224
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 89.234
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 44.617
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 33.43466
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.1995
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8385751449600.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.27889
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 10.2619
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 38.979
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 9.745
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_9 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_9
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145132-uijo9p43_client_9/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145203-uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 876.74it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:08, 11.05it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.54it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.54it/s]  4%|▍         | 4/100 [00:00<00:09, 10.47it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.32it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09, 10.08it/s]                                                 8%|▊         | 8/100 [00:00<00:09, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:09, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:09,  9.98it/s]                                                 10%|█         | 10/100 [00:00<00:09,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  11%|█         | 11/100 [00:01<00:08,  9.94it/s]                                                 11%|█         | 11/100 [00:01<00:08,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m                                                  12%|█▏        | 12/100 [00:01<00:08,  9.94it/s]
[36m(ClientAppActor pid=263676)[0m  13%|█▎        | 13/100 [00:01<00:08, 10.13it/s]                                                 13%|█▎        | 13/100 [00:01<00:08, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  14%|█▍        | 14/100 [00:01<00:08, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08, 10.42it/s]                                                 15%|█▌        | 15/100 [00:01<00:08, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:07, 10.57it/s]                                                 17%|█▋        | 17/100 [00:01<00:07, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:07, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  19%|█▉        | 19/100 [00:01<00:07, 10.30it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07, 10.19it/s]                                                 21%|██        | 21/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07, 10.19it/s] 23%|██▎       | 23/100 [00:02<00:07, 10.14it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  24%|██▍       | 24/100 [00:02<00:07, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.16it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.13it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07, 10.13it/s]                                                 29%|██▉       | 29/100 [00:02<00:07, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.11it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.11it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06, 10.71it/s]                                                 33%|███▎      | 33/100 [00:03<00:06, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  34%|███▍      | 34/100 [00:03<00:06, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06, 10.81it/s]                                                 35%|███▌      | 35/100 [00:03<00:06, 10.81it/s]                                                 36%|███▌      | 36/100 [00:03<00:05, 10.81it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:05, 10.84it/s]                                                 37%|███▋      | 37/100 [00:03<00:05, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:05, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:05, 10.77it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 10.77it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.77it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 10.68it/s]                                                 41%|████      | 41/100 [00:03<00:05, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:04<00:05, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.41it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.41it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.41it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.35it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.15it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.15it/s] 49%|████▉     | 49/100 [00:04<00:05, 10.19it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 762.46it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  8.08it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  8.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:05<00:05,  8.08it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.66it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.66it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04,  9.07it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:04,  9.07it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.38it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.47it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.51it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:06<00:04,  9.51it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.59it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.59it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03,  9.66it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.66it/s] 64%|██████▍   | 64/100 [00:06<00:03,  9.98it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  66%|██████▌   | 66/100 [00:06<00:03,  9.85it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.79it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  68%|██████▊   | 68/100 [00:06<00:03,  9.79it/s] 69%|██████▉   | 69/100 [00:06<00:03, 10.02it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:07<00:03,  9.89it/s]                                                 70%|███████   | 70/100 [00:07<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:07<00:02,  9.79it/s]                                                 71%|███████   | 71/100 [00:07<00:02,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02,  9.75it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.73it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.73it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.71it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.56it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.56it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.65it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.65it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.65it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.24it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 10.48it/s]                                                 80%|████████  | 80/100 [00:08<00:01, 10.48it/s]                                                 81%|████████  | 81/100 [00:08<00:01, 10.48it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01, 11.59it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 11.59it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01, 11.59it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01, 12.97it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 12.97it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01, 12.97it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:00, 14.11it/s]                                                 86%|████████▌ | 86/100 [00:08<00:00, 14.11it/s]                                                 87%|████████▋ | 87/100 [00:08<00:00, 14.11it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:00, 14.95it/s]                                                 88%|████████▊ | 88/100 [00:08<00:00, 14.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:00, 14.95it/s] 90%|█████████ | 90/100 [00:08<00:00, 15.66it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 15.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 15.66it/s] 92%|█████████▏| 92/100 [00:08<00:00, 16.03it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 16.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 16.03it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00, 15.17it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 15.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:08<00:00, 15.17it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 13.03it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 13.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 13.03it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 11.98it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 11.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 11.98it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 11.41it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 11.41it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 829.73it/s][A100%|██████████| 100/100 [00:09<00:00, 11.41it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 11.41it/s]100%|██████████| 100/100 [00:09<00:00, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.016 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.016 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▂▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▂▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▂█▄▃▄▁▂▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▃▂▄▅▂▁▅█▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.11079
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0398
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 50.269
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 25.135
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2400
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.11079
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0013
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0398
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 50.269
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 25.135
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 28.93559
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.2034
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8164464525312.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 0.75848
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.7076
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.205
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.301
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_3 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_3
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145203-uijo9p43_client_3/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145222-uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 926.71it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:06, 14.43it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:06, 14.07it/s]                                                 2%|▏         | 2/100 [00:00<00:06, 14.07it/s]                                                 3%|▎         | 3/100 [00:00<00:06, 14.07it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:06, 14.78it/s]                                                 4%|▍         | 4/100 [00:00<00:06, 14.78it/s]                                                 5%|▌         | 5/100 [00:00<00:06, 14.78it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:06, 15.44it/s]                                                 6%|▌         | 6/100 [00:00<00:06, 15.44it/s]                                                 7%|▋         | 7/100 [00:00<00:06, 15.44it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:05, 15.81it/s]                                                 8%|▊         | 8/100 [00:00<00:05, 15.81it/s]                                                 9%|▉         | 9/100 [00:00<00:05, 15.81it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:05, 15.61it/s]                                                 10%|█         | 10/100 [00:00<00:05, 15.61it/s]                                                 11%|█         | 11/100 [00:00<00:05, 15.61it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:00<00:06, 13.37it/s]                                                 12%|█▏        | 12/100 [00:00<00:06, 13.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:00<00:06, 13.37it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:07, 12.12it/s]                                                 14%|█▍        | 14/100 [00:01<00:07, 12.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:07, 12.12it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:07, 11.19it/s]                                                 16%|█▌        | 16/100 [00:01<00:07, 11.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 11.19it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.81it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.81it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.81it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.44it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07, 10.44it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:07, 10.28it/s]                                                 22%|██▏       | 22/100 [00:01<00:07, 10.28it/s]                                                 23%|██▎       | 23/100 [00:01<00:07, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.19it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.24it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.10it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.01it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.01it/s] 32%|███▏      | 32/100 [00:02<00:06,  9.97it/s]                                                
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:06,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:06,  9.97it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06, 10.22it/s]                                                 34%|███▍      | 34/100 [00:03<00:06, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.22it/s] 36%|███▌      | 36/100 [00:03<00:06, 10.07it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  37%|███▋      | 37/100 [00:03<00:06, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06,  9.99it/s]                                                 38%|███▊      | 38/100 [00:03<00:06,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:06,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:06,  9.95it/s]                                                 40%|████      | 40/100 [00:03<00:06,  9.95it/s] 41%|████      | 41/100 [00:03<00:05,  9.92it/s]                                                 41%|████      | 41/100 [00:03<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:05,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:03<00:05, 10.11it/s]                                                 43%|████▎     | 43/100 [00:03<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.20it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.20it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.27it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05,  9.96it/s]                                                 49%|████▉     | 49/100 [00:04<00:05,  9.96it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:05,  9.91it/s]                                                 50%|█████     | 50/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 776.15it/s][A 50%|█████     | 50/100 [00:04<00:05,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:06,  7.38it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:06,  7.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  52%|█████▏    | 52/100 [00:04<00:06,  7.38it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.37it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  54%|█████▍    | 54/100 [00:05<00:05,  8.37it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04,  9.01it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.01it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.15it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.15it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  9.32it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.32it/s] 58%|█████▊    | 58/100 [00:05<00:04,  9.36it/s]                                                
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.36it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:04,  9.36it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.72it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:04,  9.62it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:05<00:03,  9.62it/s] 63%|██████▎   | 63/100 [00:06<00:03,  9.77it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03,  9.78it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03,  9.80it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.87it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.82it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.82it/s] 69%|██████▉   | 69/100 [00:06<00:03,  9.82it/s]                                                 69%|██████▉   | 69/100 [00:06<00:03,  9.82it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:03,  9.71it/s]                                                 70%|███████   | 70/100 [00:06<00:03,  9.71it/s]
[36m(ClientAppActor pid=263676)[0m  71%|███████   | 71/100 [00:06<00:03,  9.63it/s]                                                 71%|███████   | 71/100 [00:06<00:03,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m                                                  72%|███████▏  | 72/100 [00:07<00:02,  9.63it/s]
[36m(ClientAppActor pid=263676)[0m  73%|███████▎  | 73/100 [00:07<00:02,  9.80it/s]                                                 73%|███████▎  | 73/100 [00:07<00:02,  9.80it/s] 74%|███████▍  | 74/100 [00:07<00:02,  9.80it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.84it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.84it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.53it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.53it/s]
[36m(ClientAppActor pid=263676)[0m  77%|███████▋  | 77/100 [00:07<00:02,  9.37it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  78%|███████▊  | 78/100 [00:07<00:02,  9.37it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02,  9.60it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.60it/s] 80%|████████  | 80/100 [00:07<00:02,  9.66it/s]                                                 80%|████████  | 80/100 [00:07<00:02,  9.66it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01,  9.54it/s]                                                 81%|████████  | 81/100 [00:07<00:01,  9.54it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.53it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.53it/s]
[36m(ClientAppActor pid=263676)[0m  83%|████████▎ | 83/100 [00:08<00:01,  9.38it/s]                                                 83%|████████▎ | 83/100 [00:08<00:01,  9.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  84%|████████▍ | 84/100 [00:08<00:01,  9.38it/s] 85%|████████▌ | 85/100 [00:08<00:01,  9.98it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.61it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.61it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.61it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:01, 10.40it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.21it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:09<00:00, 10.21it/s] 93%|█████████▎| 93/100 [00:09<00:00, 10.03it/s]                                                
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:09<00:00, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.03it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 11.04it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 11.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 11.04it/s] 97%|█████████▋| 97/100 [00:09<00:00, 12.31it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 12.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 12.31it/s] 99%|█████████▉| 99/100 [00:09<00:00, 13.06it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 13.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 13.06it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 776.29it/s][A100%|██████████| 100/100 [00:09<00:00, 13.06it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 13.06it/s]100%|██████████| 100/100 [00:09<00:00, 10.20it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.062 MB of 0.062 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.52926
wandb:  eval/eval_model_preparation_time 0.0008
wandb:                 eval/eval_runtime 0.0934
wandb:      eval/eval_samples_per_second 214.198
wandb:        eval/eval_steps_per_second 53.55
wandb:                              iter 2300
wandb:                   train/eval_loss 1.52926
wandb: train/eval_model_preparation_time 0.0008
wandb:                train/eval_runtime 0.0934
wandb:     train/eval_samples_per_second 214.198
wandb:       train/eval_steps_per_second 53.55
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_145151-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145240-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:52:47,992	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:52:47,994	ERROR client.py:240 -- Config: {}
2024-11-11 14:52:47,995	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:52:48,851	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 70.68it/s]
[92mINFO [0m:      fit progress: (24, 0.0, {}, 1182.2611771440133)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 4
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.005 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: / 0.000 MB of 0.005 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss █▃▁
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss █▃▁
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁██
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▄▂▃▃▁▁▂▅█▃▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▇▂▆█▃▁▄▃█▅▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 2.89974
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0208
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 96.055
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 48.028
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2400
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 2.89974
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0017
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0208
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 96.055
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 48.028
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 20.60838
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.6349
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8549966807040.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.35799
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.8004
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 40.815
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.204
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_5 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145222-uijo9p43_client_5/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145251-uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 955.86it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:10,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.23it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.08it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.39it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:08, 10.39it/s]  8%|▊         | 8/100 [00:00<00:07, 11.60it/s]                                                 8%|▊         | 8/100 [00:00<00:07, 11.60it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:07, 11.60it/s] 10%|█         | 10/100 [00:00<00:06, 13.22it/s]                                                 10%|█         | 10/100 [00:00<00:06, 13.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:00<00:06, 13.22it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:07, 11.97it/s]                                                 12%|█▏        | 12/100 [00:01<00:07, 11.97it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:07, 11.97it/s] 14%|█▍        | 14/100 [00:01<00:07, 11.29it/s]                                                 14%|█▍        | 14/100 [00:01<00:07, 11.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:07, 11.29it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:07, 10.83it/s]                                                 16%|█▌        | 16/100 [00:01<00:07, 10.83it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 10.83it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.52it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.52it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:06, 11.68it/s]                                                 20%|██        | 20/100 [00:01<00:06, 11.68it/s]                                                 21%|██        | 21/100 [00:01<00:06, 11.68it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:06, 12.64it/s]                                                 22%|██▏       | 22/100 [00:01<00:06, 12.64it/s]                                                 23%|██▎       | 23/100 [00:01<00:06, 12.64it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:05, 13.55it/s]                                                 24%|██▍       | 24/100 [00:02<00:05, 13.55it/s]                                                 25%|██▌       | 25/100 [00:02<00:05, 13.55it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:05, 14.09it/s]                                                 26%|██▌       | 26/100 [00:02<00:05, 14.09it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 14.09it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:05, 13.12it/s]                                                 28%|██▊       | 28/100 [00:02<00:05, 13.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:05, 13.12it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:05, 11.93it/s]                                                 30%|███       | 30/100 [00:02<00:05, 11.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:05, 11.93it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:06, 11.24it/s]                                                 32%|███▏      | 32/100 [00:02<00:06, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:05, 11.24it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:02<00:05, 11.67it/s]                                                 34%|███▍      | 34/100 [00:02<00:05, 11.67it/s]                                                 35%|███▌      | 35/100 [00:02<00:05, 11.67it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:02<00:04, 13.01it/s]                                                 36%|███▌      | 36/100 [00:02<00:04, 13.01it/s]                                                 37%|███▋      | 37/100 [00:03<00:04, 13.01it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:04, 14.20it/s]                                                 38%|███▊      | 38/100 [00:03<00:04, 14.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:04, 14.20it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:04, 12.76it/s]                                                 40%|████      | 40/100 [00:03<00:04, 12.76it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:04, 12.76it/s] 42%|████▏     | 42/100 [00:03<00:04, 11.66it/s]                                                 42%|████▏     | 42/100 [00:03<00:04, 11.66it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:04, 11.66it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:05, 10.84it/s]                                                 44%|████▍     | 44/100 [00:03<00:05, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:03<00:05, 10.84it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:03<00:05, 10.43it/s]                                                 46%|████▌     | 46/100 [00:03<00:05, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.30it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:04, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:04, 10.27it/s]                                                 50%|█████     | 50/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 977.92it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04, 10.27it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:04<00:05,  8.55it/s]                                                 52%|█████▏    | 52/100 [00:04<00:05,  8.55it/s]                                                 53%|█████▎    | 53/100 [00:04<00:05,  8.55it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:04<00:04, 10.04it/s]                                                 54%|█████▍    | 54/100 [00:04<00:04, 10.04it/s]                                                 55%|█████▌    | 55/100 [00:04<00:04, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:04<00:03, 11.37it/s]                                                 56%|█████▌    | 56/100 [00:04<00:03, 11.37it/s]                                                 57%|█████▋    | 57/100 [00:04<00:03, 11.37it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:03, 10.96it/s]                                                 58%|█████▊    | 58/100 [00:05<00:03, 10.96it/s]
[36m(ClientAppActor pid=263676)[0m                                                  59%|█████▉    | 59/100 [00:05<00:03, 10.96it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:03, 10.72it/s]                                                 60%|██████    | 60/100 [00:05<00:03, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:05<00:03, 10.46it/s]                                                 62%|██████▏   | 62/100 [00:05<00:03, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:05<00:03, 10.46it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:05<00:03, 10.47it/s]                                                 64%|██████▍   | 64/100 [00:05<00:03, 10.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:05<00:03, 10.47it/s] 66%|██████▌   | 66/100 [00:05<00:03, 10.24it/s]                                                 66%|██████▌   | 66/100 [00:05<00:03, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:05<00:03, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.19it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.19it/s] 70%|███████   | 70/100 [00:06<00:02, 10.92it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.92it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:06<00:02, 10.92it/s] 72%|███████▏  | 72/100 [00:06<00:02, 12.06it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:06<00:02, 12.06it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:06<00:02, 11.77it/s]                                                 74%|███████▍  | 74/100 [00:06<00:02, 11.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:06<00:02, 11.77it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:06<00:02, 11.21it/s]                                                 76%|███████▌  | 76/100 [00:06<00:02, 11.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:06<00:02, 11.21it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:06<00:01, 11.09it/s]                                                 78%|███████▊  | 78/100 [00:06<00:01, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:01, 11.09it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 10.69it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.69it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01, 10.23it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01, 10.23it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:07<00:01, 10.23it/s] 84%|████████▍ | 84/100 [00:07<00:01, 10.32it/s]                                                 84%|████████▍ | 84/100 [00:07<00:01, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:07<00:01, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:07<00:01, 10.29it/s]                                                 86%|████████▌ | 86/100 [00:07<00:01, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:07<00:01, 10.29it/s] 88%|████████▊ | 88/100 [00:07<00:01, 10.20it/s]                                                 88%|████████▊ | 88/100 [00:07<00:01, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.25it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 10.25it/s] 92%|█████████▏| 92/100 [00:08<00:00, 10.29it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:08<00:00, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:08<00:00, 10.34it/s]                                                 94%|█████████▍| 94/100 [00:08<00:00, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:08<00:00, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:08<00:00, 10.49it/s]                                                 96%|█████████▌| 96/100 [00:08<00:00, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:08<00:00, 10.49it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:08<00:00,  9.98it/s]                                                 98%|█████████▊| 98/100 [00:08<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 1192.24it/s][A100%|██████████| 100/100 [00:09<00:00, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.00it/s]100%|██████████| 100/100 [00:09<00:00, 10.74it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.000 MB uploadedwandb: | 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▆▁
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▇█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▆▁
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁▃█
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▃▁▂▁▂▄▂█▂▅▃
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▁█▁▃▅▂▅█▅▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 0.56484
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.002
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0223
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 89.751
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 44.876
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2500
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 0.56484
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.002
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0223
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 89.751
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 44.876
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 55.2841
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7818
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8315758018560.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.27982
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.3106
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 42.962
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.74
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_4 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_4
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145251-uijo9p43_client_4/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145311-uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1060.24it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m   1%|          | 1/100 [00:00<00:10,  9.80it/s]                                                 1%|          | 1/100 [00:00<00:10,  9.80it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:10,  9.46it/s]                                                 2%|▏         | 2/100 [00:00<00:10,  9.46it/s]                                                 3%|▎         | 3/100 [00:00<00:10,  9.46it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:07, 12.39it/s]                                                 4%|▍         | 4/100 [00:00<00:07, 12.39it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:07, 12.39it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:07, 13.43it/s]                                                 6%|▌         | 6/100 [00:00<00:07, 13.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:06, 13.43it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:06, 14.47it/s]                                                 8%|▊         | 8/100 [00:00<00:06, 14.47it/s]                                                 9%|▉         | 9/100 [00:00<00:06, 14.47it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:06, 13.59it/s]                                                 10%|█         | 10/100 [00:00<00:06, 13.59it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:00<00:06, 13.59it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:00<00:07, 11.91it/s]                                                 12%|█▏        | 12/100 [00:00<00:07, 11.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:07, 11.91it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:07, 11.18it/s]                                                 14%|█▍        | 14/100 [00:01<00:07, 11.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:07, 11.18it/s]
[36m(ClientAppActor pid=263676)[0m  16%|█▌        | 16/100 [00:01<00:07, 11.12it/s]                                                 16%|█▌        | 16/100 [00:01<00:07, 11.12it/s]                                                 17%|█▋        | 17/100 [00:01<00:07, 11.12it/s]
[36m(ClientAppActor pid=263676)[0m  18%|█▊        | 18/100 [00:01<00:07, 10.99it/s]                                                 18%|█▊        | 18/100 [00:01<00:07, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:07, 10.99it/s]
[36m(ClientAppActor pid=263676)[0m  20%|██        | 20/100 [00:01<00:07, 10.68it/s]                                                 20%|██        | 20/100 [00:01<00:07, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:07, 10.68it/s]
[36m(ClientAppActor pid=263676)[0m  22%|██▏       | 22/100 [00:01<00:07, 10.32it/s]                                                 22%|██▏       | 22/100 [00:01<00:07, 10.32it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  24%|██▍       | 24/100 [00:02<00:07, 10.30it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:07, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:07, 10.24it/s]                                                 26%|██▌       | 26/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  27%|██▋       | 27/100 [00:02<00:07, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:07, 10.19it/s]                                                 28%|██▊       | 28/100 [00:02<00:07, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:06, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 10.12it/s]                                                 30%|███       | 30/100 [00:02<00:06, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:06, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:06,  9.92it/s]                                                 32%|███▏      | 32/100 [00:02<00:06,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:06,  9.89it/s]                                                 33%|███▎      | 33/100 [00:03<00:06,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:03<00:06,  9.86it/s]                                                 34%|███▍      | 34/100 [00:03<00:06,  9.86it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:06,  9.75it/s]                                                 35%|███▌      | 35/100 [00:03<00:06,  9.75it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06,  9.78it/s]                                                 36%|███▌      | 36/100 [00:03<00:06,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  37%|███▋      | 37/100 [00:03<00:06,  9.77it/s]                                                 37%|███▋      | 37/100 [00:03<00:06,  9.77it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:06,  9.77it/s] 39%|███▉      | 39/100 [00:03<00:06, 10.08it/s]                                                 39%|███▉      | 39/100 [00:03<00:06, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 10.34it/s]                                                 41%|████      | 41/100 [00:03<00:05, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:05, 10.34it/s]
[36m(ClientAppActor pid=263676)[0m  43%|████▎     | 43/100 [00:04<00:05, 10.17it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.17it/s]                                                 44%|████▍     | 44/100 [00:04<00:05, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.26it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.15it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  48%|████▊     | 48/100 [00:04<00:05, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05, 10.19it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 760.80it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.19it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:04<00:06,  8.03it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  8.03it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:05,  8.25it/s]                                                 52%|█████▏    | 52/100 [00:05<00:05,  8.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:05,  8.25it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  9.00it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  9.00it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:04,  9.10it/s]                                                 55%|█████▌    | 55/100 [00:05<00:04,  9.10it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.15it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.15it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.15it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.45it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.45it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.47it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m                                                  60%|██████    | 60/100 [00:05<00:04,  9.47it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:06<00:04,  9.72it/s]                                                 61%|██████    | 61/100 [00:06<00:04,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  62%|██████▏   | 62/100 [00:06<00:03,  9.72it/s]
[36m(ClientAppActor pid=263676)[0m  63%|██████▎   | 63/100 [00:06<00:03,  9.85it/s]                                                 63%|██████▎   | 63/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m                                                  64%|██████▍   | 64/100 [00:06<00:03,  9.85it/s]
[36m(ClientAppActor pid=263676)[0m  65%|██████▌   | 65/100 [00:06<00:03, 10.10it/s]                                                 65%|██████▌   | 65/100 [00:06<00:03, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  66%|██████▌   | 66/100 [00:06<00:03, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  67%|██████▋   | 67/100 [00:06<00:03,  9.89it/s]                                                 67%|██████▋   | 67/100 [00:06<00:03,  9.89it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03,  9.88it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03,  9.88it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 10.01it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:06<00:02, 10.01it/s] 72%|███████▏  | 72/100 [00:07<00:02, 10.05it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.05it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.99it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.01it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.01it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.99it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  79%|███████▉  | 79/100 [00:07<00:02,  9.93it/s]                                                 79%|███████▉  | 79/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:02,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  81%|████████  | 81/100 [00:07<00:01, 10.01it/s]                                                 81%|████████  | 81/100 [00:07<00:01, 10.01it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01,  9.93it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.99it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01,  9.99it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.26it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.26it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01, 10.91it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  89%|████████▉ | 89/100 [00:08<00:01, 10.91it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 12.08it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 12.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 12.08it/s]
[36m(ClientAppActor pid=263676)[0m  92%|█████████▏| 92/100 [00:08<00:00, 12.73it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 12.73it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00, 12.73it/s]
[36m(ClientAppActor pid=263676)[0m  94%|█████████▍| 94/100 [00:09<00:00, 13.53it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 13.53it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 13.53it/s]
[36m(ClientAppActor pid=263676)[0m  96%|█████████▌| 96/100 [00:09<00:00, 14.17it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 14.17it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 14.17it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 15.00it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 15.00it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 15.00it/s]
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 100/100 [00:09<00:00, 15.89it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 15.89it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 783.10it/s][A100%|██████████| 100/100 [00:09<00:00, 15.89it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 15.89it/s]100%|██████████| 100/100 [00:09<00:00, 10.44it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.51595
wandb:  eval/eval_model_preparation_time 0.0011
wandb:                 eval/eval_runtime 0.0909
wandb:      eval/eval_samples_per_second 220.001
wandb:        eval/eval_steps_per_second 55.0
wandb:                              iter 2400
wandb:                   train/eval_loss 1.51595
wandb: train/eval_model_preparation_time 0.0011
wandb:                train/eval_runtime 0.0909
wandb:     train/eval_samples_per_second 220.001
wandb:       train/eval_steps_per_second 55.0
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_145240-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145328-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:53:36,241	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:53:36,243	ERROR client.py:240 -- Config: {}
2024-11-11 14:53:36,243	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
2024-11-11 14:53:37,116	ERROR client.py:246 -- params set
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
  obj.co_lnotab,  # for < python 3.10 [not counted in args]
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
  super().__init__(
Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 73.39it/s]
[92mINFO [0m:      fit progress: (25, 0.0, {}, 1230.49486768106)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 10)
[36m(ClientAppActor pid=263676)[0m Client id: 5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.016 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.000 MB of 0.016 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime █▁▆
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▁█▄
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▁█▄
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁█▅
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime █▁▆
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▁█▄
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▁█▄
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▁▁▁▂█▂▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▅▂▁█▄▄▂▅▇▂▃
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 1.28175
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.001
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0212
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 94.445
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 47.223
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2500
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 1.28175
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.001
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0212
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 94.445
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 47.223
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 21.98519
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.7504
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8621575471104.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.0673
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.5798
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 41.755
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.439
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_8 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_8
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145311-uijo9p43_client_8/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145339-uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.08it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]
[36m(ClientAppActor pid=263676)[0m                                          1%|          | 1/100 [00:00<00:08, 11.71it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:08, 11.15it/s]                                                 2%|▏         | 2/100 [00:00<00:08, 11.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:08, 11.15it/s]  4%|▍         | 4/100 [00:00<00:09, 10.40it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m   6%|▌         | 6/100 [00:00<00:09, 10.42it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:08, 10.42it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:08, 10.24it/s]                                                 8%|▊         | 8/100 [00:00<00:08, 10.24it/s]                                                 9%|▉         | 9/100 [00:00<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.54it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.54it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.16it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.16it/s]
[36m(ClientAppActor pid=263676)[0m  14%|█▍        | 14/100 [00:01<00:08, 10.20it/s]                                                 14%|█▍        | 14/100 [00:01<00:08, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  15%|█▌        | 15/100 [00:01<00:08, 10.20it/s] 16%|█▌        | 16/100 [00:01<00:07, 11.33it/s]                                                 16%|█▌        | 16/100 [00:01<00:07, 11.33it/s]
[36m(ClientAppActor pid=263676)[0m                                                  17%|█▋        | 17/100 [00:01<00:07, 11.33it/s] 18%|█▊        | 18/100 [00:01<00:06, 12.79it/s]                                                 18%|█▊        | 18/100 [00:01<00:06, 12.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  19%|█▉        | 19/100 [00:01<00:06, 12.79it/s] 20%|██        | 20/100 [00:01<00:05, 13.61it/s]                                                 20%|██        | 20/100 [00:01<00:05, 13.61it/s]
[36m(ClientAppActor pid=263676)[0m                                                  21%|██        | 21/100 [00:01<00:05, 13.61it/s] 22%|██▏       | 22/100 [00:01<00:05, 14.74it/s]                                                 22%|██▏       | 22/100 [00:01<00:05, 14.74it/s]
[36m(ClientAppActor pid=263676)[0m                                                  23%|██▎       | 23/100 [00:01<00:05, 14.74it/s] 24%|██▍       | 24/100 [00:01<00:04, 15.43it/s]                                                 24%|██▍       | 24/100 [00:01<00:04, 15.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  25%|██▌       | 25/100 [00:02<00:04, 15.43it/s]
[36m(ClientAppActor pid=263676)[0m  26%|██▌       | 26/100 [00:02<00:05, 13.36it/s]                                                 26%|██▌       | 26/100 [00:02<00:05, 13.36it/s]                                                 27%|██▋       | 27/100 [00:02<00:05, 13.36it/s]
[36m(ClientAppActor pid=263676)[0m  28%|██▊       | 28/100 [00:02<00:05, 12.37it/s]                                                 28%|██▊       | 28/100 [00:02<00:05, 12.37it/s]
[36m(ClientAppActor pid=263676)[0m                                                  29%|██▉       | 29/100 [00:02<00:05, 12.37it/s]
[36m(ClientAppActor pid=263676)[0m  30%|███       | 30/100 [00:02<00:06, 11.62it/s]                                                 30%|███       | 30/100 [00:02<00:06, 11.62it/s]
[36m(ClientAppActor pid=263676)[0m                                                  31%|███       | 31/100 [00:02<00:05, 11.62it/s]
[36m(ClientAppActor pid=263676)[0m  32%|███▏      | 32/100 [00:02<00:06, 10.95it/s]                                                 32%|███▏      | 32/100 [00:02<00:06, 10.95it/s]
[36m(ClientAppActor pid=263676)[0m                                                  33%|███▎      | 33/100 [00:02<00:06, 10.95it/s]
[36m(ClientAppActor pid=263676)[0m  34%|███▍      | 34/100 [00:02<00:06, 10.72it/s]                                                 34%|███▍      | 34/100 [00:02<00:06, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m                                                  35%|███▌      | 35/100 [00:03<00:06, 10.72it/s]
[36m(ClientAppActor pid=263676)[0m  36%|███▌      | 36/100 [00:03<00:06, 10.29it/s]                                                 36%|███▌      | 36/100 [00:03<00:06, 10.29it/s]                                                 37%|███▋      | 37/100 [00:03<00:06, 10.29it/s]
[36m(ClientAppActor pid=263676)[0m  38%|███▊      | 38/100 [00:03<00:06, 10.28it/s]                                                 38%|███▊      | 38/100 [00:03<00:06, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m                                                  39%|███▉      | 39/100 [00:03<00:05, 10.28it/s]
[36m(ClientAppActor pid=263676)[0m  40%|████      | 40/100 [00:03<00:05, 10.32it/s]                                                 40%|████      | 40/100 [00:03<00:05, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  41%|████      | 41/100 [00:03<00:05, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  42%|████▏     | 42/100 [00:03<00:05, 10.26it/s]                                                 42%|████▏     | 42/100 [00:03<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m                                                  43%|████▎     | 43/100 [00:03<00:05, 10.26it/s]
[36m(ClientAppActor pid=263676)[0m  44%|████▍     | 44/100 [00:03<00:05, 10.35it/s]                                                 44%|████▍     | 44/100 [00:03<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m                                                  45%|████▌     | 45/100 [00:04<00:05, 10.35it/s]
[36m(ClientAppActor pid=263676)[0m  46%|████▌     | 46/100 [00:04<00:05, 10.32it/s]                                                 46%|████▌     | 46/100 [00:04<00:05, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  47%|████▋     | 47/100 [00:04<00:05, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  48%|████▊     | 48/100 [00:04<00:05, 10.07it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  49%|████▉     | 49/100 [00:04<00:05, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  50%|█████     | 50/100 [00:04<00:05,  9.98it/s]                                                 50%|█████     | 50/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 206.95it/s][A 50%|█████     | 50/100 [00:04<00:05,  9.98it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:04<00:04,  9.98it/s] 52%|█████▏    | 52/100 [00:04<00:06,  7.65it/s]                                                 52%|█████▏    | 52/100 [00:04<00:06,  7.65it/s]
[36m(ClientAppActor pid=263676)[0m                                                  53%|█████▎    | 53/100 [00:05<00:06,  7.65it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.20it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.20it/s]
[36m(ClientAppActor pid=263676)[0m  55%|█████▌    | 55/100 [00:05<00:05,  8.41it/s]                                                 55%|█████▌    | 55/100 [00:05<00:05,  8.41it/s]
[36m(ClientAppActor pid=263676)[0m                                                  56%|█████▌    | 56/100 [00:05<00:05,  8.41it/s]
[36m(ClientAppActor pid=263676)[0m  57%|█████▋    | 57/100 [00:05<00:04,  8.87it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  8.87it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:04,  9.01it/s]                                                 58%|█████▊    | 58/100 [00:05<00:04,  9.01it/s]
[36m(ClientAppActor pid=263676)[0m  59%|█████▉    | 59/100 [00:05<00:04,  9.12it/s]                                                 59%|█████▉    | 59/100 [00:05<00:04,  9.12it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:04,  9.29it/s]                                                 60%|██████    | 60/100 [00:05<00:04,  9.29it/s]
[36m(ClientAppActor pid=263676)[0m  61%|██████    | 61/100 [00:05<00:04,  9.37it/s]                                                 61%|██████    | 61/100 [00:05<00:04,  9.37it/s] 62%|██████▏   | 62/100 [00:05<00:04,  9.48it/s]                                                 62%|██████▏   | 62/100 [00:05<00:04,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03,  9.48it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03, 10.22it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03, 10.22it/s] 66%|██████▌   | 66/100 [00:06<00:03, 10.15it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.30it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:03, 10.30it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 10.32it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.32it/s]                                                 71%|███████   | 71/100 [00:06<00:02, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:06<00:02, 10.18it/s]                                                 72%|███████▏  | 72/100 [00:06<00:02, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.18it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02, 10.07it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  75%|███████▌  | 75/100 [00:07<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02, 10.15it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  77%|███████▋  | 77/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02, 10.08it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02, 10.08it/s] 80%|████████  | 80/100 [00:07<00:01, 10.07it/s]                                                 80%|████████  | 80/100 [00:07<00:01, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:07<00:01, 10.02it/s]                                                 82%|████████▏ | 82/100 [00:07<00:01, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.02it/s]
[36m(ClientAppActor pid=263676)[0m  84%|████████▍ | 84/100 [00:08<00:01,  9.86it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01,  9.86it/s] 85%|████████▌ | 85/100 [00:08<00:01,  9.87it/s]                                                 85%|████████▌ | 85/100 [00:08<00:01,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m                                                  86%|████████▌ | 86/100 [00:08<00:01,  9.87it/s]
[36m(ClientAppActor pid=263676)[0m  87%|████████▋ | 87/100 [00:08<00:01, 10.60it/s]                                                 87%|████████▋ | 87/100 [00:08<00:01, 10.60it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01, 10.60it/s]
[36m(ClientAppActor pid=263676)[0m  89%|████████▉ | 89/100 [00:08<00:00, 11.44it/s]                                                 89%|████████▉ | 89/100 [00:08<00:00, 11.44it/s]
[36m(ClientAppActor pid=263676)[0m                                                  90%|█████████ | 90/100 [00:08<00:00, 11.44it/s]
[36m(ClientAppActor pid=263676)[0m  91%|█████████ | 91/100 [00:08<00:00, 10.80it/s]                                                 91%|█████████ | 91/100 [00:08<00:00, 10.80it/s]
[36m(ClientAppActor pid=263676)[0m                                                  92%|█████████▏| 92/100 [00:08<00:00, 10.80it/s]
[36m(ClientAppActor pid=263676)[0m  93%|█████████▎| 93/100 [00:08<00:00, 10.64it/s]                                                 93%|█████████▎| 93/100 [00:08<00:00, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m                                                  94%|█████████▍| 94/100 [00:09<00:00, 10.64it/s]
[36m(ClientAppActor pid=263676)[0m  95%|█████████▌| 95/100 [00:09<00:00, 10.45it/s]                                                 95%|█████████▌| 95/100 [00:09<00:00, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m                                                  96%|█████████▌| 96/100 [00:09<00:00, 10.45it/s]
[36m(ClientAppActor pid=263676)[0m  97%|█████████▋| 97/100 [00:09<00:00, 10.32it/s]                                                 97%|█████████▋| 97/100 [00:09<00:00, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  98%|█████████▊| 98/100 [00:09<00:00, 10.32it/s]
[36m(ClientAppActor pid=263676)[0m  99%|█████████▉| 99/100 [00:09<00:00, 10.21it/s]                                                 99%|█████████▉| 99/100 [00:09<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                 100%|██████████| 100/100 [00:09<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 762.74it/s][A100%|██████████| 100/100 [00:09<00:00, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 10.21it/s]100%|██████████| 100/100 [00:09<00:00, 10.13it/s]
[36m(ClientAppActor pid=263676)[0m Client id: 6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m wandb: - 0.000 MB of 0.000 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: \ 0.000 MB of 0.018 MB uploaded
[36m(ClientAppActor pid=263676)[0m wandb: | 0.018 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.018 MB uploadedwandb: - 0.018 MB of 0.018 MB uploadedwandb:                                                                                
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run history:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch ▁█
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime ▃▁█
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:                              iter ▁▁▁▂▂▃▄▅▅▅▅▆▇▇████
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch ▁▂▂▃▄▄▄▅▆▇▇███
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss ▁▆█
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time ▁▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime ▃▁█
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second ▆█▁
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm ▆▁█▅▆▃▅▃▆▃▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate ██▇▇▆▅▃▂▂▁▁
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss ▆▂▆█▃▁▃▃█▅▂
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos ▁
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss ▁
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime ▁
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second ▁
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: Run summary:
[36m(ClientAppActor pid=263676)[0m wandb:                        eval/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                    eval/eval_loss 3.04043
[36m(ClientAppActor pid=263676)[0m wandb:  eval/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                 eval/eval_runtime 0.0245
[36m(ClientAppActor pid=263676)[0m wandb:      eval/eval_samples_per_second 81.665
[36m(ClientAppActor pid=263676)[0m wandb:        eval/eval_steps_per_second 40.832
[36m(ClientAppActor pid=263676)[0m wandb:                              iter 2600
[36m(ClientAppActor pid=263676)[0m wandb:                       train/epoch 10.0
[36m(ClientAppActor pid=263676)[0m wandb:                   train/eval_loss 3.04043
[36m(ClientAppActor pid=263676)[0m wandb: train/eval_model_preparation_time 0.0008
[36m(ClientAppActor pid=263676)[0m wandb:                train/eval_runtime 0.0245
[36m(ClientAppActor pid=263676)[0m wandb:     train/eval_samples_per_second 81.665
[36m(ClientAppActor pid=263676)[0m wandb:       train/eval_steps_per_second 40.832
[36m(ClientAppActor pid=263676)[0m wandb:                   train/grad_norm 20.51512
[36m(ClientAppActor pid=263676)[0m wandb:               train/learning_rate 0.0
[36m(ClientAppActor pid=263676)[0m wandb:                        train/loss 0.5829
[36m(ClientAppActor pid=263676)[0m wandb:                  train/total_flos 8549966807040.0
[36m(ClientAppActor pid=263676)[0m wandb:                  train/train_loss 1.26279
[36m(ClientAppActor pid=263676)[0m wandb:               train/train_runtime 9.8655
[36m(ClientAppActor pid=263676)[0m wandb:    train/train_samples_per_second 40.545
[36m(ClientAppActor pid=263676)[0m wandb:      train/train_steps_per_second 10.136
[36m(ClientAppActor pid=263676)[0m wandb: 
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run uijo9p43_client_5 at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_5
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(ClientAppActor pid=263676)[0m wandb: Find logs at: ./wandb/run-20241111_145339-uijo9p43_client_5/logs
[36m(ClientAppActor pid=263676)[0m wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
[36m(ClientAppActor pid=263676)[0m wandb: WARNING  $ pip install wandb --upgrade
[36m(ClientAppActor pid=263676)[0m wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
[36m(ClientAppActor pid=263676)[0m wandb: - Waiting for wandb.init()...
[36m(ClientAppActor pid=263676)[0m wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
[36m(ClientAppActor pid=263676)[0m wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145358-uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(ClientAppActor pid=263676)[0m wandb: Resuming run uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
[36m(ClientAppActor pid=263676)[0m wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_client_6
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/datasets/utils/_dill.py:379: DeprecationWarning: co_lnotab is deprecated, use co_lines instead.
[36m(ClientAppActor pid=263676)[0m   obj.co_lnotab,  # for < python 3.10 [not counted in args]
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/trl/trainer/sft_trainer.py:323: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomSFTTrainer.__init__`. Use `processing_class` instead.
[36m(ClientAppActor pid=263676)[0m   super().__init__(
[36m(ClientAppActor pid=263676)[0m Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[36m(ClientAppActor pid=263676)[0m max_steps is given, it will override any value given in num_train_epochs
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 911.81it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/100 [00:00<?, ?it/s]                                         1%|          | 1/100 [00:00<00:09, 10.33it/s]
[36m(ClientAppActor pid=263676)[0m   2%|▏         | 2/100 [00:00<00:09, 10.20it/s]                                                 2%|▏         | 2/100 [00:00<00:09, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m                                                  3%|▎         | 3/100 [00:00<00:09, 10.20it/s]
[36m(ClientAppActor pid=263676)[0m   4%|▍         | 4/100 [00:00<00:09, 10.00it/s]                                                 4%|▍         | 4/100 [00:00<00:09, 10.00it/s]
[36m(ClientAppActor pid=263676)[0m                                                  5%|▌         | 5/100 [00:00<00:09, 10.00it/s]  6%|▌         | 6/100 [00:00<00:09, 10.14it/s]                                                 6%|▌         | 6/100 [00:00<00:09, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  7%|▋         | 7/100 [00:00<00:09, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m   8%|▊         | 8/100 [00:00<00:09, 10.11it/s]                                                 8%|▊         | 8/100 [00:00<00:09, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m                                                  9%|▉         | 9/100 [00:00<00:08, 10.11it/s]
[36m(ClientAppActor pid=263676)[0m  10%|█         | 10/100 [00:00<00:08, 10.14it/s]                                                 10%|█         | 10/100 [00:00<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  11%|█         | 11/100 [00:01<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m  12%|█▏        | 12/100 [00:01<00:08, 10.14it/s]                                                 12%|█▏        | 12/100 [00:01<00:08, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  13%|█▎        | 13/100 [00:01<00:08, 10.14it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.93it/s]                                                 14%|█▍        | 14/100 [00:01<00:08,  9.93it/s]
[36m(ClientAppActor pid=263676)[0m  15%|█▌        | 15/100 [00:01<00:08,  9.90it/s]                                                 15%|█▌        | 15/100 [00:01<00:08,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m                                                  16%|█▌        | 16/100 [00:01<00:08,  9.90it/s]
[36m(ClientAppActor pid=263676)[0m  17%|█▋        | 17/100 [00:01<00:08, 10.24it/s]                                                 17%|█▋        | 17/100 [00:01<00:08, 10.24it/s]
[36m(ClientAppActor pid=263676)[0m                                                  18%|█▊        | 18/100 [00:01<00:08, 10.24it/s] 19%|█▉        | 19/100 [00:01<00:07, 10.22it/s]                                                 19%|█▉        | 19/100 [00:01<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m                                                  20%|██        | 20/100 [00:01<00:07, 10.22it/s]
[36m(ClientAppActor pid=263676)[0m  21%|██        | 21/100 [00:02<00:07,  9.91it/s]                                                 21%|██        | 21/100 [00:02<00:07,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  22%|██▏       | 22/100 [00:02<00:07,  9.91it/s]
[36m(ClientAppActor pid=263676)[0m  23%|██▎       | 23/100 [00:02<00:07, 10.10it/s]                                                 23%|██▎       | 23/100 [00:02<00:07, 10.10it/s]                                                 24%|██▍       | 24/100 [00:02<00:07, 10.10it/s]
[36m(ClientAppActor pid=263676)[0m  25%|██▌       | 25/100 [00:02<00:07, 10.21it/s]                                                 25%|██▌       | 25/100 [00:02<00:07, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m                                                  26%|██▌       | 26/100 [00:02<00:07, 10.21it/s]
[36m(ClientAppActor pid=263676)[0m  27%|██▋       | 27/100 [00:02<00:07, 10.25it/s]                                                 27%|██▋       | 27/100 [00:02<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m                                                  28%|██▊       | 28/100 [00:02<00:07, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  29%|██▉       | 29/100 [00:02<00:07, 10.12it/s]                                                 29%|██▉       | 29/100 [00:02<00:07, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  30%|███       | 30/100 [00:02<00:06, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m  31%|███       | 31/100 [00:03<00:06, 10.52it/s]                                                 31%|███       | 31/100 [00:03<00:06, 10.52it/s]                                                 32%|███▏      | 32/100 [00:03<00:06, 10.52it/s]
[36m(ClientAppActor pid=263676)[0m  33%|███▎      | 33/100 [00:03<00:05, 11.61it/s]                                                 33%|███▎      | 33/100 [00:03<00:05, 11.61it/s]                                                 34%|███▍      | 34/100 [00:03<00:05, 11.61it/s]
[36m(ClientAppActor pid=263676)[0m  35%|███▌      | 35/100 [00:03<00:05, 12.27it/s]                                                 35%|███▌      | 35/100 [00:03<00:05, 12.27it/s]
[36m(ClientAppActor pid=263676)[0m                                                  36%|███▌      | 36/100 [00:03<00:05, 12.27it/s] 37%|███▋      | 37/100 [00:03<00:05, 11.89it/s]                                                 37%|███▋      | 37/100 [00:03<00:05, 11.89it/s]
[36m(ClientAppActor pid=263676)[0m                                                  38%|███▊      | 38/100 [00:03<00:05, 11.89it/s]
[36m(ClientAppActor pid=263676)[0m  39%|███▉      | 39/100 [00:03<00:05, 11.55it/s]                                                 39%|███▉      | 39/100 [00:03<00:05, 11.55it/s]
[36m(ClientAppActor pid=263676)[0m                                                  40%|████      | 40/100 [00:03<00:05, 11.55it/s]
[36m(ClientAppActor pid=263676)[0m  41%|████      | 41/100 [00:03<00:05, 11.10it/s]                                                 41%|████      | 41/100 [00:03<00:05, 11.10it/s]
[36m(ClientAppActor pid=263676)[0m                                                  42%|████▏     | 42/100 [00:03<00:05, 11.10it/s] 43%|████▎     | 43/100 [00:04<00:05, 10.71it/s]                                                 43%|████▎     | 43/100 [00:04<00:05, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m                                                  44%|████▍     | 44/100 [00:04<00:05, 10.71it/s]
[36m(ClientAppActor pid=263676)[0m  45%|████▌     | 45/100 [00:04<00:05, 10.43it/s]                                                 45%|████▌     | 45/100 [00:04<00:05, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m                                                  46%|████▌     | 46/100 [00:04<00:05, 10.43it/s]
[36m(ClientAppActor pid=263676)[0m  47%|████▋     | 47/100 [00:04<00:05, 10.25it/s]                                                 47%|████▋     | 47/100 [00:04<00:05, 10.25it/s]                                                 48%|████▊     | 48/100 [00:04<00:05, 10.25it/s]
[36m(ClientAppActor pid=263676)[0m  49%|████▉     | 49/100 [00:04<00:05, 10.14it/s]                                                 49%|████▉     | 49/100 [00:04<00:05, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                                  50%|█████     | 50/100 [00:04<00:04, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 742.22it/s][A 50%|█████     | 50/100 [00:04<00:04, 10.14it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m  51%|█████     | 51/100 [00:05<00:06,  7.53it/s]/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  51%|█████     | 51/100 [00:05<00:06,  7.53it/s]
[36m(ClientAppActor pid=263676)[0m  52%|█████▏    | 52/100 [00:05<00:06,  7.81it/s]                                                 52%|█████▏    | 52/100 [00:05<00:06,  7.81it/s]
[36m(ClientAppActor pid=263676)[0m  53%|█████▎    | 53/100 [00:05<00:05,  8.04it/s]                                                 53%|█████▎    | 53/100 [00:05<00:05,  8.04it/s]
[36m(ClientAppActor pid=263676)[0m  54%|█████▍    | 54/100 [00:05<00:05,  8.38it/s]                                                 54%|█████▍    | 54/100 [00:05<00:05,  8.38it/s]
[36m(ClientAppActor pid=263676)[0m                                                  55%|█████▌    | 55/100 [00:05<00:05,  8.38it/s]
[36m(ClientAppActor pid=263676)[0m  56%|█████▌    | 56/100 [00:05<00:04,  9.76it/s]                                                 56%|█████▌    | 56/100 [00:05<00:04,  9.76it/s]                                                 57%|█████▋    | 57/100 [00:05<00:04,  9.76it/s]
[36m(ClientAppActor pid=263676)[0m  58%|█████▊    | 58/100 [00:05<00:03, 11.38it/s]                                                 58%|█████▊    | 58/100 [00:05<00:03, 11.38it/s]                                                 59%|█████▉    | 59/100 [00:05<00:03, 11.38it/s]
[36m(ClientAppActor pid=263676)[0m  60%|██████    | 60/100 [00:05<00:03, 12.84it/s]                                                 60%|██████    | 60/100 [00:05<00:03, 12.84it/s]
[36m(ClientAppActor pid=263676)[0m                                                  61%|██████    | 61/100 [00:05<00:03, 12.84it/s]
[36m(ClientAppActor pid=263676)[0m  62%|██████▏   | 62/100 [00:06<00:03, 11.82it/s]                                                 62%|██████▏   | 62/100 [00:06<00:03, 11.82it/s]
[36m(ClientAppActor pid=263676)[0m                                                  63%|██████▎   | 63/100 [00:06<00:03, 11.82it/s]
[36m(ClientAppActor pid=263676)[0m  64%|██████▍   | 64/100 [00:06<00:03, 11.08it/s]                                                 64%|██████▍   | 64/100 [00:06<00:03, 11.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  65%|██████▌   | 65/100 [00:06<00:03, 11.08it/s] 66%|██████▌   | 66/100 [00:06<00:03, 10.57it/s]                                                 66%|██████▌   | 66/100 [00:06<00:03, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m                                                  67%|██████▋   | 67/100 [00:06<00:03, 10.57it/s]
[36m(ClientAppActor pid=263676)[0m  68%|██████▊   | 68/100 [00:06<00:03, 10.40it/s]                                                 68%|██████▊   | 68/100 [00:06<00:03, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m                                                  69%|██████▉   | 69/100 [00:06<00:02, 10.40it/s]
[36m(ClientAppActor pid=263676)[0m  70%|███████   | 70/100 [00:06<00:02, 10.07it/s]                                                 70%|███████   | 70/100 [00:06<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m                                                  71%|███████   | 71/100 [00:06<00:02, 10.07it/s]
[36m(ClientAppActor pid=263676)[0m  72%|███████▏  | 72/100 [00:07<00:02, 10.15it/s]                                                 72%|███████▏  | 72/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m                                                  73%|███████▎  | 73/100 [00:07<00:02, 10.15it/s]
[36m(ClientAppActor pid=263676)[0m  74%|███████▍  | 74/100 [00:07<00:02,  9.78it/s]                                                 74%|███████▍  | 74/100 [00:07<00:02,  9.78it/s]
[36m(ClientAppActor pid=263676)[0m  75%|███████▌  | 75/100 [00:07<00:02,  9.62it/s]                                                 75%|███████▌  | 75/100 [00:07<00:02,  9.62it/s]
[36m(ClientAppActor pid=263676)[0m  76%|███████▌  | 76/100 [00:07<00:02,  9.61it/s]                                                 76%|███████▌  | 76/100 [00:07<00:02,  9.61it/s]                                                 77%|███████▋  | 77/100 [00:07<00:02,  9.61it/s]
[36m(ClientAppActor pid=263676)[0m  78%|███████▊  | 78/100 [00:07<00:02,  9.79it/s]                                                 78%|███████▊  | 78/100 [00:07<00:02,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m                                                  79%|███████▉  | 79/100 [00:07<00:02,  9.79it/s]
[36m(ClientAppActor pid=263676)[0m  80%|████████  | 80/100 [00:07<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  80%|████████  | 80/100 [00:07<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m                                                  81%|████████  | 81/100 [00:07<00:01, 10.08it/s]
[36m(ClientAppActor pid=263676)[0m  82%|████████▏ | 82/100 [00:08<00:01, 10.04it/s]                                                 82%|████████▏ | 82/100 [00:08<00:01, 10.04it/s]
[36m(ClientAppActor pid=263676)[0m                                                  83%|████████▎ | 83/100 [00:08<00:01, 10.04it/s] 84%|████████▍ | 84/100 [00:08<00:01, 10.31it/s]                                                 84%|████████▍ | 84/100 [00:08<00:01, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m                                                  85%|████████▌ | 85/100 [00:08<00:01, 10.31it/s]
[36m(ClientAppActor pid=263676)[0m  86%|████████▌ | 86/100 [00:08<00:01, 10.17it/s]                                                 86%|████████▌ | 86/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m                                                  87%|████████▋ | 87/100 [00:08<00:01, 10.17it/s]
[36m(ClientAppActor pid=263676)[0m  88%|████████▊ | 88/100 [00:08<00:01,  9.92it/s]                                                 88%|████████▊ | 88/100 [00:08<00:01,  9.92it/s]                                                 89%|████████▉ | 89/100 [00:08<00:01,  9.92it/s]
[36m(ClientAppActor pid=263676)[0m  90%|█████████ | 90/100 [00:08<00:00, 10.12it/s]                                                 90%|█████████ | 90/100 [00:08<00:00, 10.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  91%|█████████ | 91/100 [00:08<00:00, 10.12it/s] 92%|█████████▏| 92/100 [00:08<00:00, 11.18it/s]                                                 92%|█████████▏| 92/100 [00:08<00:00, 11.18it/s]
[36m(ClientAppActor pid=263676)[0m                                                  93%|█████████▎| 93/100 [00:09<00:00, 11.18it/s] 94%|█████████▍| 94/100 [00:09<00:00, 12.32it/s]                                                 94%|█████████▍| 94/100 [00:09<00:00, 12.32it/s]
[36m(ClientAppActor pid=263676)[0m                                                  95%|█████████▌| 95/100 [00:09<00:00, 12.32it/s] 96%|█████████▌| 96/100 [00:09<00:00, 13.12it/s]                                                 96%|█████████▌| 96/100 [00:09<00:00, 13.12it/s]
[36m(ClientAppActor pid=263676)[0m                                                  97%|█████████▋| 97/100 [00:09<00:00, 13.12it/s]
[36m(ClientAppActor pid=263676)[0m  98%|█████████▊| 98/100 [00:09<00:00, 11.91it/s]                                                 98%|█████████▊| 98/100 [00:09<00:00, 11.91it/s]
[36m(ClientAppActor pid=263676)[0m                                                  99%|█████████▉| 99/100 [00:09<00:00, 11.91it/s]100%|██████████| 100/100 [00:09<00:00, 11.15it/s]                                                 100%|██████████| 100/100 [00:09<00:00, 11.15it/s]
[36m(ClientAppActor pid=263676)[0m 
[36m(ClientAppActor pid=263676)[0m   0%|          | 0/1 [00:00<?, ?it/s][A
[36m(ClientAppActor pid=263676)[0m                                      [A                                                 
[36m(ClientAppActor pid=263676)[0m 100%|██████████| 1/1 [00:00<00:00, 736.88it/s][A100%|██████████| 100/100 [00:09<00:00, 11.15it/s]
[36m(ClientAppActor pid=263676)[0m                                               [A
[36m(ClientAppActor pid=263676)[0m /nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
[36m(ClientAppActor pid=263676)[0m   self.FromDatetime(datetime.datetime.utcnow())
[36m(ClientAppActor pid=263676)[0m                                                  100%|██████████| 100/100 [00:09<00:00, 11.15it/s]100%|██████████| 100/100 [00:09<00:00, 10.12it/s]
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
wandb: - 0.000 MB of 0.000 MB uploadedwandb: \ 0.000 MB of 0.063 MB uploadedwandb: | 0.000 MB of 0.063 MB uploadedwandb: / 0.063 MB of 0.063 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:                    eval/eval_loss ▁
wandb:  eval/eval_model_preparation_time ▁
wandb:                 eval/eval_runtime ▁
wandb:      eval/eval_samples_per_second ▁
wandb:        eval/eval_steps_per_second ▁
wandb:                              iter ▁▁
wandb:                   train/eval_loss ▁
wandb: train/eval_model_preparation_time ▁
wandb:                train/eval_runtime ▁
wandb:     train/eval_samples_per_second ▁
wandb:       train/eval_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    eval/eval_loss 1.47774
wandb:  eval/eval_model_preparation_time 0.0008
wandb:                 eval/eval_runtime 0.0899
wandb:      eval/eval_samples_per_second 222.578
wandb:        eval/eval_steps_per_second 55.644
wandb:                              iter 2500
wandb:                   train/eval_loss 1.47774
wandb: train/eval_model_preparation_time 0.0008
wandb:                train/eval_runtime 0.0899
wandb:     train/eval_samples_per_second 222.578
wandb:       train/eval_steps_per_second 55.644
wandb: 
wandb: 🚀 View run uijo9p43_server at: https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
wandb: ⭐️ View project at: https://wandb.ai/camlsys/test-fl-memorization
wandb: Synced 4 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20241111_145328-uijo9p43_server/logs
wandb: WARNING wandb version 0.18.6 is available!  To upgrade, please run:
wandb: WARNING  $ pip install wandb --upgrade
wandb: WARNING The new W&B backend becomes opt-out in version 0.18.0; try it out with `wandb.require("core")`! See https://wandb.me/wandb-core for more information.
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: Tracking run with wandb version 0.17.9
wandb: Run data is saved locally in /nfs-share/pa511/llm_memorisation/finetune/wandb/run-20241111_145417-uijo9p43_server
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run uijo9p43_server
wandb: ⭐️ View project at https://wandb.ai/camlsys/test-fl-memorization
wandb: 🚀 View run at https://wandb.ai/camlsys/test-fl-memorization/runs/uijo9p43_server
2024-11-11 14:54:26,075	ERROR client.py:239 -- In eval function
/nfs-share/pa511/.cache/pypoetry/virtualenvs/llm-memorization1-iHoaSaFW-py3.12/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
2024-11-11 14:54:26,076	ERROR client.py:240 -- Config: {}
2024-11-11 14:54:26,077	ERROR client.py:241 -- CFG: {'resume': False, 'checkpoint_path': '', 'wandb_server_id': 'server', 'group_id': 'fl', 'wandb_client_id': 'client', 'run_id': 'uijo9p43', 'dataset': {'name': 'medalpaca/medical_meadow_medical_flashcards'}, 'model': {'name': 'EleutherAI/pythia-70m', 'tokenizer': 'EleutherAI/pythia-70m', 'quantization': 4, 'gradient_checkpointing': True, 'lora': {'peft_lora_r': 16, 'peft_lora_alpha': 64, 'target_modules': None}}, 'training_arguments': {'learning_rate': 5e-05, 'per_device_train_batch_size': 4, 'per_device_eval_batch_size': 4, 'gradient_accumulation_steps': 1, 'logging_steps': 1, 'max_steps': 100, 'eval_steps': 50, 'eval_delay': 0, 'save_steps': 50, 'save_total_limit': 10, 'gradient_checkpointing': True, 'gradient_checkpointing_kwargs': {'use_reentrant': False}, 'lr_scheduler_type': 'cosine', 'eval_strategy': 'steps', 'report_to': 'none', 'load_best_model_at_end': True}, 'train': {'save_every_round': 20, 'seq_length': 512, 'evaluate_split': True, 'learning_rate_max': 5e-05, 'learning_rate_min': 1e-06}, 'flower': {'num_clients': 10, 'fraction_fit': 0.2, 'num_rounds': 50, 'client_resources': {'num_cpus': 8, 'num_gpus': 1.0}}}
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 14163 ON mauao CANCELLED AT 2024-11-11T14:54:27 ***
slurmstepd: error: *** STEP 14163.0 ON mauao CANCELLED AT 2024-11-11T14:54:27 ***
